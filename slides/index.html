<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>T√âCNICAS DE AN√ÅLISIS MULTIVARIANTE</title>
    <meta charset="utf-8" />
    <meta name="author" content="Profesor: Javier √Ålvarez Li√©bana" />
    <link href="libs/remark-css/default.css" rel="stylesheet" />
    <link href="libs/tile-view/tile-view.css" rel="stylesheet" />
    <script src="libs/tile-view/tile-view.js"></script>
    <link href="libs/animate.css/animate.xaringan.css" rel="stylesheet" />
    <link href="libs/tachyons/tachyons.min.css" rel="stylesheet" />
    <link href="libs/xaringanExtra-extra-styles/xaringanExtra-extra-styles.css" rel="stylesheet" />
    <script src="libs/clipboard/clipboard.min.js"></script>
    <link href="libs/xaringanExtra-clipboard/xaringanExtra-clipboard.css" rel="stylesheet" />
    <script src="libs/xaringanExtra-clipboard/xaringanExtra-clipboard.js"></script>
    <script>window.xaringanExtraClipboard(null, {"button":"Click para copiar c√≥digo","success":"C√≥digo copiado","error":"Ctrl+C para copiar"})</script>
    <script src="libs/freezeframe/freezeframe.min.js"></script>
    <script src="libs/xaringanExtra-freezeframe/freezeframe-init.js"></script>
    <script id="xaringanExtra-freezeframe-options" type="application/json">{"selector":"img[src$=\"gif\"]","trigger":"click","overlay":false,"responsive":true,"warnings":true}</script>
    <link href="libs/animate.css-xaringan/animate.fade.css" rel="stylesheet" />
    <link href="libs/panelset/panelset.css" rel="stylesheet" />
    <script src="libs/panelset/panelset.js"></script>
    <script src="libs/htmlwidgets/htmlwidgets.js"></script>
    <script src="libs/plotly-binding/plotly.js"></script>
    <script src="libs/typedarray/typedarray.min.js"></script>
    <script src="libs/jquery/jquery.min.js"></script>
    <link href="libs/crosstalk/css/crosstalk.css" rel="stylesheet" />
    <script src="libs/crosstalk/js/crosstalk.min.js"></script>
    <link href="libs/plotly-htmlwidgets-css/plotly-htmlwidgets.css" rel="stylesheet" />
    <script src="libs/plotly-main/plotly-latest.min.js"></script>
    <link rel="stylesheet" href="style.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# T√âCNICAS DE AN√ÅLISIS MULTIVARIANTE
## M√°ster propio (NTIC)
### Profesor: Javier √Ålvarez Li√©bana
### Facultad de Estudios Estad√≠sticos (UCM)

---





class: inverse center middle

# ATAJOS DE LAS DIAPOSITIVAS



`$$\\[2.7in]$$`

.left[Pulsa &lt;kbd-black&gt;O&lt;/kbd-black&gt; para ver el panel de diapositivas]
.left[Pulsa &lt;kbd-black&gt;H&lt;/kbd-black&gt; para ver otros atajos]
.left[Pulsa &lt;kbd-black&gt;Ctrl+F&lt;/kbd-black&gt; tras &lt;kbd-black&gt;O&lt;/kbd-black&gt; para buscar en las diapositivas]

---


# Material de las clases


.pull-left[

- **Diapositivas** del curso:
&lt;https://dadosdelaplace.github.io/teaching/pca-clustering&gt;

- **Scripts** del curso:
&lt;https://github.com/dadosdelaplace/teaching/tree/main/bdba-pca-clustering-2022/scripts&gt;

- **Evaluaciones**:
&lt;https://github.com/dadosdelaplace/teaching/tree/main/bdba-pca-clustering-2022/eval&gt;

- **Bibliograf√≠a**: &lt;https://github.com/dadosdelaplace/teaching/tree/main/bdba-pca-clustering-2022/biblio&gt;

- **Manual** de R: &lt;https://dadosdelaplace.github.io/courses-intro-R/&gt;

- **Curso de dataviz** en R: &lt;https://dadosdelaplace.github.io/curso-dataviz-ECI-2022&gt;


]

.pull-right[

&lt;img src="./img/portada_master.jpg" width="83%" style="display: block; margin: auto 0 auto auto;" /&gt;

]

---

# Material de las clases


* Tutorial sobre **covarianzas/correlaciones**:
&lt;https://github.com/dadosdelaplace/teaching/blob/main/bdba-pca-clustering-2022/scripts/cor_cov.Rmd&gt;

* Tutorial sobre **PCA con R**:
&lt;https://github.com/dadosdelaplace/teaching/blob/main/bdba-pca-clustering-2022/scripts/pca_con_R.Rmd&gt;


* Tutorial introductorio sobre **tidyverse**:
&lt;https://github.com/dadosdelaplace/teaching/blob/main/bdba-pca-clustering-2022/scripts/intro_tidyverse.Rmd&gt;

* Curso m√°s **avanzado de tidyverse** (est√° para bioestad√≠stica pero sirve) con ejercicios &lt;https://github.com/dadosdelaplace/teaching/tree/main/bioestad&gt;

* Curso m√°s **avanzado de miner√≠a de datos en R**  con ejercicios &lt;https://github.com/dadosdelaplace/teaching/tree/main/data_mining&gt;


---

# Me presento: la turra

.pull-left[

&lt;img src="./img/me.jpeg" width="80%" style="display: block; margin: auto auto auto 0;" /&gt;

]

.pull-right[

* **Javier √Ålvarez Li√©bana**, nacido en 1989 en Carabanchel Bajo (Madrid)

* Licenciado (UCM) en **Matem√°ticas** (Erasmus en Bologna mediante). **M√°ster (UCM) en Ingenier√≠a Matem√°tica** (2013-2014)

&amp;nbsp;

* **Doctorado en estad√≠stica** por la Universidad de Granada


* Encargado de la **visualizaci√≥n y an√°lisis de datos covid** de la Consejer√≠a de Salud del **Principado de Asturias**

]

&amp;nbsp;

Intentando la **divulgaci√≥n** por `Twitter (@dadosdelaplace)` e `Instagram (@javieralvarezliebana)`. Mail: &lt;javalv09@ucm.es&gt;

---

# Objetivos


.pull-left[

El prop√≥sito de estas clases ser√° el tratamiento de **datos multidimensionales**, con tres objetivos principales:

- **Reducci√≥n de la dimensi√≥n**: ¬øtodas las variables aportan informaci√≥n? ¬øTodas son necesarias? ¬øPodemos transformar las variables para mantener la informaci√≥n de los datos pero reducir la dimensionalidad de los mismos?

- **Visualizaci√≥n**: ¬øcu√°ntas dimensiones podemos incluir en un gr√°fico 2D? ¬øC√≥mo visualizar datos multidimensionales?

- **Encontrar patrones**: ¬øc√≥mo agrupar (clusterizar) los elementos en funci√≥n de sus diferencias y similitudes?

]

.pull-right[

&lt;img src="./img/portada_master.jpg" width="120%" style="display: block; margin: auto auto auto 0;" /&gt;

]

&amp;nbsp;

üìö Estas **diapositivas** han sido elaboradas con el propio `R` haciendo uso del paquete `{xaringan}`
y `{xaringanExtra}`.


---


# Requisitos

Para el presente curso los √∫nicos **requisitos** ser√°n:

1. **Conexi√≥n a internet** (para la descarga de algunos datos y paquetes).

2. **Instalar R**: ser√° nuestro **lenguaje**, nuestro **castellano** para poder ¬´comunicarnos con el ordenador. La descarga la haremos (gratuitamente) desde &lt;https://cran.r-project.org/&gt;

3. **Instalar R Studio**. De la misma manera que podemos escribir castellano en un ordenador, en un Word, en un papel o en un tuit, podemos usar distintos IDE (entornos de desarrollo integrados, nuestro Office), para que el trabajo sea m√°s c√≥modo. Nuestro **Word** para nosotros ser√° **RStudio**.

.left[
  &lt;img src = "https://raw.githubusercontent.com/dadosdelaplace/slides-ECI-2022/main/img/cran-R.jpg" alt = "cran-R" align = "left" width = "500" style = "margin-top: 5vh"&gt;
]

.right[
  &lt;img src = "https://raw.githubusercontent.com/dadosdelaplace/slides-ECI-2022/main/img/R-studio.jpg" alt = "RStudio" align = "right" width = "500" style = "margin-top: 5vh;"&gt;
]


---

class: inverse center middle

# BLOQUE I. Selecci√≥n de variables: PCA

&amp;nbsp;


### [¬øPor qu√© es un paso importante en el an√°lisis de datos multidimensional?](#intro-PCA)

### [Teor√≠a: an√°lisis de componentes principales](#teoria-PCA)

### [Pr√°ctica: PCA en R (y visualizaci√≥n)](#practica-PCA)

---

name: intro-PCA
class: center, middle

# ¬øPor qu√© es un paso importante en el an√°lisis de datos multidimensional?

### **¬øQu√© es el an√°lisis multivariante?**

---

# ¬øQu√© es el an√°lisis multidimensional?

Hasta la d√©cada de los 60, la mayor√≠a de la estad√≠stica que se realizaba era

* **estad√≠stica unidimensional**: extraer informaci√≥n de una sola variable (rentas, impuestos, exportaciones, etc).

* **estad√≠stica bidimensional**: desde que Galton acu√±√≥ la regresi√≥n, los grandes estad√≠sticos de principios de siglo se centraron en el **an√°lisis bidimensional**, analizando la dependencia entre una variable `\(X\)` y otra variable `\(Y\)`, con herramientas como los **coeficientes de correlaci√≥n** de Pearson, Spearman o Kendall&lt;sup&gt;1&lt;/sup&gt;


[1] [üìö Kendall, M. (1938). ¬´A New Measure of Rank Correlation¬ª. Biometrika 30 (1‚Äì2): 81-89. doi:10.1093/biomet/30.1-2.81](https://doi.org/10.1093/biomet/30.1-2.81)

--

&amp;nbsp;

## Wishart, contigo empez√≥ todo

En 1928, Wishart public√≥ su famoso art√≠culo &lt;sup&gt;2&lt;/sup&gt; en el que, se demostraba y desarrollaba expl√≠citamente la funci√≥n de distribuci√≥n de una 
**distribuci√≥n normal multivariante**, trabajo m√°s tarde extendido y formalizado por Fisher.

[2] [üìö Wishart, J. (1928). ¬´The generalised product moment distribution in samples from a normal multivariate population¬ª. Biometrika. 20A (1‚Äì2): 32‚Äì52. doi:10.1093/biomet/20A.1-2.32](https://doi.org/10.1093/biomet/20A.1-2.32)


---
 
# ¬øQu√© es el an√°lisis multidimensional?
 
Aunque el verdadero boom no lleg√≥ hasta la **d√©cada de los 60**, con la publicaci√≥n del libro ¬´An Introduction to Multivariate Statistical Analysis¬ª&lt;sup&gt;1&lt;/sup&gt; de Anderson (1958), proporcionando todo un marco te√≥rico con el que poder trabajar.

[1] [üìö Anderson, T.W. (1958). ¬´An Introduction to Multivariate Analysis¬ª. New York: Wiley ISBN 0471026409](http://www.ru.ac.bd/stat/wp-content/uploads/sites/25/2019/03/301_03_Anderson_An-Introduction-to-Multivariate-Statistical-Analysis-2003.pdf)

--

&amp;nbsp;

## **Definici√≥n**

&gt; El An√°lisis Multivariante es la rama de la estad√≠stica que estudia las relaciones (CONJUNTAMENTE) entre conjuntos de variables dependientes y los individuos para los cuales se han medido dichas variables (Kendall)


## **Notaci√≥n**

* `\(n\)` tama√±o muestral (n√∫mero de individuos --&gt; filas).

* `\(\boldsymbol{X}_i = \left(\boldsymbol{X}_{1, i}, \ldots, \boldsymbol{X}_{i, p} \right)\)` conjunto de `\(p\)` variables (--&gt; columnas) medidas para cada individuo `\(i=1,\ldots,n\)`.

* Nuestros datos estar√°n en forma de tabla o matriz `\(\boldsymbol{X}\)` de `\(n\)` filas y `\(p\)` columnas (con `\(p \ll n\)`)

---

# Ejemplo de distribuci√≥n bidimensional: normal bivariante

.pull-left[ 

Veamos un ejemplo sencillo con algo que seguramente nos sea familiar: la **distribuci√≥n Normal o campana de Gauss** `\(X \sim \mathcal{N}\left(\mu, \sigma \right)\)`, cuya funci√≥n de densidad es

`$$f(x) = \frac{1}{\sigma {\sqrt{2\pi}}} e^{-{\frac{(x-\mu )^{2}}{2\sigma^{2}}}}, \quad \mu \in\mathbb{R},~\sigma &gt;0$$`

&amp;nbsp;

La normal univariante depende de **dos par√°metros**:

* **esperanza o media** `\(\mu = {\rm E} [X]\)` 
* **varianza** (unidimensional) `\(\sigma^2 := {\rm Var} [X] = {\rm E} [\left(X - \mu \right)^2] = {\rm E} [X^2] - \mu^2\)`


]


.pull-right[


```r
# Generamos muestra normal
rnorm(n = 10000, mean = 0, sd = 1)
```



&lt;img src="index_files/figure-html/unnamed-chunk-4-1.png" width="80%" /&gt;
  

]

---

# Normal bivariante

### **¬øY si medimos para cada individuo DOS variables?**

Si tenemos `\(\boldsymbol{X} = \left(X_1, X_2 \right)\)`, ¬øqu√© estad√≠sticos tenemos ahora a nuestra disposici√≥n?

* **Medidas marginales** (cada variable por separado):
  - medias `\(\mu_1:= {\rm E} [X_1]\)` y `\(\mu_2:= {\rm E} [X_2]\)`
  - varianzas `\(\sigma_{1}^{2}:=\sigma_{1, 1}^{2} = \sigma_{X_1, X_1}^2\)` y `\(\sigma_{2}^{2}:=\sigma_{2, 2}^{2} = \sigma_{X_2, X_2}^2\)`.

--

&amp;nbsp;

### **Covarianza**

La varianza `\({\rm Var} [X] := \sigma_{X}^2 = {\rm E} [ \left( X - \mu \right)^2 ]\)` es una medida de dispersi√≥n que nos **cuantifica** la relaci√≥n de una variable consigo misma. ¬øY si en lugar de medir `\(X_1\)` vs `\(X_1\)` medimos `\(X_1\)` vs `\(X_2\)`?

Definiremos la **covarianza** como una especie de varianza en la que cambiamos una de las `\(X\)` por otra variable

`$$Cov (X_1, X_2) := \sigma_{1,2} =  {\rm E} [ \left( X_1 - \mu_1 \right) \left( X_2 - \mu_2 \right) ] = {\rm E}[X_1 * X_2] - \mu_1 * \mu_2 = \sigma_{2,1}$$`

---

# Normal bivariante

### **Matriz de covarianzas**

Desde un punto de vista te√≥rico, dada una variable aleatoria bidimensional `\(\boldsymbol{X} = \left(X_1, X_2 \right)^{T}\)`, con vector de medias `\(\boldsymbol{\mu} = \left(\mu_1, \mu_2 \right)^{T}\)` definiremos la **matriz de varianzas y covarianzas** `\(\Sigma\)` de la siguiente manera:

`$$\boldsymbol{\Sigma} := \begin{pmatrix} \sigma_{1,1}^2 &amp; \sigma_{1,2} \\ \sigma_{2,1} &amp; \sigma_{2,2}^2 \end{pmatrix} = \begin{pmatrix} \sigma_{1}^2 &amp; \sigma_{1,2} \\ \sigma_{1,2} &amp; \sigma_{2}^2 \end{pmatrix}, \quad \left| \boldsymbol{\Sigma} \right| = \sigma_{1}^{2}  \sigma_{2}^{2} - \sigma_{1,2}^{2} &gt; 0$$`

--

Se puede expresar **matricialmente** como

`\(\begin{eqnarray}\boldsymbol{\Sigma} = {\rm E} \left[\left(\boldsymbol{X} - \boldsymbol{\mu} \right)^{T}\left(\boldsymbol{X} - \boldsymbol{\mu} \right) \right] &amp;=&amp; {\rm E} \left[\left( X_1  - \mu_1, X_2 - \mu_2 \right)^{T} \begin{pmatrix} X_1  - \mu_1 \\ X_2 - \mu_2 \end{pmatrix} \right] \\ &amp;=&amp; \begin{pmatrix} {\rm E} \left[ \left(X_1  - \mu_1 \right)^2 \right] &amp; {\rm E} \left[\left(X_1  - \mu_1 \right)\left(X_2  - \mu_2 \right) \right] \\ {\rm E} \left[\left(X_2  - \mu_2 \right)\left(X_1  - \mu_1 \right) \right] &amp; {\rm E} \left[\left(X_2  - \mu_2 \right)^2\right] \end{pmatrix} \end{eqnarray}\)`

**IMPORTANTE**: es una **matriz sim√©trica** (nos da igual medir `\(X\)` vs `\(Y\)`, que `\(Y\)` vs `\(X\)`).

---

# Normal multivariante

### **Normal univariante**

`$$X \sim \mathcal{N} \left(\mu, \sigma^2 \right), \quad \boldsymbol{\Sigma} = \sigma^2, \quad f(x) =  \frac{1}{\sigma {\sqrt{2\pi}}} e^{-{\frac{(x-\mu )^{2}}{2\sigma^{2}}}} = \frac{1}{\sigma {\sqrt{2\pi}}} e^{-\frac{1}{2} (x-\mu ) \boldsymbol{\Sigma}^{-1} (x-\mu )}$$`


### **Normal bivariante**

`$$\boldsymbol{X} = \left(X_1, X_2 \right)^{T}  \sim \mathcal{N} \left( \boldsymbol{\mu}, \boldsymbol{\Sigma} \right), \quad f(x_1, x_2) = \frac{1}{2\pi \left| \Sigma \right|^{1/2}} e^{-\frac{1}{2}{(\boldsymbol{x} - \mu )^{T} \boldsymbol{\Sigma}^{-1}(\boldsymbol{x} - \mu )}}$$`

--

### **Normal multivariante (caso general)** 

Multivariante de `\(p \ll n\)` variables

`$$\boldsymbol{X} = \left(X_1, \ldots, X_p \right)^{T}  \sim \mathcal{N} \left( \boldsymbol{\mu}, \boldsymbol{\Sigma} \right), \quad f(x_1, \ldots, x_p) = \frac{1}{\left(2\pi \right)^{p/2} \left| \Sigma \right|^{1/2}} e^{-\frac{1}{2}{(\boldsymbol{x} - \mu )^{T} \boldsymbol{\Sigma}^{-1}(\boldsymbol{x} - \mu )}}$$`

`$$\boldsymbol{\Sigma} = \left(\Sigma_{i,j} \right)_{i,j=1,\ldots,p}, \quad \Sigma_{i,j}:= Cov (X_i, X_j ) = {\rm E}[(X_i-\mu_i) (X_j - \mu_j)]$$`

---

# Versi√≥n muestral

Lo anterior nos permite conocer la **formulaci√≥n te√≥rica (poblacional)**: ¬øc√≥mo calculamos la varianza y covarianza cuando tenemos una muestra `\(\boldsymbol{X}\)` de `\(n\)` individuos y `\(p\)` observaciones medidas?


`$$\boldsymbol{X} = \begin{pmatrix} x_{1, 1} &amp; \ldots &amp; x_{1, p} \\ \vdots &amp; \ddots &amp; \vdots \\ x_{n, 1} &amp; \ldots &amp; x_{n, p} \end{pmatrix} \quad \text{muestra}$$`

#### **p = 2**

* **Varianzas muestrales**: `\(s_{x_1}^{2} := s_{1}^2 = \frac{1}{n} \sum_{i=1}^n \left(x_{i, 1} - \overline{x}_1 \right)^2\)` y `\(s_{x_2}^{2} := s_{2}^2 = \frac{1}{n} \sum_{i=1}^n \left(x_{i, 2} - \overline{x}_2 \right)^2\)`, donde `\(\overline{x}_1\)` y `\(\overline{x}_2\)` son sus medias muestrales.

* **Covarianza muestral**: `\(s_{x_1, x_2}^{2} := s_{1, 2} = s_{2, 1}^2 = \frac{1}{n} \sum_{i=1}^n \sum_{j=1}^n \left(x_{i, 1} - \overline{x}_1 \right)\left(x_{j, 2} - \overline{x}_2 \right)\)`

--

#### **Estimadores insesgados**

Seguramente dichos valores los hallas visto divididos por `\(n-1\)` en lugar de `\(n\)`: los valores muestrales son estimadores de los valores poblacionales, y de aqu√≠ en adelante usaremos **estimadores insesgados**, estimadores `\(T\)` del valor poblaci√≥n `\(U\)` tal que `\({\rm E}[T] = U\)`

* Estimador insesgado de `\(\mu_{x}\)`: `\(\overline{x}\)` tal que `\({\rm E}[\overline{x}] = \mu\)`

* Estimador insesgado de `\(\sigma_{x}^2\)`: la **cuasivarianza** `\(S_{x}^2 = \frac{n}{n-1} s_{x}^{2}\)` tal que `\({\rm E}[\sigma_{x}^2] = S_{x}^2\)`

* Estimador insesgado de `\(\sigma_{x, y}\)`: la **cuasicovarianza** `\(S_{x, y} = \frac{n}{n-1} s_{x, y}\)` tal que `\({\rm E}[\sigma_{x, y}] = S_{x, y}\)`

---

# Matriz de covarianzas (versi√≥n muestral)


En un **caso general**, dada una muestra `\(\boldsymbol{X}\)` de `\(n\)` individuos y `\(p\)` variables

`$$S_{x_{k}}^2 := S_{k}^2 = \frac{1}{n-1} \sum_{i=1}^{n} \left(x_{i, k} - \overline{x}_k \right)^2 \quad \text{(cuasi) var. muestrales (marginales)}$$`


`$$S_{x_{k}, x_{l}} := S_{k, l} = \frac{1}{n-1} \sum_{i=1}^{n} \sum_{j=1}^{n} \left(x_{i, k} - \overline{x}_k \right)\left(x_{j, l} - \overline{x}_l \right) \quad \text{(cuasi) covarianzas}$$`

As√≠, la **matriz de (cuasi) covarianzas emp√≠ricas** quedar√° como

`$$S := \frac{1}{n-1} \left(\boldsymbol{X} - \boldsymbol{\mu} \right)^{T} \left(\boldsymbol{X} - \boldsymbol{\mu} \right) =_{\boldsymbol{\mu} = 0} \frac{1}{n-1} \boldsymbol{X}^{T} \boldsymbol{X} = \begin{pmatrix} S_{1,1} &amp;  \ldots &amp; S_{1, p} \\ \vdots &amp; \ddots &amp; \vdots \\ S_{p,1} &amp; \ldots &amp; S_{p, p} \end{pmatrix}$$`

&amp;nbsp;

--

Las **covarianzas (y varianzas)** tienen un **¬´problema¬ª**: **dependen de la magnitud** de los datos, proporcionando una medida que solo nos sirve para ser comparada con otra covariana, pero que **no nos proporciona una escala absoluta** para poder cuantificar.

---

# Matriz de correlaciones (versi√≥n muestral)


Para resolverlo, tenemos la **correlaci√≥n (de Pearson)** 

`$$\rho_{k, l} := r_{k, l} = \frac{s_{k, l}}{\sqrt{s_{k}^2} \sqrt{s_{l}^2}} = \frac{S_{k, l}}{\sqrt{S_{k}^2} \sqrt{S_{l}^2}}$$`

tal que siempre `\(-1 \leq r_{k, l} \leq 1\)`.

&amp;nbsp;

--

De esta forma la **matriz de correlaciones** se puede expresar como

`$$R := \left(r_{k, l} \right)_{k,l=1,\ldots,p} = D^{-1/2} S D^{-1/2}, \quad D = diag(S) = \begin{pmatrix} S_{1,1}^2 &amp; \ldots &amp; 0 \\ \vdots  &amp; \ddots &amp; \vdots \\  0 &amp; \ldots &amp; S_{p, p}^2 \end{pmatrix}$$`


---


name: teoria-PCA
class: center, middle

# Teor√≠a: an√°lisis de componentes principales

---

# Objetivo: ¬øreducir dimensi√≥n?

.pull-left[

El **objetivo ¬´mainstream¬ª** del **an√°lisis de componentes principales** (PCA en ingl√©s) suele ser el de **reducir la dimensi√≥n** de nuestros datos: pasar de un conjunto de `\(n\)` individuos y `\(p\)` variables a otro de `\(k &lt; p\)` variables (para los mismos `\(n\)` individuos).

&amp;nbsp;

Esta reducci√≥n de la dimensi√≥n se suele hacer con **3 objetivos** principalmente:

* **Mejora computacional** de los algoritmos al tener un dataset m√°s reducido.

* **Permitir la visualizaci√≥n** en 2 o 3 dimensiones de conjuntos `\(n\)`-dimensionales.

* **¬´Reflotar¬ª patrones** subyacentes en los datos.

]

.pull-right[

&lt;div class="figure" style="text-align: center"&gt;
&lt;img src="https://miro.medium.com/max/959/1*kK4aMPHQ89ssFEus6RT4Yw.jpeg" alt="Extra√≠da de https://towardsdatascience.com/dimensionality-reduction-cheatsheet-15060fee3aa" width="100%" /&gt;
&lt;p class="caption"&gt;Extra√≠da de https://towardsdatascience.com/dimensionality-reduction-cheatsheet-15060fee3aa&lt;/p&gt;
&lt;/div&gt;

]

---


# Objetivo: ¬øreducir dimensi√≥n?

.pull-left[

¬øEntonces? ¬øNo tiene sentido aplicar componentes principales o t√©cnicas de reducci√≥n de la dimensi√≥n en **datos bidimensionales**?

&amp;nbsp;

Empecemos por un sencillo ejemplo, visualizando la **longitud y anchura de p√©talo** del famoso conjunto de datos `iris`

&amp;nbsp;

**¬øCu√°les podr√≠an ser los objetivos?** ¬øTiene sentido en este ejemplo aplicar **t√©cnicas de reducci√≥n de la dimensi√≥n** como las componentes principales?

]

.pull-right[

&lt;img src="index_files/figure-html/unnamed-chunk-6-1.png" width="100%" /&gt;

]

---

# Objetivo: maximizar la informaci√≥n


&lt;div class="figure" style="text-align: center"&gt;
&lt;img src="https://miro.medium.com/max/1400/1*V3JWBvxB92Uo116Bpxa3Tw.png" alt="Gr√°fica extra√≠da de https://towardsdatascience.com/a-one-stop-shop-for-principal-component-analysis-5582fb7e0a9c" width="80%" /&gt;
&lt;p class="caption"&gt;Gr√°fica extra√≠da de https://towardsdatascience.com/a-one-stop-shop-for-principal-component-analysis-5582fb7e0a9c&lt;/p&gt;
&lt;/div&gt;

Como veremos, el **objetivo real** ser√° **maximizar la informaci√≥n obtenido al menor coste posible**, y eso hace que siga siendo √∫til, aunque no reduzcamos dimensiones, hacerlo en el caso bidimensional: una **clave** de las componentes principales es que las **componentes resultantes** ser√°n **ortogonales** (perpendiculares), es decir, **linealmente independientes**.

&amp;nbsp;

Las **componentes principales** pueden ser una herramienta muy √∫til para atajar problemas de **colinealidad** (variables altamente correladas entre s√≠, interfiriendo entre ellas)


---


# Idea principal

La **idea subyacente** tras el c√°lculo de las componentes principales se puede resumir de forma **geom√©trica**: para un conjunto de puntos `\(p\)`-dimensionales, encontrar un **nuevo sistema de coordenadas** de dimensi√≥n `\(k \leq p\)` en el que expresar los datos, de forma que las **nuevas variables sean linealmente independientes**.

En el **caso bidimensional**, el resultado de aplicar componentes principales ser√° una especie de ¬´rotaci√≥n¬ª de los datos


&lt;img src="https://miro.medium.com/max/1400/1*V3JWBvxB92Uo116Bpxa3Tw.png" width="75%" style="display: block; margin: auto;" /&gt;

üìö **¬´Principal Component Analysis¬ª**. Herv√© and Lynne (2010) &lt;http://staff.ustc.edu.cn/~zwp/teach/MVA/abdi-awPCA2010.pdf&gt;


---

# Idea principal: caso bidimensional


En el **caso bidimensional**, la idea ser√° buscar esa **elipse** en torno a la cual tenemos los datos, de forma que la direcci√≥n que marca el **eje mayor** ser√° la **primera componente** (la que tiene mayor rango --&gt; mayor varianza) y la direcci√≥n que marca el **eje menor** ser√° la **segunda componente**.


.pull-left[

&lt;div class="figure" style="text-align: center"&gt;
&lt;img src="./img/pca_words_1.jpg" alt="Gr√°fica extra√≠da de Herv√© and Lynne (2010)" width="77%" /&gt;
&lt;p class="caption"&gt;Gr√°fica extra√≠da de Herv√© and Lynne (2010)&lt;/p&gt;
&lt;/div&gt;

]


.pull-right[

&lt;div class="figure" style="text-align: center"&gt;
&lt;img src="./img/pca_words_23.jpg" alt="Gr√°fica extra√≠da de Herv√© and Lynne (2010)" width="58%" /&gt;
&lt;p class="caption"&gt;Gr√°fica extra√≠da de Herv√© and Lynne (2010)&lt;/p&gt;
&lt;/div&gt;

]

üìö **¬´Principal Component Analysis¬ª**. Herv√© and Lynne (2010) &lt;http://staff.ustc.edu.cn/~zwp/teach/MVA/abdi-awPCA2010.pdf&gt;

---

# Caso inicial bidimensional


.pull-left[

Vamos a empezar por un **ejemplo sencillo (bidimensional)** tomando de `{iris}` solo las variables del p√©talo (y la specie)


```r
library(tidyverse)
iris_tb &lt;- as_tibble(iris)
iris_bi &lt;- iris_tb[, 3:5]
```


]

.pull-right[

&lt;img src="index_files/figure-html/unnamed-chunk-12-1.png" width="100%" /&gt;

]

---

# Caso bidimensional

.pull-left[

1. Encontrar las **direcci√≥nes de m√°xima varianza**. Dichas direcciones vendr√°n determinadas por **dos vectores** `\(\left\lbrace \boldsymbol{\Phi}_1, \boldsymbol{\Phi}_2 \right\rbrace\)` perpendiculares entre s√≠ y que ser√°n **combinaci√≥n lineal de las variables** originales.

`$$\Phi_1 = z_{1, 1} * \boldsymbol{x}_1 + z_{2, 1} * \boldsymbol{x}_2, \quad \Phi_2 = z_{1, 2} * \boldsymbol{x}_1 + z_{2, 2} * \boldsymbol{x}_2$$`


]

.pull-right[

&lt;div class="figure" style="text-align: center"&gt;
&lt;img src="./img/pca_iris_1.jpg" alt="Direcciones de m√°xima varianza" width="85%" /&gt;
&lt;p class="caption"&gt;Direcciones de m√°xima varianza&lt;/p&gt;
&lt;/div&gt;

]

---

# Caso bidimensional

.pull-left[


1. Encontrar las **direcci√≥nes de m√°xima varianza**. Dichas direcciones vendr√°n determinadas por **dos vectores** `\(\left\lbrace \Phi_1, \Phi_2 \right\rbrace\)` perpendiculares entre s√≠ y que ser√°n **combinaci√≥n lineal de las variables** originales.
`$$\Phi_1 = z_{1, 1} * \boldsymbol{x}_1 + z_{2, 1} * \boldsymbol{x}_2, \quad \Phi_2 = z_{1, 2} * \boldsymbol{x}_1 + z_{2, 2} * \boldsymbol{x}_2$$`

2. Dado un registro `\(\boldsymbol{x}_i = \left(x_{i, 1}, x_{i, 2} \right)\)` (que puede entenderse como un vector `\(\overline{\boldsymbol{x}}_i := \boldsymbol{x}_i\)`), lo que haremos ser√° obtener las **nuevas coordenadas** **proyectando ortogonalmente** el vector sobre las nuevas direcciones:
`$$x_{i, 1}' =\left| \boldsymbol{x}_i \right| cos (\alpha)  =  \frac{\langle \boldsymbol{x}_i, \Phi_1 \rangle}{ \left| \Phi_1 \right|}, \quad x_{i, 2}' =  \frac{\langle \boldsymbol{x}_i, \Phi_2 \rangle}{ \left| \Phi_2 \right|}$$`

]

.pull-right[

&lt;div class="figure" style="text-align: center"&gt;
&lt;img src="./img/pca_iris_2.jpg" alt="Proyecci√≥n ortogonal" width="78%" /&gt;
&lt;p class="caption"&gt;Proyecci√≥n ortogonal&lt;/p&gt;
&lt;/div&gt;

]

---


# Caso bidimensional

.pull-left[


1. Encontrar las **direcci√≥nes de m√°xima varianza**. Dichas direcciones vendr√°n determinadas por **dos vectores** `\(\left\lbrace \Phi_1, \Phi_2 \right\rbrace\)` perpendiculares entre s√≠ y que ser√°n **combinaci√≥n lineal de las variables** originales.
`$$\Phi_1 = z_{1, 1} * \boldsymbol{x}_1 + z_{2, 1} * \boldsymbol{x}_2, \quad \Phi_2 = z_{1, 2} * \boldsymbol{x}_1 + z_{2, 2} * \boldsymbol{x}_2$$`

2. Dado un registro `\(\boldsymbol{x}_i = \left(x_{i, 1}, x_{i, 2} \right)\)` (que puede entenderse como un vector `\(\overline{\boldsymbol{x}}_i := \boldsymbol{x}_i\)`), lo que haremos ser√° obtener las **nuevas coordenadas** **proyectando ortogonalmente** el vector sobre las nuevas direcciones:
`$$x_{i, 1}' =\left| \boldsymbol{x}_i \right| cos (\alpha)  =  \frac{\langle \boldsymbol{x}_i, \Phi_1 \rangle}{ \left| \Phi_1 \right|}, \quad x_{i, 2}' =  \frac{\langle \boldsymbol{x}_i, \Phi_2 \rangle}{ \left| \Phi_2 \right|}$$`

3. Las **nuevas direcciones** las seleccionaremos  **ortonormales** (m√≥dulo unitario):
`$$x_{i, 1}'  =  \langle \boldsymbol{x}_i, \Phi_1 \rangle =  \left(x_{i, 1}, x_{i, 2} \right) \left(z_{1, 1}, z_{2, 1} \right)^{T} = \boldsymbol{x}_{i} \boldsymbol{\Phi}_{1}^{T}, \quad x_{i, 2}' = \langle \boldsymbol{x}_i, \Phi_2 \rangle = \boldsymbol{x}_{i} \boldsymbol{\Phi}_{2}^{T}$$`

]

.pull-right[

&lt;div class="figure" style="text-align: center"&gt;
&lt;img src="./img/pca_iris_2.jpg" alt="Proyecci√≥n ortogonal" width="78%" /&gt;
&lt;p class="caption"&gt;Proyecci√≥n ortogonal&lt;/p&gt;
&lt;/div&gt;

]

---

# Idea general


Nuestros datos originales `\(\boldsymbol{X}\)`  (dimensiones `\(n \times p\)`) ser√°n reconvertidos en un conjunto `\(\boldsymbol{X}'\)` de dimensiones `\(n \times k\)`, con `\(k \leq p\)`, tal que 

`$$\boldsymbol{X}' = \boldsymbol{X} \boldsymbol{\Phi}^{T}$$`

--

tal que `\(\boldsymbol{\Phi}^{T}\)` es una matriz `\(p \times k\)` que contiene por columnas las `\(k\)` **direcciones principales**

`$$\boldsymbol{\Phi}^{T} = \begin{pmatrix} z_{1,1} &amp; z_{2,1} &amp; \ldots &amp; z_{k,1} \\ z_{1,2} &amp; z_{2,2} &amp; \ldots &amp; z_{k,2} \\ \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\ z_{1,p} &amp; z_{2,p} &amp; \ldots &amp; z_{k,p} \end{pmatrix}$$`

--

bajo la condici√≥n de que sean **direcciones ortonormales**

`$$\Phi \Phi^{T} = \begin{pmatrix} 1 &amp; \ldots &amp; 0 \\  \vdots &amp;  \ddots &amp; \vdots \\ 0  &amp; \ldots &amp; 1 \end{pmatrix}$$`

tal que dichas direcciones **maximicen la varianza**.

---

# Primera componente

Por ejemplo, para la **primera componente** el objetivo es encontrar, de entre todas las direcciones  `\(\boldsymbol{u}_1\)` posibles, la direcci√≥n `\(\boldsymbol{\Phi}_1\)` que **maximice la varianza de nuestros datos cuando los proyectamos sobre dicha direcci√≥n**

`$$\boldsymbol{x}_{1}' = \boldsymbol{X} \boldsymbol{\Phi}_{1}^{T} = \begin{pmatrix} x_{1,1} &amp; x_{1, 2} &amp; \ldots &amp; x_{1, p} \\ x_{2,1} &amp; x_{2, 1} &amp; \ldots &amp; x_{2, p} \\ \vdots &amp; \vdots &amp; \ddots &amp; \vdots
\\ x_{n,1} &amp; x_{n, 2} &amp; \ldots &amp; x_{n, p}\end{pmatrix} \begin{pmatrix} z_{1,1} \\ z_{1,2} \\ \vdots \\ z_{1,p} \end{pmatrix} =  \begin{pmatrix} x_{1,1}^{'} \\ x_{2,1}^{'} \\ \vdots \\ x_{n, 1}^{'} \end{pmatrix}$$`


--

&amp;nbsp;

Dicha direcci√≥n por tanto saldr√° de un proceso de **optimizaci√≥n**

`$$\boldsymbol{\Phi}_1 = \arg \max_{\boldsymbol{u}_{1}^{T} \boldsymbol{u}_1 = 1} {\rm Var} \left( \boldsymbol{x}_{1}'  \right) = \arg \max_{\boldsymbol{u}_{1}^{T} \boldsymbol{u}_1 = 1} {\rm Var} \left( \boldsymbol{X} \boldsymbol{u}_{1}^{T} \right)$$`

---

# Primera componente

Dicha direcci√≥n por tanto saldr√° de un proceso de **optimizaci√≥n**

`$$\boldsymbol{\Phi}_1 = \arg \max_{\boldsymbol{u}_{1}^{T} \boldsymbol{u}_1 = 1} {\rm Var} \left( \boldsymbol{x}_{1}'  \right) = \arg \max_{\boldsymbol{u}_{1}^{T} \boldsymbol{u}_1 = 1} {\rm Var} \left( \boldsymbol{X} \boldsymbol{u}_{1}^{T} \right)$$`

--

Si **centramos los datos** (restamos su media para tener media nula)


`$$\begin{eqnarray}\boldsymbol{\Phi}_1 &amp;=&amp; \arg \max_{\boldsymbol{u}_{1}^{T} \boldsymbol{u}_{1} = 1} {\rm Var} \left( \boldsymbol{X}\boldsymbol{u}_{1}^{T} \right) = \arg \max_{\boldsymbol{u}_{1}^{T} \boldsymbol{u}_1 = 1} \left({\rm E} \left[\left( \boldsymbol{X} \boldsymbol{u}_1^{T} \right)^{T}\left( \boldsymbol{X} \boldsymbol{u}_{1}^{T} \right)\right] \right) \\ &amp;=&amp; \arg \max_{\boldsymbol{u}_{1}^{T} \boldsymbol{u}_{1} = 1} \left({\rm E} \left[ \boldsymbol{u}_{1} \boldsymbol{X}^{T} \boldsymbol{X} \boldsymbol{u}_1^{T} \right] \right) = \arg \max_{\boldsymbol{u}_{1}^{T} \boldsymbol{u}_1 = 1} \left( \boldsymbol{u}_1 {\rm E} \left[\boldsymbol{X}^{T} \boldsymbol{X} \right] \boldsymbol{u}_{1}^{T}  \right) \\ &amp;=&amp; \arg \max_{\boldsymbol{u}_{1}^{T} \boldsymbol{u}_1 = 1} \left( \boldsymbol{u}_1 S \boldsymbol{u}_{1}^{T}  \right)\end{eqnarray}$$`

--

Si **estandarizamos los datos** (restamos su media y dividimos entre su desviaci√≥n t√≠pica, teniendo **datos con media cero y varianza unitaria** para que todos los datos ponderen por igual)

`$$\boldsymbol{\Phi}_1 = \arg \max_{\boldsymbol{u}_{1}^{T} \boldsymbol{u}_1 = 1} {\rm Var} \left( \boldsymbol{X} \boldsymbol{u}_1^{T} \right) = \arg \max_{\boldsymbol{u}_{1}^{T} \boldsymbol{u}_1 = 1} \left( \boldsymbol{u}_1 S \boldsymbol{u}_1^{T}  \right) = \arg \max_{\boldsymbol{u}_{1}^{T} \boldsymbol{u}_1 = 1} \left( \boldsymbol{u}_1 R \boldsymbol{u}_1^{T}  \right)$$`

---

# Primera componente

Para **encontrar esa direcci√≥n `\(\boldsymbol{u}_1\)`** que nos maximiza la varianza de los proyectados en ella, sujeto a la restrcci√≥n de que `\(\boldsymbol{u}_{1}^{T} \boldsymbol{u}_1 = 1\)`, se puede usar la t√©cnica de los **multiplicadores de Lagrange** que nos dice que

`$$\boldsymbol{\Phi}_1 =  \arg \max_{\boldsymbol{u}_{1}^{T} \boldsymbol{u}_1 = 1} \left( \boldsymbol{u}_1 R \boldsymbol{u}_1^{T}  \right) = \arg \max_{\boldsymbol{u}_{1}^{T} \boldsymbol{u}_1 = 1} \left( \boldsymbol{u}_1 R \boldsymbol{u}_1^{T}  - \lambda \left(\boldsymbol{u}_1^{T} \boldsymbol{u}_1  - 1\right) \right), \quad \lambda \in \mathbb{R}$$`

--

Eso es equivalente a encontrar el valor que nos **iguale la derivada a cero**

`$$\frac{\partial}{\partial \boldsymbol{u}_1} \left( \boldsymbol{u}_1 R \boldsymbol{u}_1^{T}  - \lambda \left(\boldsymbol{u}_1^{T} \boldsymbol{u}_1  - 1\right) \right) =   R \boldsymbol{u}_1  - \lambda \boldsymbol{u}_1^{T} = \left(R - \lambda \boldsymbol{Id}_{p} \right) \boldsymbol{u}_1^{T}  =  0$$`
--

Esto es lo mismo que decir que `\(R \boldsymbol{u}_1^{T}  = \lambda \boldsymbol{u}_1^{T}\)`, es decir, la direcci√≥n que buscamos `\(\boldsymbol{u}_{1}^{T}\)` es un **autovector de la matriz de covarianzas** (tras **estandarizar** los datos).

---

# Par√©ntesis: autovectores y autovalores

En √°lgebra matricial, dada una matriz `\(\boldsymbol{A}\)` cuadrada de tama√±o `\(p \times p\)`, decimos que `\(v\)` es su **autovector** y `\(\lambda\)` su **autovalor asociado** si y solo s√≠

`$$A v= \lambda v, \quad v = \left(v_1, \ldots, v_p \right) \neq 0$$`

Esto es equivalente a decir que 

`$$A v - \lambda v = 0 \rightarrow (A - \lambda I_{p}) v = 0$$`

donde `\(I_p\)` es la matriz identidad de tama√±o `\(p \times p\)`. Dicha ecuaci√≥n tiene soluci√≥n si y solo s√≠

`$$\left| A - \lambda I_{p} \right| = 0$$`

Adem√°s, por el **Teorema Fundamental del Algebra** sabemos que dicho determinante puede expresarse como un polinomio de grado `\(p\)` (conocido como **polinomio caracter√≠stico**)

`$$\left| A - \lambda I_{p} \right| = \left(\lambda_1 - \lambda \right)\left(\lambda_2 - \lambda \right) \ldots \left(\lambda_p - \lambda \right) = p (\lambda)$$`

Adem√°s el determinante `\(\left| A \right|\)` ser√° el producto de todos sus autovalores.

---

# Primera componente

Recapitulando, para obtener la **primera componente** `\(\boldsymbol{\Phi}_1\)`, debemos de 

* **Estandarizar** nuestros datos
* Calcular la **matriz de (cuasi)covarianzas** `\(\boldsymbol{S}\)`
* Calcula sus **autovectores** tal que `\(S \boldsymbol{\Phi}_{1}^{T} = \lambda_1 \boldsymbol{\Phi}_{1}^{T}\)` (normalizados a m√≥dulo 1).

--

Adem√°s si es un autovector de la matriz de covarianzas tenemos entonces que la **varianza maximizada**, la **proporci√≥n de informaci√≥n** que **explica dicha componente**, ser√°

`$$\boldsymbol{\Phi}_{1} \left(  S \boldsymbol{\Phi}_{1}^{T} \right) = \boldsymbol{\Phi}_{1} \left( R \boldsymbol{\Phi}_{1}^{T} \right) =\boldsymbol{\Phi}_{1}\left(  \lambda_1 \boldsymbol{\Phi}_{1}^{T} \right) =  \lambda_1 \boldsymbol{\Phi}_{1} \boldsymbol{\Phi}_{1}^{T} =_{\text{ortonormales}} \lambda_1$$` 

--

As√≠ que obtener la direcci√≥n (de todos los autovalores) que mayor informaci√≥n captura nos fijaremos en aquella que tenga **asociada el autovalor m√°s grande**.


`$$\boldsymbol{x}_{1}' = \boldsymbol{X} \boldsymbol{\Phi}_{1}^{T} = \begin{pmatrix} x_{1,1} &amp; \ldots &amp; x_{1, p}  \\ \vdots  &amp; \ddots &amp; \vdots
\\ x_{n,1}  &amp; \ldots &amp; x_{n, p}\end{pmatrix} \begin{pmatrix} z_{1,1} \\ \vdots \\ z_{1,p} \end{pmatrix} =  \begin{pmatrix} x_{1,1}^{'} \\ \vdots \\ x_{n, 1}^{'} \end{pmatrix}$$`

donde `\(S \boldsymbol{\Phi}_{1}^{T} = \lambda_1 \boldsymbol{\Phi}_{1}^{T}\)`, siendo `\(\lambda_1\)` el mayor de los autovalores de la matriz de (cuasi)covarianzas `\(S\)`, y `\(\boldsymbol{\Phi}_{1}^{T}\)` su autovector asociado. El **resto de las componentes** se obtendr√°n de forma similar, siendo ortogonales a cada una de las direcciones obtenidas.

---

# Idea general paso a paso 

El proceso completo es el siguiente:

* Dados unos datos `\(\boldsymbol{X}\)` de `\(n\)` individuos y `\(p\)` variables, el objetivo es encontrar nuevas **direcciones ortonormales** `\(\left\lbrace \boldsymbol{\Phi}_1, \ldots, \boldsymbol{\Phi}_k \right\rbrace\)`, con `\(1 \leq k \leq p\)`, como combinaci√≥n lineal de las variables originales.

* Los **datos son estandarizados**  tal que

`$$\begin{pmatrix} \frac{x_{1,1} - \overline{x}_1}{S_{1}} &amp; \frac{x_{1,2} - \overline{x}_2}{S_{2}} &amp; \ldots &amp; \frac{x_{1,p} - \overline{x}_p}{S_{p}} \\  \frac{x_{2,1} - \overline{x}_1}{S_{1}} &amp; \frac{x_{2,2} - \overline{x}_2}{S_{2}} &amp; \ldots &amp; \frac{x_{2,p} - \overline{x}_p}{S_{p}} \\ \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\ \frac{x_{n,1} - \overline{x}_1}{S_{1}} &amp; \frac{x_{n,2} - \overline{x}_2}{S_{2}} &amp; \ldots &amp; \frac{x_{n,p} - \overline{x}_p}{S_{p}} \end{pmatrix}$$`

* Calcular la **matriz `\(S\)` de (cuasi)covarianzas** de dichos datos estandarizados.

---

# Idea general paso a paso 

El proceso completo es el siguiente:

* Calculamos los `\(p\)` **autovectores** `\(\left\lbrace \boldsymbol{\Phi}_1, \ldots, \boldsymbol{\Phi}_p \right\rbrace\)`, y sus **autovalores asociados** `\(\left\lbrace \lambda_1, \ldots, \lambda_p \right\rbrace\)`, de la matriz `\(S\)`, tal que `\(S  \boldsymbol{\Phi}_k = \lambda_k  \boldsymbol{\Phi}_k\)`.

* Seleccionamos las primeras `\(k \leq p\)` componentes `\(\left\lbrace \boldsymbol{\Phi}_1, \ldots, \boldsymbol{\Phi}_k \right\rbrace\)` asociadas a los primeros `\(\left\lbrace \lambda_1, \ldots, \lambda_k \right\rbrace\)` autovalores.

* La **varianza (informaci√≥n) capturada** por la direcci√≥n `\(k\)`-√©sima ser√° igual a `\(\lambda_k\)`.

* Las nuevas coordenadas ser√°n

`$$\boldsymbol{X}^{'} = \boldsymbol{X} \boldsymbol{\Phi}^{T} = \begin{pmatrix} x_{1,1} &amp; x_{1, 2} &amp; \ldots &amp; x_{1, p} \\ x_{2,1} &amp; x_{2, 1} &amp; \ldots &amp; x_{2, p} \\ \vdots &amp; \vdots &amp; \ddots &amp; \vdots
\\ x_{n,1} &amp; x_{n, 2} &amp; \ldots &amp; x_{n, p}\end{pmatrix} \begin{pmatrix} z_{1,1} &amp; z_{2,1} &amp; \ldots &amp; z_{k,1} \\ z_{1,2} &amp; z_{2,2} &amp; \ldots &amp; z_{k,2}  \\ \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\ z_{1,p} &amp; z_{2,p} &amp; \ldots &amp; z_{k,p} \end{pmatrix} = \begin{pmatrix} \boldsymbol{x}_1 \boldsymbol{\Phi}_1^{T} &amp; \boldsymbol{x}_1 \boldsymbol{\Phi}_2^{T} &amp; \ldots &amp; \boldsymbol{x}_1 \boldsymbol{\Phi}_k^{T} \\ \boldsymbol{x}_2 \boldsymbol{\Phi}_1^{T} &amp; \boldsymbol{x}_2 \boldsymbol{\Phi}_2^{T} &amp; \ldots &amp; \boldsymbol{x}_2 \boldsymbol{\Phi}_k^{T} \\ \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\ \boldsymbol{x}_n \boldsymbol{\Phi}_1^{T} &amp; \boldsymbol{x}_n \boldsymbol{\Phi}_2^{T} &amp; \ldots &amp; \boldsymbol{x}_n \boldsymbol{\Phi}_k^{T}\end{pmatrix}$$`

---

# Glosario 

* **Autovectores**: nos indican la **direcci√≥n de la componente**

* **Loadings**: ser√°n los **coeficientes** de dichos autovectores (los que generan la combinaci√≥n lineal de las variables originales) nos indican el **peso que tiene cada variable original en dicha componente**. Si por ejemplo `\(\boldsymbol{\Phi}_1 = \left(0.95, 0.15, 0.273 \right)\)`, significa que la primera componente (la que m√°s varianza captura) ser√° `\(0.95* \boldsymbol{X}_1 + 0.15 * \boldsymbol{X}_2 + 0.273 * \boldsymbol{X}_3\)`, estando dominada por la variable original `\(\boldsymbol{X}_1\)` (un peso de 0.95).


* **Signo de los loadings**: nos indica el **sentido de la relaci√≥n entre la componente y la variable original** (correlaci√≥n positiva/negativa). Si alguno de ellos fuese 0 significar√≠a que la nueva componente est√° incorrelada respecto a dicha variable original.


* **Scores**: para cada observaci√≥n `\(i\)`, las nuevas coordenadas `\(\left(x_{i, 1}^{'}, \ldots, x_{i, k}^{'} \right)\)`, calculadas tras **proyectar la observaci√≥n original en las direcciones principales** `\(\boldsymbol{x}_{i} \boldsymbol{\Phi}^{T}\)`.


* **Truncamiento o n√∫mero de componentes**: para seleccionar el n√∫mero `\(k\)` de componentes a seleccionar el m√©todo m√°s sencillo es **fijar de antemano** un **umbral varianza explicada** que queremos conservar (por ejemplo, `\(95%\)`), de forma que nos quedemos con el primer n√∫mero `\(k\)` tal que `\(\sum_{j=1}^{k} \lambda_k &gt; 0.95\)` (**varianza explicada acumulada**, teniendo los autovalores ordenados de mayor a menor).


---


name: practica-PCA
class: center, middle

# Pr√°ctica: PCA en R

---

# PCA en R: caso ¬´manual¬ª


Volvemos a nuestro **ejemplo sencillo (bidimensional)** tomando de `{iris}` solo las variables del p√©talo.


```r
library(tidyverse)
iris_tb &lt;- as_tibble(iris)
iris_bi &lt;- iris_tb[, 3:5]
iris_bi
```

```
&gt; # A tibble: 150 √ó 3
&gt;    Petal.Length Petal.Width Species
&gt;           &lt;dbl&gt;       &lt;dbl&gt; &lt;fct&gt;  
&gt;  1          1.4         0.2 setosa 
&gt;  2          1.4         0.2 setosa 
&gt;  3          1.3         0.2 setosa 
&gt;  4          1.5         0.2 setosa 
&gt;  5          1.4         0.2 setosa 
&gt;  6          1.7         0.4 setosa 
&gt;  7          1.4         0.3 setosa 
&gt;  8          1.5         0.2 setosa 
&gt;  9          1.4         0.2 setosa 
&gt; 10          1.5         0.1 setosa 
&gt; # ‚Ä¶ with 140 more rows
&gt; # ‚Ñπ Use `print(n = ...)` to see more rows
```

---

# PCA en R: caso ¬´manual¬ª


**Primer paso**: **estandarizar** los datos


```r
iris_bi_std &lt;- tibble(as_tibble(scale(iris_bi[, 1:2])),
                      "Species" = iris_bi$Species)
names(iris_bi_std) &lt;- names(iris_bi)
iris_bi_std
```

```
&gt; # A tibble: 150 √ó 3
&gt;    Petal.Length Petal.Width Species
&gt;           &lt;dbl&gt;       &lt;dbl&gt; &lt;fct&gt;  
&gt;  1        -1.34       -1.31 setosa 
&gt;  2        -1.34       -1.31 setosa 
&gt;  3        -1.39       -1.31 setosa 
&gt;  4        -1.28       -1.31 setosa 
&gt;  5        -1.34       -1.31 setosa 
&gt;  6        -1.17       -1.05 setosa 
&gt;  7        -1.34       -1.18 setosa 
&gt;  8        -1.28       -1.31 setosa 
&gt;  9        -1.34       -1.31 setosa 
&gt; 10        -1.28       -1.44 setosa 
&gt; # ‚Ä¶ with 140 more rows
&gt; # ‚Ñπ Use `print(n = ...)` to see more rows
```

---

# PCA en R: caso ¬´manual¬ª

.pull-left[
&lt;img src="index_files/figure-html/unnamed-chunk-18-1.png" width="100%" /&gt;

]

.pull-right[

&lt;img src="index_files/figure-html/unnamed-chunk-19-1.png" width="100%" /&gt;

]

---


# PCA en R: caso ¬´manual¬ª

**Segundo paso**: calcular la **matriz de covarianzas** (solo con las num√©ricas)


```r
cov_mat &lt;- cov(iris_bi_std[, 1:2])
cov_mat
```

```
&gt;              Petal.Length Petal.Width
&gt; Petal.Length    1.0000000   0.9628654
&gt; Petal.Width     0.9628654   1.0000000
```

Al estar estandarizados los datos, es equivalente a calcular la **matriz de correlaciones**


```r
cor_mat &lt;- cor(iris_bi_std[, 1:2])
cor_mat
```

```
&gt;              Petal.Length Petal.Width
&gt; Petal.Length    1.0000000   0.9628654
&gt; Petal.Width     0.9628654   1.0000000
```

---

# PCA en R: caso ¬´manual¬ª

**Tercer paso**: calcular los **autovalores y autovectores** de la matriz de covarianzas


```r
autocosas &lt;- eigen(cor_mat)
autocosas
```

```
&gt; eigen() decomposition
&gt; $values
&gt; [1] 1.96286543 0.03713457
&gt; 
&gt; $vectors
&gt;           [,1]       [,2]
&gt; [1,] 0.7071068 -0.7071068
&gt; [2,] 0.7071068  0.7071068
```

**IMPORTANTE** al tener las **variables estandarizadas**, la **suma de los autovalores** es `\(p\)` (ya que ser√° la suma de las varianzas de las variables que tenemos).

---

# PCA en R: caso ¬´manual¬ª

**Cuarto paso**: comprobar que est√°n **ordenados** los autovectores segun autovalores (de mayor a menor).


```r
lambda &lt;- autocosas$values
lambda
```

```
&gt; [1] 1.96286543 0.03713457
```

La **varianza capturada** por `\(\boldsymbol{\Phi}_1\)` es `\(1.963\)` y `\(0.037\)` para la segunda componente `\(\boldsymbol{\Phi}_2\)`.


```r
# los llamados loadings
autocosas$vectors 
```

```
&gt;           [,1]       [,2]
&gt; [1,] 0.7071068 -0.7071068
&gt; [2,] 0.7071068  0.7071068
```

---

# PCA en R: caso ¬´manual¬ª


**Quinto paso**: calcular la **varianza explicada acumulada** por cada componente (una vez ordenadas)


```r
cumsum_var &lt;- cumsum(lambda) / sum(lambda)
cumsum_var
```

```
&gt; [1] 0.9814327 1.0000000
```

La **primera componente captura el 98.14% de la informaci√≥n (de la varianza)** y la segunda el 1.86% restante.

---

# PCA en R: caso ¬´manual¬ª

* **Sexto paso**: proyectar en las nuevas componentes para obtener las **nuevas coordenadas** (¬°respecto a la nueva base!), los llamados **scores**
 


```r
scores &lt;- tibble(as_tibble(as.matrix(iris_bi_std[, -3]) %*% autocosas$vectors),
                 "Species" = iris_bi_std$Species)
names(scores) &lt;- c("PC1", "PC2", "Species")
scores
```

```
&gt; # A tibble: 150 √ó 3
&gt;      PC1     PC2 Species
&gt;    &lt;dbl&gt;   &lt;dbl&gt; &lt;fct&gt;  
&gt;  1 -1.87  0.0175 setosa 
&gt;  2 -1.87  0.0175 setosa 
&gt;  3 -1.91  0.0575 setosa 
&gt;  4 -1.83 -0.0226 setosa 
&gt;  5 -1.87  0.0175 setosa 
&gt;  6 -1.57  0.0828 setosa 
&gt;  7 -1.78  0.110  setosa 
&gt;  8 -1.83 -0.0226 setosa 
&gt;  9 -1.87  0.0175 setosa 
&gt; 10 -1.92 -0.115  setosa 
&gt; # ‚Ä¶ with 140 more rows
&gt; # ‚Ñπ Use `print(n = ...)` to see more rows
```

---

# PCA en R: con prcomp

Dentro de los paquete b√°sicos cargados por `R` tenemos `prcomp` que nos permite realizar los c√°lculos anteriores de manera autom√°tica (`scale. = TRUE` y `center = TRUE` debe ser indicado si los han datos no entran estandarizados previamente).


```r
pca &lt;- prcomp(iris_bi[, -3], scale. = TRUE, center = TRUE)
pca
```

```
&gt; Standard deviations (1, .., p=2):
&gt; [1] 1.4010230 0.1927033
&gt; 
&gt; Rotation (n x k) = (2 x 2):
&gt;                    PC1        PC2
&gt; Petal.Length 0.7071068 -0.7071068
&gt; Petal.Width  0.7071068  0.7071068
```

* **Rotation**: la matriz cuyas columnas son las componentes principales `\(\boldsymbol{\Phi}_1, \boldsymbol{\Phi}_2\)` (recuerda que dijimos que est√°bamos ¬´rotando¬ª los datos).

* **Standard deviations**: dado que cada `\(\lambda_j = {\rm Var} \left(\boldsymbol{\Phi}_j \right)\)` representa la varianza de las componentes principales, lo que nos proporciona la salida es `\(\sqrt{\lambda_j}\)`, para cada `\(j=1,\ldots,p\)`


```r
pca$sdev^2 # autovalores
```

```
&gt; [1] 1.96286543 0.03713457
```

---

# PCA en R: con prcomp


```r
pca &lt;- prcomp(iris_bi[, -3], scale. = TRUE)
pca
```

```
&gt; Standard deviations (1, .., p=2):
&gt; [1] 1.4010230 0.1927033
&gt; 
&gt; Rotation (n x k) = (2 x 2):
&gt;                    PC1        PC2
&gt; Petal.Length 0.7071068 -0.7071068
&gt; Petal.Width  0.7071068  0.7071068
```

La **primera componente** viene definida como

`$$\boldsymbol{\Phi}_1 = 0.7071068 * Petal.Length^* +  0.7071068 * Petal.Width^*$$` 

La **segunda componente** viene definida como 

`$$\boldsymbol{\Phi}_2 = -0.7071068 * Petal.Length^* +  0.7071068 * Petal.Width^*$$`


---

# PCA en R: con prcomp

.pull-left[

En `pca$x` quedan guardados los **scores** o nuevas coordenadas de nuestros datos


```r
as_tibble(pca$x)
```

```
&gt; # A tibble: 150 √ó 2
&gt;      PC1     PC2
&gt;    &lt;dbl&gt;   &lt;dbl&gt;
&gt;  1 -1.87  0.0175
&gt;  2 -1.87  0.0175
&gt;  3 -1.91  0.0575
&gt;  4 -1.83 -0.0226
&gt;  5 -1.87  0.0175
&gt;  6 -1.57  0.0828
&gt;  7 -1.78  0.110 
&gt;  8 -1.83 -0.0226
&gt;  9 -1.87  0.0175
&gt; 10 -1.92 -0.115 
&gt; # ‚Ä¶ with 140 more rows
&gt; # ‚Ñπ Use `print(n = ...)` to see more rows
```

]

.pull-right[

Tambi√©n podemos calcularlas nosotros mismos **proyectando los datos en las nuevas componentes**


```r
as_tibble(as.matrix(iris_bi_std[, -3]) %*% pca$rotation)
```

```
&gt; # A tibble: 150 √ó 2
&gt;      PC1     PC2
&gt;    &lt;dbl&gt;   &lt;dbl&gt;
&gt;  1 -1.87  0.0175
&gt;  2 -1.87  0.0175
&gt;  3 -1.91  0.0575
&gt;  4 -1.83 -0.0226
&gt;  5 -1.87  0.0175
&gt;  6 -1.57  0.0828
&gt;  7 -1.78  0.110 
&gt;  8 -1.83 -0.0226
&gt;  9 -1.87  0.0175
&gt; 10 -1.92 -0.115 
&gt; # ‚Ä¶ with 140 more rows
&gt; # ‚Ñπ Use `print(n = ...)` to see more rows
```

]

---

# Visualizando la transformaci√≥n

.pull-left[

&lt;img src="index_files/figure-html/unnamed-chunk-32-1.png" width="100%" /&gt;

]

.pull-right[


&lt;img src="index_files/figure-html/unnamed-chunk-33-1.png" width="100%" /&gt;

]

---

# Visualizando la transformaci√≥n


Si ahora pintamos los datos **codificando el color en funci√≥n de la especie** podemos darnos cuenta de por qu√© la primera componente es la que captura pr√°cticamente toda la informaci√≥n.

.pull-left[

&lt;img src="index_files/figure-html/unnamed-chunk-34-1.png" width="100%" /&gt;

]

.pull-right[


&lt;img src="index_files/figure-html/unnamed-chunk-35-1.png" width="100%" /&gt;

]


---

# PCA en R: con factominer y factoextra

Ahora que controlamos un poco c√≥mo se calculan y qu√© significan, vamos a ampliar al dataset entero de iris `{iris}` con sus **4 variables num√©ricas**


```r
# Covarianza y correlaci√≥n sin estandarizar antes (solo num√©ricas)
cov(iris_tb[, -5])
```

```
&gt;              Sepal.Length Sepal.Width Petal.Length Petal.Width
&gt; Sepal.Length    0.6856935  -0.0424340    1.2743154   0.5162707
&gt; Sepal.Width    -0.0424340   0.1899794   -0.3296564  -0.1216394
&gt; Petal.Length    1.2743154  -0.3296564    3.1162779   1.2956094
&gt; Petal.Width     0.5162707  -0.1216394    1.2956094   0.5810063
```

```r
cor(iris_tb[, -5])
```

```
&gt;              Sepal.Length Sepal.Width Petal.Length Petal.Width
&gt; Sepal.Length    1.0000000  -0.1175698    0.8717538   0.8179411
&gt; Sepal.Width    -0.1175698   1.0000000   -0.4284401  -0.3661259
&gt; Petal.Length    0.8717538  -0.4284401    1.0000000   0.9628654
&gt; Petal.Width     0.8179411  -0.3661259    0.9628654   1.0000000
```

---

# PCA en R: con factominer y factoextra

.pull-left[

Las correlaciones tambi√©n podemos **visualizarlas** con el paquete `{corrplot}`

Las variables con mayor correlaci√≥n (positiva adem√°s) es entre la longitud y la anchura del p√©talo.


```r
library(corrplot)
corrplot(cor(iris_tb[, -5]),
         type = "upper",
         tl.col = "black")
```

]

.pull-right[

&lt;img src="index_files/figure-html/unnamed-chunk-38-1.png" width="100%" /&gt;
]

---


# PCA en R: con factominer y factoextra

Con `{FactoMineR}` podemos calcular con `PCA()` de forma muy sencilla, indic√°ndole que de momento no queremos gr√°ficos, que queremos tantas componentes como variables (luego ya decidiremos con cual nos quedamos) y que estandarice los datos (`scale.unit = TRUE`).


```r
library(FactoMineR)
library(factoextra)
pca_fit &lt;-
  PCA(iris_tb[, -5], scale.unit = TRUE, ncp = 4, graph = FALSE)
```

En `ncp = ...` le indicamos las componentes que queremos que calcule

---

# PCA en R: con factominer y factoextra

* **Autovalores**: para mostrar los autovalores (**varianza explicada** por cada componente) basta con llamar `pca_fit$eig` (ya nos los da ordenados y con la varianza acumulada). 


```r
pca_fit$eig 
```

```
&gt;        eigenvalue percentage of variance cumulative percentage of variance
&gt; comp 1 2.91849782             72.9624454                          72.96245
&gt; comp 2 0.91403047             22.8507618                          95.81321
&gt; comp 3 0.14675688              3.6689219                          99.48213
&gt; comp 4 0.02071484              0.5178709                         100.00000
```

--

Tambi√©n se obtienen con `get_eig(pca_fit)`


```r
get_eig(pca_fit)
```

```
&gt;       eigenvalue variance.percent cumulative.variance.percent
&gt; Dim.1 2.91849782       72.9624454                    72.96245
&gt; Dim.2 0.91403047       22.8507618                    95.81321
&gt; Dim.3 0.14675688        3.6689219                    99.48213
&gt; Dim.4 0.02071484        0.5178709                   100.00000
```

---

# PCA en R: con factominer y factoextra

* **Autovalores**:  el % de varianza explicada por cada componente (es decir, los autovalores) podemos visualizarlos con `fviz_eig`:

.pull-left[

* `addlabels = TRUE` -&gt; para a√±adir el % de varianza explicada
* `barfill = ...`, `barcolor = ...` -&gt; color de relleno y de contorno (puedes usar cualquier c√≥digo hexadecimal busc√°ndolo en &lt;https://htmlcolorcodes.com/&gt;)
* `xlab = ...`, `ylab = ...`: t√≠tulos de ejes X e Y.
* `main = ...`: t√≠tulo de la gr√°fica


```r
# Varianza explicada (autovalores)
fviz_eig(pca_fit, addlabels = TRUE, barfill = "#5190CE", 
         barcolor = "#E35E51", xlab = "Componentes",
         ylab = "% de varianza explicada",
         main = "Varianza explicada por componentes")
```

]

.pull-right[

&lt;img src="index_files/figure-html/unnamed-chunk-43-1.png" width="100%" /&gt;
]

---

# PCA en R: con factominer y factoextra


* **Autovectores (componentes principales)**: sus coordenadas respecto a las variables originales (**loadings**) podemos cargarlos de `pca_fit$svd$V` (guardados por columnas).


```r
# autovectores (loadings)
pca_fit$svd$V 
```

```
&gt;            [,1]       [,2]       [,3]       [,4]
&gt; [1,]  0.5210659 0.37741762 -0.7195664 -0.2612863
&gt; [2,] -0.2693474 0.92329566  0.2443818  0.1235096
&gt; [3,]  0.5804131 0.02449161  0.1421264  0.8014492
&gt; [4,]  0.5648565 0.06694199  0.6342727 -0.5235971
```

Dichos vectores ser√°n ortonormales (la suma por columnas de sus valores al cuadrado ser√°n 1)


```r
apply(pca_fit$svd$V^2, MARGIN = 2, sum)
```

```
&gt; [1] 1 1 1 1
```

---

# PCA en R: con factominer y factoextra

As√≠ que dar√≠an expresadas los **loadings de las nuevas componentes principales** en funci√≥n de las variables originales (estandarizadas `\(^*\)`)


|  Phi_1| Phi_2|  Phi_3|  Phi_4|
|------:|-----:|------:|------:|
|  0.521| 0.377| -0.720| -0.261|
| -0.269| 0.923|  0.244|  0.124|
|  0.580| 0.024|  0.142|  0.801|
|  0.565| 0.067|  0.634| -0.524|


`$$\boldsymbol{\Phi}_1 = 0.521 * Sepal.Length^* - 0.269 * Sepal.Width^* + 0.580 * Petal.Length^*  + 0.565 * Petal.Width^*$$`

`$$\boldsymbol{\Phi}_2 = 0.377 * Sepal.Length^*  + 0.923 * Sepal.Width^*  + 0.024 * Petal.Length^*  + 0.067 * Petal.Width^*$$`

`$$\boldsymbol{\Phi}_3 = -0.719 * Sepal.Length^*  + 0.244 * Sepal.Width^*  + 0.142 * Petal.Length^*  + 0.634 * Petal.Width^*$$`

`$$\boldsymbol{\Phi}_4 = -0.261 * Sepal.Length^*  + 0.124 * Sepal.Width^*  + 0.801 * Petal.Length^*  - 0.524 * Petal.Width^*$$`


---

# PCA en R: con factominer y factoextra

* **Scores**: las coordenadas en la nueva base de componentes principales de los individuos (ligeramente diferentes a los obtenidos por `prcomp()` por el m√©todo usado para la descomposici√≥n en autovectores y autovalores). Ser√°n los **datos proyectados** en las nuevas direcciones.


```r
pca_fit$ind$coord
```

```
&gt;           Dim.1        Dim.2        Dim.3        Dim.4
&gt; 1   -2.26470281  0.480026597 -0.127706022 -0.024168204
&gt; 2   -2.08096115 -0.674133557 -0.234608854 -0.103006775
&gt; 3   -2.36422905 -0.341908024  0.044201485 -0.028377053
&gt; 4   -2.29938422 -0.597394508  0.091290106  0.065955560
&gt; 5   -2.38984217  0.646835383  0.015738196  0.035922813
&gt; 6   -2.07563095  1.489177523  0.026968294 -0.006608180
&gt; 7   -2.44402884  0.047644198  0.335470401  0.036775557
&gt; 8   -2.23284716  0.223148073 -0.088695498  0.024612096
&gt; 9   -2.33464048 -1.115327675  0.145076864  0.026859221
&gt; 10  -2.18432817 -0.469013561 -0.253765567  0.039899288
&gt; 11  -2.16631010  1.043690653 -0.268681102 -0.016731367
&gt; 12  -2.32613087  0.133078335  0.093759244  0.133483413
&gt; 13  -2.21845090 -0.728676165 -0.230911237 -0.002425038
&gt; 14  -2.63310070 -0.961506729  0.180796084  0.019215534
&gt; 15  -2.19874060  1.860057113 -0.472900998 -0.194731769
&gt; 16  -2.26221453  2.686284485  0.030526609 -0.050533737
&gt; 17  -2.20758770  1.483609363 -0.005344094 -0.188817432
&gt; 18  -2.19034951  0.488838316 -0.044215316 -0.093090438
&gt; 19  -1.89857200  1.405018794 -0.374343275 -0.061095967
&gt; 20  -2.34336905  1.127849382  0.132630467  0.037756420
&gt; 21  -1.91432300  0.408855708 -0.421292594 -0.010921286
&gt; 22  -2.20701284  0.924121427  0.159865277 -0.059597330
&gt; 23  -2.77434470  0.458343668  0.332179098 -0.019648430
&gt; 24  -1.81866953  0.085558526  0.034488596 -0.151140999
&gt; 25  -2.22716331  0.137254455  0.117993536  0.270140352
&gt; 26  -1.95184633 -0.625618588 -0.305640982 -0.043561651
&gt; 27  -2.05115137  0.242163553  0.086364011 -0.067680060
&gt; 28  -2.16857717  0.527149525 -0.206816248 -0.010275393
&gt; 29  -2.13956345  0.313217810 -0.271150240 -0.084259221
&gt; 30  -2.26526149 -0.337731904  0.068435776  0.108279885
&gt; 31  -2.14012214 -0.504540690 -0.075008442  0.048188868
&gt; 32  -1.83159477  0.423695068 -0.270467377 -0.239870381
&gt; 33  -2.61494794  1.793575856  0.047228419  0.229235932
&gt; 34  -2.44617739  2.150727877 -0.082668045  0.048214393
&gt; 35  -2.10997488 -0.460201841 -0.170274861 -0.029022947
&gt; 36  -2.20780890 -0.206107398 -0.225441580 -0.168907873
&gt; 37  -2.04514621  0.661558111 -0.484537410 -0.196358525
&gt; 38  -2.52733191  0.592292774  0.019435812  0.136504550
&gt; 39  -2.42963258 -0.904180040  0.193254662  0.009738423
&gt; 40  -2.16971071  0.268878961 -0.175883821 -0.007047406
&gt; 41  -2.28647514  0.441715388  0.034894909 -0.106983249
&gt; 42  -1.85812246 -2.337415158 -0.204234223 -0.289863919
&gt; 43  -2.55363840 -0.479100690  0.305766453  0.066601453
&gt; 44  -1.96444768  0.472326668  0.309601318 -0.177093014
&gt; 45  -2.13705901  1.142229262  0.248433561  0.151043437
&gt; 46  -2.06974430 -0.711052725 -0.063929826 -0.140269507
&gt; 47  -2.38473317  1.120429702  0.057217858  0.152230967
&gt; 48  -2.39437631 -0.386246873  0.139467905  0.048834762
&gt; 49  -2.22944655  0.997959764 -0.181492780  0.014928135
&gt; 50  -2.20383344  0.009216358 -0.153029490 -0.049371732
&gt; 51   1.10178118  0.862972418 -0.684586163 -0.034833776
&gt; 52   0.73133743  0.594614726 -0.094121716 -0.004903623
&gt; 53   1.24097932  0.616297654 -0.554006835 -0.009423397
&gt; 54   0.40748306 -1.754403989 -0.023101768 -0.065768835
&gt; 55   1.07547470 -0.208421046 -0.398255523 -0.104736873
&gt; 56   0.38868734 -0.593283636  0.124191550  0.240831300
&gt; 57   0.74652974  0.773019312  0.148969403  0.077369785
&gt; 58  -0.48732274 -1.852429087  0.249265266  0.040520205
&gt; 59   0.92790164  0.032226078 -0.596169361  0.029879609
&gt; 60   0.01142619 -1.034018275  0.538899390  0.028461184
&gt; 61  -0.11019628 -2.654072819 -0.046790444 -0.013760731
&gt; 62   0.44069345 -0.063295188  0.205073815 -0.040126082
&gt; 63   0.56210831 -1.764724381 -0.765771394 -0.045731157
&gt; 64   0.71956189 -0.186224606 -0.068658945  0.164807198
&gt; 65  -0.03335470 -0.439003210  0.194932893 -0.109048499
&gt; 66   0.87540719  0.509063957 -0.503511382 -0.104943723
&gt; 67   0.35025167 -0.196311735  0.490873075  0.191509364
&gt; 68   0.15881005 -0.792095742 -0.302037174  0.205297735
&gt; 69   1.22509363 -1.622243803 -0.482304024 -0.225899769
&gt; 70   0.16491790 -1.302609230 -0.172837808  0.051726849
&gt; 71   0.73768265  0.396571562  0.616526306  0.083284123
&gt; 72   0.47628719 -0.417320281 -0.264952227 -0.113568273
&gt; 73   1.23417810 -0.933325729 -0.368412272  0.009944526
&gt; 74   0.63285820 -0.416387721 -0.291896252  0.274220152
&gt; 75   0.70266118 -0.063411820 -0.446027008 -0.043458325
&gt; 76   0.87427365  0.250793393 -0.472578954 -0.101715736
&gt; 77   1.25650912 -0.077256020 -0.727155002 -0.039688518
&gt; 78   1.35840512  0.331311682 -0.260826577 -0.066828064
&gt; 79   0.66480037 -0.225927855  0.085863889  0.036439840
&gt; 80  -0.04025861 -1.058718547 -0.319573330 -0.064788156
&gt; 81   0.13079518 -1.562271834 -0.149983478  0.009402523
&gt; 82   0.02345269 -1.572475594 -0.241552281  0.032772444
&gt; 83   0.24153827 -0.777256383 -0.151211957 -0.023651360
&gt; 84   1.06109461 -0.633843245  0.105311387  0.183968453
&gt; 85   0.22397877 -0.287773512  0.665249720  0.254828368
&gt; 86   0.42913912  0.845582241  0.450634071  0.109675181
&gt; 87   1.04872805  0.522051797 -0.395786384 -0.037209019
&gt; 88   1.04453138 -1.382988719 -0.688295960 -0.136835600
&gt; 89   0.06958832 -0.219503335  0.291579274  0.147144581
&gt; 90   0.28347724 -1.329324639  0.089410023 -0.008905805
&gt; 91   0.27907778 -1.120028524  0.094487601  0.270657196
&gt; 92   0.62456979  0.024923029 -0.020481147  0.147686401
&gt; 93   0.33653037 -0.988404018 -0.199389755 -0.006530562
&gt; 94  -0.36218338 -2.019237873  0.105821048 -0.019570812
&gt; 95   0.28858624 -0.855730320  0.130889685  0.107402349
&gt; 96   0.09136066 -0.181192126  0.128978343  0.229959626
&gt; 97   0.22771687 -0.384920081  0.156213154  0.132605877
&gt; 98   0.57638829 -0.154873597 -0.271650362  0.019860679
&gt; 99  -0.44766702 -1.543792034  0.190400930 -0.199946457
&gt; 100  0.25673059 -0.598851796  0.091879161  0.058622049
&gt; 101  1.84456887  0.870421312  1.005401018  0.049249743
&gt; 102  1.15788161 -0.698869862  0.530160149  0.040520754
&gt; 103  2.20526679  0.562010477 -0.202914170 -0.059184194
&gt; 104  1.44015066 -0.046987588  0.163630107  0.235770073
&gt; 105  1.86781222  0.295044824  0.395628375  0.016298272
&gt; 106  2.75187334  0.800409201 -0.582309103  0.101384486
&gt; 107  0.36701769 -1.561502891  0.986893267  0.133123834
&gt; 108  2.30243944  0.420065580 -0.651706439  0.238041242
&gt; 109  2.00668647 -0.711438654 -0.393990571  0.086510630
&gt; 110  2.25977735  1.921010376  0.397551897 -0.104838918
&gt; 111  1.36417549  0.692756454  0.284612074 -0.107860420
&gt; 112  1.60267867 -0.421700450  0.023186408 -0.058331633
&gt; 113  1.88390070  0.419249651  0.026338410 -0.146414939
&gt; 114  1.26011510 -1.162260421  0.580249290 -0.099157321
&gt; 115  1.46764520 -0.442271587  1.003869574 -0.275658903
&gt; 116  1.59007732  0.676244806  0.638428708 -0.191862996
&gt; 117  1.47143146  0.255621824  0.037431260  0.155330271
&gt; 118  2.42632899  2.556661251 -0.127881459  0.273807183
&gt; 119  3.31069558  0.017780949 -0.703305304 -0.045188606
&gt; 120  1.26376667 -1.706745380 -0.267536893  0.065180800
&gt; 121  2.03771630  0.910467410  0.234799484 -0.167951254
&gt; 122  0.97798073 -0.571764325  0.828127201 -0.027755587
&gt; 123  2.89765149  0.413641060 -0.857421825  0.127336502
&gt; 124  1.33323218 -0.481811219 -0.005428364 -0.139959148
&gt; 125  1.70073390  1.013921867  0.298450613  0.061643734
&gt; 126  1.95432671  1.007777596 -0.419984722  0.218338351
&gt; 127  1.17510363 -0.316394472  0.129937757 -0.125420444
&gt; 128  1.02095055  0.064346029  0.337715967  0.008654401
&gt; 129  1.78834992 -0.187361215  0.270658006 -0.031087648
&gt; 130  1.86364755  0.562290726 -0.715634119  0.208215164
&gt; 131  2.43595373  0.259284433 -0.727816146  0.017923365
&gt; 132  2.30492772  2.626323468 -0.493473808  0.211675709
&gt; 133  1.86270322 -0.178549495  0.354148712 -0.100009882
&gt; 134  1.11414774 -0.292922623 -0.183488392  0.186343697
&gt; 135  1.20247330 -0.811315271 -0.164723757  0.489483470
&gt; 136  2.79877045  0.856803329 -0.542906499 -0.295881050
&gt; 137  1.57625591  1.068581107  0.945853819 -0.035605759
&gt; 138  1.34629210  0.422430611  0.180875478  0.215421288
&gt; 139  0.92482492  0.017223100  0.416826193 -0.005238409
&gt; 140  1.85204505  0.676128174 -0.012672115 -0.195195239
&gt; 141  2.01481043  0.613885637  0.428332842 -0.247538313
&gt; 142  1.90178409  0.689575494  0.130075005 -0.469696647
&gt; 143  1.15788161 -0.698869862  0.530160149  0.040520754
&gt; 144  2.04055823  0.867520601  0.338144000 -0.045187126
&gt; 145  1.99814710  1.049168747  0.632413436 -0.214045204
&gt; 146  1.87050329  0.386966082  0.256273852 -0.389256845
&gt; 147  1.56458048 -0.896686809 -0.026371352 -0.220192100
&gt; 148  1.52117050  0.269069144  0.180178380 -0.119171137
&gt; 149  1.37278779  1.011254419  0.933395241 -0.026128648
&gt; 150  0.96065603 -0.024331668  0.528248807  0.163078032
```

---

# PCA en R: con factominer y factoextra

F√≠jate que todo lo que haga referencia a individuos est√° en `$ind` y a variables en `$var`

Adem√°s las nuevas variables o componentes tienen **media cero y varianza** igual a los autovalores


```r
apply(pca_fit$ind$coord, MARGIN = 2, mean)
```

```
&gt;         Dim.1         Dim.2         Dim.3         Dim.4 
&gt;  3.637307e-16 -5.678763e-16 -1.304469e-15  9.482777e-16
```

```r
apply(pca_fit$ind$coord, MARGIN = 2, function(x) { mean(x^2) - mean(x)^2}) 
```

```
&gt;      Dim.1      Dim.2      Dim.3      Dim.4 
&gt; 2.91849782 0.91403047 0.14675688 0.02071484
```

```r
pca_fit$eig[, 1]
```

```
&gt;     comp 1     comp 2     comp 3     comp 4 
&gt; 2.91849782 0.91403047 0.14675688 0.02071484
```


---

# PCA en R: con factominer y factoextra

* **Contribuci√≥n de individuos**: guardado en `pca_fit$ind$contrib`, cada columna suma el 100%, de forma que nos indica lo que contribuye (en %) cada individuo/registro a cada componente. As√≠, **individuos/registros con contribuciones similares** ser√°n observaciones con caracter√≠sticas parecidas.


```r
apply(pca_fit$ind$contrib, MARGIN = 2, sum)
```

```
&gt; Dim.1 Dim.2 Dim.3 Dim.4 
&gt;   100   100   100   100
```

---

# PCA en R: con factominer y factoextra

* **Correlaciones**: la idea ser√° interpretar las componentes principales analizanod la **correlaci√≥n de cada variable con ellas**, es decir, `\(cor(\Phi_i, X_j)\)`, guardado en `pca_fit$var$cor`. Para cada componente buscaremos **variables muy correlacionadas** con ellas, de forma que variables fuertemente correladas positivamente estar√°n agrupadas en las mismas componente (y viceversa en negativo).


```r
pca_fit$var$cor
```

```
&gt;                   Dim.1      Dim.2       Dim.3       Dim.4
&gt; Sepal.Length  0.8901688 0.36082989 -0.27565767 -0.03760602
&gt; Sepal.Width  -0.4601427 0.88271627  0.09361987  0.01777631
&gt; Petal.Length  0.9915552 0.02341519  0.05444699  0.11534978
&gt; Petal.Width   0.9649790 0.06399985  0.24298265 -0.07535950
```

Es lo mismo que tenemos guardado en `pca_fit$var$coord` ya que es lo que vamos llamar **coordenadas de una variable en una componente**:


```r
pca_fit$var$coord
```

```
&gt;                   Dim.1      Dim.2       Dim.3       Dim.4
&gt; Sepal.Length  0.8901688 0.36082989 -0.27565767 -0.03760602
&gt; Sepal.Width  -0.4601427 0.88271627  0.09361987  0.01777631
&gt; Petal.Length  0.9915552 0.02341519  0.05444699  0.11534978
&gt; Petal.Width   0.9649790 0.06399985  0.24298265 -0.07535950
```

---

# PCA en R: con factominer y factoextra

* **Correlaciones**: f√≠jate que dichas correlaciones se define como
`\(cor(\boldsymbol{\Phi}_i, \boldsymbol{X}_j) = \sqrt{\lambda_i} z_{i,j}\)` con `\(z_{j, i}\)` siendo el loading j-√©simo para la componente i, es decir,  el peso de la variable `\(\boldsymbol{X}_j\)` en la componente `\(\boldsymbol{\Phi}_i\)`


```r
pca_fit$var$cor
```

```
&gt;                   Dim.1      Dim.2       Dim.3       Dim.4
&gt; Sepal.Length  0.8901688 0.36082989 -0.27565767 -0.03760602
&gt; Sepal.Width  -0.4601427 0.88271627  0.09361987  0.01777631
&gt; Petal.Length  0.9915552 0.02341519  0.05444699  0.11534978
&gt; Petal.Width   0.9649790 0.06399985  0.24298265 -0.07535950
```


```r
sqrt(pca_fit$eig[, 1]) * pca_fit$svd$V[, 1]
```

```
&gt;      comp 1      comp 2      comp 3      comp 4 
&gt;  0.89016876 -0.25750946  0.22234964  0.08129782
```

---

# PCA en R: con factominer y factoextra

.pull-left[

* **Correlaciones al cuadrado**: si la correlaci√≥n es la coordenada de cada variable respecto a cada componente, su **cuadrado** representar√° su peso (en magnitud), que tenemos en `pca_fit$var$coord^2` o directamente en `pca_fit$var$cos2` (la suma de cada fila es 100%)


```r
pca_fit$var$coord^2
```

```
&gt;                  Dim.1       Dim.2       Dim.3        Dim.4
&gt; Sepal.Length 0.7924004 0.130198208 0.075987149 0.0014142127
&gt; Sepal.Width  0.2117313 0.779188012 0.008764681 0.0003159971
&gt; Petal.Length 0.9831817 0.000548271 0.002964475 0.0133055723
&gt; Petal.Width  0.9311844 0.004095980 0.059040571 0.0056790544
```


```r
pca_fit$var$cos2
```

```
&gt;                  Dim.1       Dim.2       Dim.3        Dim.4
&gt; Sepal.Length 0.7924004 0.130198208 0.075987149 0.0014142127
&gt; Sepal.Width  0.2117313 0.779188012 0.008764681 0.0003159971
&gt; Petal.Length 0.9831817 0.000548271 0.002964475 0.0133055723
&gt; Petal.Width  0.9311844 0.004095980 0.059040571 0.0056790544
```

Con `fviz_cos2()` podemos visualizar dichos pesos (con `axes = ...` le decimos que queremos hacer la suma de los pesos de las n primeras componentes)


```r
fviz_cos2(pca_fit, choice = "var", axes = 1:2)
```

]

.pull-right[

&lt;img src="index_files/figure-html/unnamed-chunk-57-1.png" width="100%" /&gt;

]

---

# PCA en R: con factominer y factoextra

Con `fviz_pca_var()` podemos **visualizar de forma bidimensional** como se relacionan las variables originales con las dos componentes que mayor cantidad de varianza capturan.

.pull-left[

* La **posici√≥n** de la flecha representa `pca_fit$var$cor` (coordendas de cada variable en las componentes)

* La **magnitud de la flecha (y color)** representa la suma `pca_fit$var$cos2` de las dos primeras componentes (su peso total en esas componentes)

La **magnitud** nos mide la **calidad de las variables** en nuestras componentes (un valor alto indica que la info de dicha variable est√° bien capturada en dichas componentes)


```r
fviz_pca_var(pca_fit, col.var = "cos2",
             gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"), 
             repel = TRUE) +
  theme_minimal() + 
  labs(title = "Coordenadas de las variables",
       color = "Peso")
```

]

.pull-right[

&lt;img src="index_files/figure-html/unnamed-chunk-59-1.png" width="100%" /&gt;
]

---


# PCA en R: con factominer y factoextra

.pull-left[


* **Contribuciones**: por √∫ltimo en `pca_fit$var$contrib` tenemos la **contribuci√≥n (en %) de cada variable** en cada componente en relativo, calculada como el peso de cada una entre la suma de pesos totales


```r
pca_fit$var$contrib
```

```
&gt;                  Dim.1       Dim.2     Dim.3     Dim.4
&gt; Sepal.Length 27.150969 14.24440565 51.777574  6.827052
&gt; Sepal.Width   7.254804 85.24748749  5.972245  1.525463
&gt; Petal.Length 33.687936  0.05998389  2.019990 64.232089
&gt; Petal.Width  31.906291  0.44812296 40.230191 27.415396
```

```r
pca_fit$var$cos2[, 1] / sum(pca_fit$var$cos2[, 1])
```

```
&gt; Sepal.Length  Sepal.Width Petal.Length  Petal.Width 
&gt;   0.27150969   0.07254804   0.33687936   0.31906291
```

Con `fviz_contrib()` medimos la contribuci√≥n de variables (`choice = "var"`) o individuos (`choice = "ind"`), con `top = ...` le digo cuantas quiero calcular, y con `axes = ...` el n√∫mero de componentes a sumar.


```r
fviz_contrib(pca_fit, choice = "var", axes = 1:2, top = 4)
```

]

.pull-right[

&lt;img src="index_files/figure-html/unnamed-chunk-62-1.png" width="100%" /&gt;

]

---

# PCA en R: con factominer y factoextra

.pull-left[

Con `fviz_pca_biplot()` podemos visualizar en las dos dimensiones que m√°s varianza capturan, e incluso nos permite **visualizar cl√∫sters** de observaciones con las elipses definidas por las matrices de covarianza de cada uno de los grupos.


```r
fviz_pca_biplot(pca_fit,
                col.ind = iris$Species,
                palette = "jco",
                addEllipses = TRUE,
                label = "var",
                col.var = "black",
                repel = TRUE,
                legend.title = "Especies")
```

Importante: las coordenadas de los individuos y las de las variables no est√°n definidas en el mismo espacio, as√≠ que de las segunda podremos usar la direcci√≥n (para ver variables con caracter√≠sticas similares).

]

.pull-right[

&lt;img src="index_files/figure-html/unnamed-chunk-64-1.png" width="100%" /&gt;

]

---

# PCA con tidymodels

Por √∫ltimo, ahora que entendemos las componentes principales vamos a calcularlas haciendo uso de `{tidymodels}`, un conjunto de paquetes y herramientas para obtener un **√∫nico flujo de trabajo en el preprocesamiento, modelizaci√≥n y evaluaci√≥n** de modelos.



&lt;div class="figure" style="text-align: center"&gt;
&lt;img src="https://www.tmwr.org/premade/data-science-model.svg" alt="Infograf√≠a extra√≠da de https://www.tmwr.org/dimensionality.html" width="75%" /&gt;
&lt;p class="caption"&gt;Infograf√≠a extra√≠da de https://www.tmwr.org/dimensionality.html&lt;/p&gt;
&lt;/div&gt;


```r
library(tidymodels)
```

---


# Filosof√≠a tidymodels

La idea detr√°s de `{tidymodels}` es **tratar por separado** la depuraci√≥n y preparaci√≥n de los datos, el modelo o paradigma de aprendizaje que se quiere aplicar, la optimizaci√≥n de los par√°metros de dicho modelo, el ajuste, la evaluaci√≥n y la predicci√≥n correspondiente, **creando un flujo de trabajo muy flexible**. La **filosof√≠a es la misma que hay detr√°s de cocinar un plato**:

1. Primero **escribimos la RECETA**, una lista de pasos e instrucciones.
2. Despu√©s **preparamos HERRAMIENTAS y utensilios para cocinar** (nuestro modelo).
3. Con la **RECETA + HERRAMIENTAS** podemos cocinar el plato muchas veces, con **distintos lotes de ingredientes (datos)**.

&amp;nbsp;

&lt;img src="https://www.tmwr.org/premade/recipes-process.svg" width="85%" style="display: block; margin: auto;" /&gt;


---

# PCA con tidymodels

Ahora que hemos visto por encima la idea de `{tidymodels}` vamos a calcular las componentes principales del conjunto `iris` con dicha idea.



```r
iris_full &lt;- iris %&gt;% select(-Species)
library(corrplot)
iris_full %&gt;% cor() %&gt;% 
  corrplot(tl.col = "black", method = "ellipse")
```

&lt;img src="index_files/figure-html/iris-cor-1.png" width="30%" /&gt;

---

# PCA con tidymodels

La receta tendr√° los siguientes pasos:

* Indicar la **variable objetivo** (`Species`)
* Imputamos **datos ausentes**
* **Estandarizar** los datos num√©ricos


```r
receta &lt;- 
  recipe(Species ~ ., data = iris) %&gt;%
  # Imputamos por la media las num√©ricas, por la moda las cuali
  step_impute_mean(all_numeric_predictors()) %&gt;%
  step_impute_mode(all_nominal_predictors()) %&gt;%
  # Estandarizamos
  step_normalize(all_numeric_predictors())
receta
```

```
&gt; Recipe
&gt; 
&gt; Inputs:
&gt; 
&gt;       role #variables
&gt;    outcome          1
&gt;  predictor          4
&gt; 
&gt; Operations:
&gt; 
&gt; Mean imputation for all_numeric_predictors()
&gt; Mode imputation for all_nominal_predictors()
&gt; Centering and scaling for all_numeric_predictors()
```

---

# PCA con tidymodels

Para a√±adir el **an√°lisis de componentes principales** basta con a√±adir `step_pca()` aplicado a todas las num√©ricas


```r
receta &lt;-
  receta %&gt;%
  step_pca(all_numeric_predictors(), num_comp = 4,
           prefix = "PC") 
```
 
Con el argumento `num_comp = 4` ind√≠camos el n√∫mero de componentes y con `prefix` el prefijo con el que llamaremos a las nuevas variables

---

# PCA con tidymodels


```r
data_pc &lt;- bake(receta %&gt;% prep(), new_data = NULL)
data_pc
```

```
&gt; # A tibble: 150 √ó 5
&gt;    Species   PC1     PC2     PC3      PC4
&gt;    &lt;fct&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;
&gt;  1 setosa  -2.26 -0.478   0.127   0.0241 
&gt;  2 setosa  -2.07  0.672   0.234   0.103  
&gt;  3 setosa  -2.36  0.341  -0.0441  0.0283 
&gt;  4 setosa  -2.29  0.595  -0.0910 -0.0657 
&gt;  5 setosa  -2.38 -0.645  -0.0157 -0.0358 
&gt;  6 setosa  -2.07 -1.48   -0.0269  0.00659
&gt;  7 setosa  -2.44 -0.0475 -0.334  -0.0367 
&gt;  8 setosa  -2.23 -0.222   0.0884 -0.0245 
&gt;  9 setosa  -2.33  1.11   -0.145  -0.0268 
&gt; 10 setosa  -2.18  0.467   0.253  -0.0398 
&gt; # ‚Ä¶ with 140 more rows
&gt; # ‚Ñπ Use `print(n = ...)` to see more rows
```

---

# PCA con tidymodels

.pull-left[


```r
ggplot(data_pc,
       aes(x = .panel_x, y = .panel_y,
           color = Species, fill = Species)) +
    geom_point(alpha = 0.4, size = 0.7) +
    ggforce::geom_autodensity(alpha = 0.3) +
    ggforce::facet_matrix(layer.diag = 2) + 
    scale_color_brewer(palette = "Dark2") + 
    scale_fill_brewer(palette = "Dark2")
```

]

.pull-right[

&lt;img src="index_files/figure-html/unnamed-chunk-70-1.png" width="100%" /&gt;

]


---
 
# PCA con tidymodels

.pull-left[


```r
library(learntidymodels)
receta %&gt;% prep() %&gt;% 
  plot_top_loadings(component_number &lt;= 4, n = 4) + 
  scale_fill_brewer(palette = "Paired")
```

]

.pull-right[

&lt;img src="index_files/figure-html/unnamed-chunk-72-1.png" width="100%" /&gt;

]

---

class: inverse center middle

# BLOQUE II. An√°lisis cl√∫ster

&amp;nbsp;


### [¬øQu√© es el an√°lisis cl√∫ster?](#intro-cluster)

### [M√©tricas](#metricas)

### [Algoritmos jer√°rquicos](#jerarquicos)

### [Algoritmos no jer√°rquicos](#no-jerarquicos)

### [Determinaci√≥n del n√∫mero de grupos](#n-grupos)


---

name: intro-cluster
class: center, middle

# ¬øQu√© es el an√°lisis cl√∫ster?

---

# Introducci√≥n: ¬øan√°lisis cl√∫ster?

El **an√°lisis cl√∫ster** forma parte de los **algoritmos de agrupaci√≥n o clasificaci√≥n** con **aprendizaje no supervisado**:

* **Clasificaci√≥n supervisada**: los individuos se clasifican en un grupo a partir de la
informaci√≥n de un conjunto de variables observadas de unos inviduos **cuyo grupo conocemos**, los **datos est√°n etiquetados** (sabemos que es acierto y error). Es el caso por ejemplo del **an√°lisis discriminante**.


&lt;img src="./img/supervised_classification.png" width="80%" style="display: block; margin: auto 0 auto auto;" /&gt;


---

# Introducci√≥n: ¬øan√°lisis cl√∫ster?

El **an√°lisis cl√∫ster** forma parte de los **algoritmos de agrupaci√≥n o clasificaci√≥n** con **aprendizaje no supervisado**:


* **Clasificaci√≥n/agrupaci√≥n no supervisada**: los individuos tambi√©n se clasifican en un grupo a partir de la informaci√≥n de un conjunto de variables observadas PERO en esta ocasi√≥n **no sabemos a qu√© grupo pertenece cada individuo a priori**, no tenemos conocimiento de qu√© es acierto y qu√© es error. Es este el caso del **an√°lisis cl√∫ster**.


&lt;img src="./img/unsupervised_classification.png" width="80%" style="display: block; margin: auto 0 auto auto;" /&gt;

---

# Introducci√≥n: ¬øan√°lisis cl√∫ster?

### **Objetivo**

El an√°lisis cl√∫ster tiene como principal objetivo **encontrar grupos** dentro de los individuos, de forma que los individuos de cada grupo sean **lo m√°s parecidos entre s√≠** (homogeneidad interna) y **lo m√°s diferentes a los individuos de otros grupos** (heterogeneidad entre grupos)


&amp;nbsp;

### **Notaci√≥n**

* `\(n\)` tama√±o muestral (n√∫mero de individuos --&gt; filas).

* `\(\boldsymbol{X}_i = \left(\boldsymbol{X}_{1, i}, \ldots, \boldsymbol{X}_{i, p} \right)\)` conjunto de `\(p\)` variables (--&gt; columnas) medidas para cada individuo `\(i=1,\ldots,n\)`.

* Nuestros datos estar√°n en forma de tabla o matriz `\(\boldsymbol{X}\)` de `\(n\)` filas y `\(p\)` columnas (con `\(p \ll n\)`)
 
---
 
# Introducci√≥n: ¬øan√°lisis cl√∫ster?
 
Los algoritmos los dividiremos en dos grandes grupos:


* **Algoritmos jer√°rquicos**: algoritmos que tienen como objetivo construir una jerarqu√≠a de grupos. Existen principalmente dos estrategias:
  - **Aglomerativa**: cada individuo empieza siendo su propio grupo, mientras se van uniendo de forma secuencial ascendiendo en la jerarqu√≠a, hasta acabar con un solo grupo que incluya todas las observaciones.
  - **Divisiva**: se construye una jerarqu√≠a descendiente, empezando con un √∫nico grupo hasta acabar con un grupo por individuo

Los m√©todos jer√°rquicos suelen ser muy **explicativos** y f√°ciles de visualizar (por ejemplo, con un **dendograma**) pero **muy costoso computacionalmente** (ya que siempre se construye la jerarqu√≠a entera, para decidir luego d√≥nde cortar)

&amp;nbsp;

* **Algoritmos no jer√°rquicos**: dado un n√∫mero `\(K\)` de grupos fijado a priori, se pretenden agrupar los datos de forma que obtengamos finalmente `\(K\)` agrupaciones de los mismos.

---

name: metricas
class: center, middle

# M√©tricas


---

# M√©tricas

En los algoritmos usados ser√° clave el concepto de **m√©trica**. Los datos ser√°n agrupados en base a los conceptos de ¬´lejos¬ª y ¬´cerca¬ª, o mejor dicho, en base a ¬´parecido¬ª y ¬´diferente¬ª

**¬øQu√© es ser parecido? ¬øY diferente?**

&amp;nbsp;

### **M√©trica entre observaciones**

Para medir distancias entre los individuos tenemos principalmente dos alternativas:

* **Distancias geom√©tricas**: distancias que miden la distancia entre dos individuos como si fuesen dos puntos en un espacio geom√©trico. Son distancias determin√≠sticas.

* **Distancias probabil√≠sticas**: distancias que miden la distancia entre individuos teniendo en cuenta la distribuci√≥n de las variables y su dependencia.

---

# M√©tricas determin√≠sticas


* **Distancia eucl√≠dea bidimensional**: `\(d(\boldsymbol{x}_i, \boldsymbol{x}_j) = \sqrt{(x_{i, 1} - x_{j,1})^2 + (x_{i, 2} - x_{j, 2})^2}\)`
   

* **Distancia eucl√≠dea multidimensional**: `\(d(\boldsymbol{x}_i, \boldsymbol{x}_j) = \sqrt{\displaystyle \sum_{k=1}^{p} (x_{i,k} - x_{j,k})^2}\)`

* **Distancia Manhattan**:  `\(d(\boldsymbol{x}_i, \boldsymbol{x}_j) = \displaystyle \sum_{k=1}^{p} \left| x_{i,k} - x_{j,k} \right|\)`

* **Distancia de Minkowski**: `\(d(\boldsymbol{x}_i, \boldsymbol{x}_j) = \left(\displaystyle \sum_{k=1}^{p} \left| x_{i,k} - x_{j,k} \right|^l\right)^{1/l}\)` (si `\(l=1\)` es Manhattan, si `\(l=2\)` es Eucl√≠dea)
   
Cuando usemos este tipo m√©tricas es **muy importante** **reescalar por rango**: transformamos para crear nuevas observaciones `\(\widetilde{x}_{i, k} = \frac{x_{i, k} - min(\boldsymbol{x}_i)}{max(\boldsymbol{x}_i) - min(\boldsymbol{x}_i)}\)` de forma que todas las variables est√©n entre 0 y 1 (y as√≠ todas tengan el mismo peso dentro de las m√©tricas).

---

# M√©tricas determin√≠sticas

&lt;img src="./img/minkowski.png" width="65%" style="display: block; margin: auto;" /&gt;

&lt;img src="./img/minkowski_1.png" width="65%" style="display: block; margin: auto;" /&gt;


---

# M√©tricas probabil√≠sticas

* **Distancia de Mahalanobis** multidimensional **(variables independientes)**:  `\(d(\boldsymbol{x}_i, \boldsymbol{x}_j) = \sqrt{\displaystyle \sum_{k=1}^{p} \left(\frac{x_{i, k} - x_{j,k}}{\sigma_i} \right)^2}\)` que se puede aproximar por `\(d(\boldsymbol{x}_i, \boldsymbol{x}_j) = \sqrt{\displaystyle \sum_{k=1}^{p} \left(\frac{x_{i, k} - x_{j,k}}{S_i} \right)^2}\)`

* **Distancia de Mahalanobis** multidimensional **(variables dependientes)**:  `\(d(\boldsymbol{x}_i, \boldsymbol{x}_j) = \sqrt{\displaystyle \sum_{k=1}^{p} \left(\boldsymbol{x}_i - \boldsymbol{x}_j \right)^{T} \Sigma^{-1} \left(\boldsymbol{x}_i - \boldsymbol{x}_j \right)}\)` que se puede aproximar por `\(d(\boldsymbol{x}_i, \boldsymbol{x}_j) = \sqrt{\displaystyle \sum_{k=1}^{p} \left(\boldsymbol{x}_i - \boldsymbol{x}_j \right)^{T} S^{-1} \left(\boldsymbol{x}_i - \boldsymbol{x}_j \right)}\)`, donde `\(\Sigma\)` es la matriz de covarianzas, con `\(S\)` matriz de (cuasi)covarianzas.
  
Cuando usemos este tipo m√©tricas es **muy importante** **estandarizar** para tener variables de media `\(0\)` y varianza `\(1\)`.

---

# M√©tricas

### **M√©trica entre variables**

Adem√°s de medir la distancia entre individuos podemos plantearnos medir la **distancia entre las propias variables**, normalmente basadas en la correlaci√≥n de Pearson o sus derivados.

* **Correlaci√≥n de Pearson**: definida como `\(d(\boldsymbol{X}_1, \boldsymbol{X}_2) = 1 - \left| r_{1,2} \right|\)` donde `\(r_{1,2}\)` se define como la correlci√≥n entre las variables `\(\boldsymbol{X}_1\)` y `\(\boldsymbol{X}_2\)`

* **Correlaci√≥n de Spearman**: definida como `\(d(\boldsymbol{X}_1, \boldsymbol{X}_2) = 1 - \left| \rho_{1,2} \right| = 1 - \left| \frac{6 \sum D^{2}}{n (n^{2}-1)} \right|\)`, donde `\(D\)` es la diferencia entre los correspondientes estad√≠sticos de orden.


* **Correlaci√≥n de Kendall**: definida como  `\(d(\boldsymbol{X}_1, \boldsymbol{X}_2) = 1 - \left| \tau_{1,2} \right| =  1- \left| \frac{n_c - n_d}{\frac{1}{2} n (n-1)} \right|\)` donde `\(n_c\)` es el n√∫mero de pares concordantes (si el orden de clasificaci√≥n de `\((x_{i},x_{j})\)` y `\((y_{i},y_{j})\)` coinciden, tal que `\(x_{i}&gt;x_{j}\)` y `\(y_{i}&gt;y_{j}\)`, donde `\(i&lt;j\)`) y `\(n_d\)` es el n√∫mero de pares discordantes

---

name: jerarquicos
class: center, middle

# Visualizaci√≥n previa

---

# Visualizaci√≥n previa

Vamos a empezar a trabajar con un conjunto familiar, el conjunto de `iris` que ya conocemos haciendo una selecci√≥n previa de 35 observaciones


```r
iris_sample &lt;- iris %&gt;% slice_sample(n = 35)
iris_sample 
```

```
&gt;    Sepal.Length Sepal.Width Petal.Length Petal.Width    Species
&gt; 1           7.1         3.0          5.9         2.1  virginica
&gt; 2           6.5         3.0          5.5         1.8  virginica
&gt; 3           6.6         3.0          4.4         1.4 versicolor
&gt; 4           5.8         2.7          5.1         1.9  virginica
&gt; 5           5.4         3.4          1.5         0.4     setosa
&gt; 6           6.7         2.5          5.8         1.8  virginica
&gt; 7           4.6         3.4          1.4         0.3     setosa
&gt; 8           6.3         3.4          5.6         2.4  virginica
&gt; 9           6.1         2.8          4.7         1.2 versicolor
&gt; 10          4.6         3.6          1.0         0.2     setosa
&gt; 11          6.9         3.1          4.9         1.5 versicolor
&gt; 12          6.1         2.6          5.6         1.4  virginica
&gt; 13          6.9         3.1          5.4         2.1  virginica
&gt; 14          5.5         4.2          1.4         0.2     setosa
&gt; 15          6.2         2.2          4.5         1.5 versicolor
&gt; 16          6.1         2.8          4.0         1.3 versicolor
&gt; 17          6.5         3.0          5.2         2.0  virginica
&gt; 18          6.0         2.2          4.0         1.0 versicolor
&gt; 19          5.7         2.9          4.2         1.3 versicolor
&gt; 20          5.5         2.6          4.4         1.2 versicolor
&gt; 21          4.9         3.6          1.4         0.1     setosa
&gt; 22          5.4         3.4          1.7         0.2     setosa
&gt; 23          6.0         2.9          4.5         1.5 versicolor
&gt; 24          5.0         3.5          1.3         0.3     setosa
&gt; 25          5.1         3.8          1.6         0.2     setosa
&gt; 26          5.5         2.5          4.0         1.3 versicolor
&gt; 27          5.2         2.7          3.9         1.4 versicolor
&gt; 28          5.6         2.7          4.2         1.3 versicolor
&gt; 29          5.7         4.4          1.5         0.4     setosa
&gt; 30          6.4         3.2          5.3         2.3  virginica
&gt; 31          5.0         2.3          3.3         1.0 versicolor
&gt; 32          5.4         3.9          1.7         0.4     setosa
&gt; 33          4.9         2.5          4.5         1.7  virginica
&gt; 34          6.0         3.0          4.8         1.8  virginica
&gt; 35          6.0         3.4          4.5         1.6 versicolor
```

---

# Visualizaci√≥n previa


Una primera visualizaci√≥n la podemos realizar con `heatmaply()` del paquete hom√≥nimo que nos permite realizar agrupaciones tanto de variables (dendograma superior) como de individuos (dendograma en el lateral).


```r
library(heatmaply)
heatmaply(iris_sample,
          seriate = "mean",
          row_dend_left = TRUE,
          plot_method = "plotly")
```

Es importante recordar que el **clustering** es un m√©todo de **clasificaci√≥n NO SUPERVISADA**: no sabemos a priori el grupo correcto de cada individuo.

---

# Visualizaci√≥n previa

<div id="htmlwidget-55269eefd07531f02103" style="width:100%;height:840px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-55269eefd07531f02103">{"x":{"data":[{"type":"scatter","mode":"markers","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"type":"scatter","mode":"markers","marker":{"color":"rgba(255,127,14,1)","line":{"color":"rgba(255,127,14,1)"}},"error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"line":{"color":"rgba(255,127,14,1)"},"xaxis":"x2","yaxis":"y","frame":null},{"x":[3.125,2.25,null,2.25,2.25,null,2.25,1.5,null,1.5,1.5,null,1.5,1,null,1,1,null,1.5,2,null,2,2,null,2.25,3,null,3,3,null,3.125,4,null,4,4],"y":[27.3161124613295,27.3161124613295,null,27.3161124613295,16.2763632301568,null,16.2763632301568,16.2763632301568,null,16.2763632301568,12.4185345351213,null,12.4185345351213,12.4185345351213,null,12.4185345351213,0,null,12.4185345351213,12.4185345351213,null,12.4185345351213,0,null,16.2763632301568,16.2763632301568,null,16.2763632301568,0,null,27.3161124613295,27.3161124613295,null,27.3161124613295,0],"type":"scatter","mode":"lines","showlegend":false,"hoverinfo":["y","y",null,"y","y",null,"y","y",null,"y","y",null,"y","y",null,"y","y",null,"y","y",null,"y","y",null,"y","y",null,"y","y",null,"y","y",null,"y","y"],"name":"1","marker":{"color":"rgba(0,0,0,1)","line":{"color":"rgba(0,0,0,1)"}},"textfont":{"color":"rgba(0,0,0,1)"},"error_y":{"color":"rgba(0,0,0,1)"},"error_x":{"color":"rgba(0,0,0,1)"},"line":{"color":"rgba(0,0,0,1)"},"xaxis":"x3","yaxis":"y","frame":null},{"x":[5.85064099052403,5.85064099052403,null,5.85064099052403,1.49331845230681,null,1.49331845230681,1.49331845230681,null,1.49331845230681,0.519615242270664,null,0.519615242270664,0.519615242270664,null,0.519615242270664,0,null,0.519615242270664,0.519615242270664,null,0.519615242270664,0.424264068711929,null,0.424264068711929,0.424264068711929,null,0.424264068711929,0,null,0.424264068711929,0.424264068711929,null,0.424264068711929,0.264575131106459,null,0.264575131106459,0.264575131106459,null,0.264575131106459,0,null,0.264575131106459,0.264575131106459,null,0.264575131106459,0,null,1.49331845230681,1.49331845230681,null,1.49331845230681,1.0816653826392,null,1.0816653826392,1.0816653826392,null,1.0816653826392,0.360555127546399,null,0.360555127546399,0.360555127546399,null,0.360555127546399,0,null,0.360555127546399,0.360555127546399,null,0.360555127546399,0,null,1.0816653826392,1.0816653826392,null,1.0816653826392,0.547722557505166,null,0.547722557505166,0.547722557505166,null,0.547722557505166,0.282842712474619,null,0.282842712474619,0.282842712474619,null,0.282842712474619,0,null,0.282842712474619,0.282842712474619,null,0.282842712474619,0,null,0.547722557505166,0.547722557505166,null,0.547722557505166,0.387298334620742,null,0.387298334620742,0.387298334620742,null,0.387298334620742,0,null,0.387298334620742,0.387298334620742,null,0.387298334620742,0,null,5.85064099052403,5.85064099052403,null,5.85064099052403,3.58747822293042,null,3.58747822293042,3.58747822293042,null,3.58747822293042,1.42828568570857,null,1.42828568570857,1.42828568570857,null,1.42828568570857,0.678232998312526,null,0.678232998312526,0.678232998312526,null,0.678232998312526,0,null,0.678232998312526,0.678232998312526,null,0.678232998312526,0,null,1.42828568570857,1.42828568570857,null,1.42828568570857,1.40712472794703,null,1.40712472794703,1.40712472794703,null,1.40712472794703,0,null,1.40712472794703,1.40712472794703,null,1.40712472794703,1.02469507659596,null,1.02469507659596,1.02469507659596,null,1.02469507659596,0,null,1.02469507659596,1.02469507659596,null,1.02469507659596,0.62449979983984,null,0.62449979983984,0.62449979983984,null,0.62449979983984,0.387298334620742,null,0.387298334620742,0.387298334620742,null,0.387298334620742,0,null,0.387298334620742,0.387298334620742,null,0.387298334620742,0,null,0.62449979983984,0.62449979983984,null,0.62449979983984,0.424264068711929,null,0.424264068711929,0.424264068711929,null,0.424264068711929,0,null,0.424264068711929,0.424264068711929,null,0.424264068711929,0.223606797749979,null,0.223606797749979,0.223606797749979,null,0.223606797749979,0,null,0.223606797749979,0.223606797749979,null,0.223606797749979,0,null,3.58747822293042,3.58747822293042,null,3.58747822293042,1.94164878389476,null,1.94164878389476,1.94164878389476,null,1.94164878389476,1.17046999107196,null,1.17046999107196,1.17046999107196,null,1.17046999107196,0.714142842854285,null,0.714142842854285,0.714142842854285,null,0.714142842854285,0,null,0.714142842854285,0.714142842854285,null,0.714142842854285,0,null,1.17046999107196,1.17046999107196,null,1.17046999107196,0.761577310586391,null,0.761577310586391,0.761577310586391,null,0.761577310586391,0.387298334620742,null,0.387298334620742,0.387298334620742,null,0.387298334620742,0,null,0.387298334620742,0.387298334620742,null,0.387298334620742,0,null,0.761577310586391,0.761577310586391,null,0.761577310586391,0.519615242270663,null,0.519615242270663,0.519615242270663,null,0.519615242270663,0,null,0.519615242270663,0.519615242270663,null,0.519615242270663,0.360555127546399,null,0.360555127546399,0.360555127546399,null,0.360555127546399,0,null,0.360555127546399,0.360555127546399,null,0.360555127546399,0,null,1.94164878389476,1.94164878389476,null,1.94164878389476,1.37840487520902,null,1.37840487520902,1.37840487520902,null,1.37840487520902,1.03440804327886,null,1.03440804327886,1.03440804327886,null,1.03440804327886,0,null,1.03440804327886,1.03440804327886,null,1.03440804327886,0.6,null,0.6,0.6,null,0.6,0,null,0.6,0.6,null,0.6,0,null,1.37840487520902,1.37840487520902,null,1.37840487520902,1.17898261225516,null,1.17898261225516,1.17898261225516,null,1.17898261225516,0,null,1.17898261225516,1.17898261225516,null,1.17898261225516,0.964365076099295,null,0.964365076099295,0.964365076099295,null,0.964365076099295,0.479583152331272,null,0.479583152331272,0.479583152331272,null,0.479583152331272,0,null,0.479583152331272,0.479583152331272,null,0.479583152331272,0,null,0.964365076099295,0.964365076099295,null,0.964365076099295,0.728010988928052,null,0.728010988928052,0.728010988928052,null,0.728010988928052,0,null,0.728010988928052,0.728010988928052,null,0.728010988928052,0.387298334620742,null,0.387298334620742,0.387298334620742,null,0.387298334620742,0,null,0.387298334620742,0.387298334620742,null,0.387298334620742,0],"y":[11.875,4.4375,null,4.4375,4.4375,null,4.4375,1.875,null,1.875,1.875,null,1.875,1,null,1,1,null,1.875,2.75,null,2.75,2.75,null,2.75,2,null,2,2,null,2.75,3.5,null,3.5,3.5,null,3.5,3,null,3,3,null,3.5,4,null,4,4,null,4.4375,7,null,7,7,null,7,5.5,null,5.5,5.5,null,5.5,5,null,5,5,null,5.5,6,null,6,6,null,7,8.5,null,8.5,8.5,null,8.5,7.5,null,7.5,7.5,null,7.5,7,null,7,7,null,7.5,8,null,8,8,null,8.5,9.5,null,9.5,9.5,null,9.5,9,null,9,9,null,9.5,10,null,10,10,null,11.875,19.3125,null,19.3125,19.3125,null,19.3125,12.828125,null,12.828125,12.828125,null,12.828125,11.5,null,11.5,11.5,null,11.5,11,null,11,11,null,11.5,12,null,12,12,null,12.828125,14.15625,null,14.15625,14.15625,null,14.15625,13,null,13,13,null,14.15625,15.3125,null,15.3125,15.3125,null,15.3125,14,null,14,14,null,15.3125,16.625,null,16.625,16.625,null,16.625,15.5,null,15.5,15.5,null,15.5,15,null,15,15,null,15.5,16,null,16,16,null,16.625,17.75,null,17.75,17.75,null,17.75,17,null,17,17,null,17.75,18.5,null,18.5,18.5,null,18.5,18,null,18,18,null,18.5,19,null,19,19,null,19.3125,25.796875,null,25.796875,25.796875,null,25.796875,22.0625,null,22.0625,22.0625,null,22.0625,20.5,null,20.5,20.5,null,20.5,20,null,20,20,null,20.5,21,null,21,21,null,22.0625,23.625,null,23.625,23.625,null,23.625,22.5,null,22.5,22.5,null,22.5,22,null,22,22,null,22.5,23,null,23,23,null,23.625,24.75,null,24.75,24.75,null,24.75,24,null,24,24,null,24.75,25.5,null,25.5,25.5,null,25.5,25,null,25,25,null,25.5,26,null,26,26,null,25.796875,29.53125,null,29.53125,29.53125,null,29.53125,27.75,null,27.75,27.75,null,27.75,27,null,27,27,null,27.75,28.5,null,28.5,28.5,null,28.5,28,null,28,28,null,28.5,29,null,29,29,null,29.53125,31.3125,null,31.3125,31.3125,null,31.3125,30,null,30,30,null,31.3125,32.625,null,32.625,32.625,null,32.625,31.5,null,31.5,31.5,null,31.5,31,null,31,31,null,31.5,32,null,32,32,null,32.625,33.75,null,33.75,33.75,null,33.75,33,null,33,33,null,33.75,34.5,null,34.5,34.5,null,34.5,34,null,34,34,null,34.5,35,null,35,35],"type":"scatter","mode":"lines","showlegend":false,"hoverinfo":["x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x"],"name":"1","marker":{"color":"rgba(0,0,0,1)","line":{"color":"rgba(0,0,0,1)"}},"textfont":{"color":"rgba(0,0,0,1)"},"error_y":{"color":"rgba(0,0,0,1)"},"error_x":{"color":"rgba(0,0,0,1)"},"line":{"color":"rgba(0,0,0,1)"},"xaxis":"x","yaxis":"y2","frame":null},{"colorbar":{"title":"Species","ticklen":2,"tickmode":"array","tickvals":[1.33333333333333,2,2.66666666666667],"ticktext":["setosa","versicolor","virginica"],"len":0.3,"lenmode":"fraction","y":1,"yanchor":"top"},"colorscale":[[0,"#A6CEE3"],[0.00334448160535117,"#A6CEE3"],[0.00668896321070234,"#A6CEE3"],[0.0100334448160535,"#A6CEE3"],[0.0133779264214047,"#A6CEE3"],[0.0167224080267559,"#A6CEE3"],[0.020066889632107,"#A6CEE3"],[0.0234113712374582,"#A6CEE3"],[0.0267558528428094,"#A6CEE3"],[0.0301003344481605,"#A6CEE3"],[0.0334448160535117,"#A6CEE3"],[0.0367892976588629,"#A6CEE3"],[0.040133779264214,"#A6CEE3"],[0.0434782608695652,"#A6CEE3"],[0.0468227424749164,"#A6CEE3"],[0.0501672240802676,"#A6CEE3"],[0.0535117056856187,"#A6CEE3"],[0.0568561872909699,"#A6CEE3"],[0.0602006688963211,"#A6CEE3"],[0.0635451505016722,"#A6CEE3"],[0.0668896321070234,"#A6CEE3"],[0.0702341137123746,"#A6CEE3"],[0.0735785953177257,"#A6CEE3"],[0.0769230769230769,"#A6CEE3"],[0.0802675585284281,"#A6CEE3"],[0.0836120401337793,"#A6CEE3"],[0.0869565217391304,"#A6CEE3"],[0.0903010033444816,"#A6CEE3"],[0.0936454849498328,"#A6CEE3"],[0.096989966555184,"#A6CEE3"],[0.100334448160535,"#A6CEE3"],[0.103678929765886,"#A6CEE3"],[0.107023411371237,"#A6CEE3"],[0.110367892976589,"#A6CEE3"],[0.11371237458194,"#A6CEE3"],[0.117056856187291,"#A6CEE3"],[0.120401337792642,"#A6CEE3"],[0.123745819397993,"#A6CEE3"],[0.127090301003344,"#A6CEE3"],[0.130434782608696,"#A6CEE3"],[0.133779264214047,"#A6CEE3"],[0.137123745819398,"#A6CEE3"],[0.140468227424749,"#A6CEE3"],[0.1438127090301,"#A6CEE3"],[0.147157190635451,"#A6CEE3"],[0.150501672240803,"#A6CEE3"],[0.153846153846154,"#A6CEE3"],[0.157190635451505,"#A6CEE3"],[0.160535117056856,"#A6CEE3"],[0.163879598662207,"#A6CEE3"],[0.167224080267559,"#A6CEE3"],[0.17056856187291,"#A6CEE3"],[0.173913043478261,"#A6CEE3"],[0.177257525083612,"#A6CEE3"],[0.180602006688963,"#A6CEE3"],[0.183946488294314,"#A6CEE3"],[0.187290969899666,"#A6CEE3"],[0.190635451505017,"#A6CEE3"],[0.193979933110368,"#A6CEE3"],[0.197324414715719,"#A6CEE3"],[0.20066889632107,"#A6CEE3"],[0.204013377926421,"#A6CEE3"],[0.207357859531773,"#A6CEE3"],[0.210702341137124,"#A6CEE3"],[0.214046822742475,"#A6CEE3"],[0.217391304347826,"#A6CEE3"],[0.220735785953177,"#A6CEE3"],[0.224080267558528,"#A6CEE3"],[0.22742474916388,"#A6CEE3"],[0.230769230769231,"#A6CEE3"],[0.234113712374582,"#A6CEE3"],[0.237458193979933,"#A6CEE3"],[0.240802675585284,"#A6CEE3"],[0.244147157190635,"#A6CEE3"],[0.247491638795987,"#A6CEE3"],[0.250836120401338,"#A6CEE3"],[0.254180602006689,"#A6CEE3"],[0.25752508361204,"#A6CEE3"],[0.260869565217391,"#A6CEE3"],[0.264214046822742,"#A6CEE3"],[0.267558528428094,"#A6CEE3"],[0.270903010033445,"#A6CEE3"],[0.274247491638796,"#A6CEE3"],[0.277591973244147,"#A6CEE3"],[0.280936454849498,"#A6CEE3"],[0.284280936454849,"#A6CEE3"],[0.287625418060201,"#A6CEE3"],[0.290969899665552,"#A6CEE3"],[0.294314381270903,"#A6CEE3"],[0.297658862876254,"#A6CEE3"],[0.301003344481605,"#A6CEE3"],[0.304347826086957,"#A6CEE3"],[0.307692307692308,"#A6CEE3"],[0.311036789297659,"#A6CEE3"],[0.31438127090301,"#A6CEE3"],[0.317725752508361,"#A6CEE3"],[0.321070234113712,"#A6CEE3"],[0.324414715719064,"#A6CEE3"],[0.327759197324415,"#A6CEE3"],[0.331103678929766,"#A6CEE3"],[0.334448160535117,"#1F78B4"],[0.337792642140468,"#1F78B4"],[0.341137123745819,"#1F78B4"],[0.344481605351171,"#1F78B4"],[0.347826086956522,"#1F78B4"],[0.351170568561873,"#1F78B4"],[0.354515050167224,"#1F78B4"],[0.357859531772575,"#1F78B4"],[0.361204013377926,"#1F78B4"],[0.364548494983278,"#1F78B4"],[0.367892976588629,"#1F78B4"],[0.37123745819398,"#1F78B4"],[0.374581939799331,"#1F78B4"],[0.377926421404682,"#1F78B4"],[0.381270903010033,"#1F78B4"],[0.384615384615385,"#1F78B4"],[0.387959866220736,"#1F78B4"],[0.391304347826087,"#1F78B4"],[0.394648829431438,"#1F78B4"],[0.397993311036789,"#1F78B4"],[0.40133779264214,"#1F78B4"],[0.404682274247492,"#1F78B4"],[0.408026755852843,"#1F78B4"],[0.411371237458194,"#1F78B4"],[0.414715719063545,"#1F78B4"],[0.418060200668896,"#1F78B4"],[0.421404682274247,"#1F78B4"],[0.424749163879599,"#1F78B4"],[0.42809364548495,"#1F78B4"],[0.431438127090301,"#1F78B4"],[0.434782608695652,"#1F78B4"],[0.438127090301003,"#1F78B4"],[0.441471571906354,"#1F78B4"],[0.444816053511706,"#1F78B4"],[0.448160535117057,"#1F78B4"],[0.451505016722408,"#1F78B4"],[0.454849498327759,"#1F78B4"],[0.45819397993311,"#1F78B4"],[0.461538461538462,"#1F78B4"],[0.464882943143813,"#1F78B4"],[0.468227424749164,"#1F78B4"],[0.471571906354515,"#1F78B4"],[0.474916387959866,"#1F78B4"],[0.478260869565217,"#1F78B4"],[0.481605351170569,"#1F78B4"],[0.48494983277592,"#1F78B4"],[0.488294314381271,"#1F78B4"],[0.491638795986622,"#1F78B4"],[0.494983277591973,"#1F78B4"],[0.498327759197324,"#1F78B4"],[0.501672240802676,"#1F78B4"],[0.505016722408027,"#1F78B4"],[0.508361204013378,"#1F78B4"],[0.511705685618729,"#1F78B4"],[0.51505016722408,"#1F78B4"],[0.518394648829431,"#1F78B4"],[0.521739130434783,"#1F78B4"],[0.525083612040134,"#1F78B4"],[0.528428093645485,"#1F78B4"],[0.531772575250836,"#1F78B4"],[0.535117056856187,"#1F78B4"],[0.538461538461538,"#1F78B4"],[0.54180602006689,"#1F78B4"],[0.545150501672241,"#1F78B4"],[0.548494983277592,"#1F78B4"],[0.551839464882943,"#1F78B4"],[0.555183946488294,"#1F78B4"],[0.558528428093645,"#1F78B4"],[0.561872909698997,"#1F78B4"],[0.565217391304348,"#1F78B4"],[0.568561872909699,"#1F78B4"],[0.57190635451505,"#1F78B4"],[0.575250836120401,"#1F78B4"],[0.578595317725752,"#1F78B4"],[0.581939799331104,"#1F78B4"],[0.585284280936455,"#1F78B4"],[0.588628762541806,"#1F78B4"],[0.591973244147157,"#1F78B4"],[0.595317725752508,"#1F78B4"],[0.598662207357859,"#1F78B4"],[0.602006688963211,"#1F78B4"],[0.605351170568562,"#1F78B4"],[0.608695652173913,"#1F78B4"],[0.612040133779264,"#1F78B4"],[0.615384615384615,"#1F78B4"],[0.618729096989967,"#1F78B4"],[0.622073578595318,"#1F78B4"],[0.625418060200669,"#1F78B4"],[0.62876254180602,"#1F78B4"],[0.632107023411371,"#1F78B4"],[0.635451505016722,"#1F78B4"],[0.638795986622074,"#1F78B4"],[0.642140468227425,"#1F78B4"],[0.645484949832776,"#1F78B4"],[0.648829431438127,"#1F78B4"],[0.652173913043478,"#1F78B4"],[0.655518394648829,"#1F78B4"],[0.658862876254181,"#1F78B4"],[0.662207357859532,"#1F78B4"],[0.665551839464883,"#1F78B4"],[0.668896321070234,"#B2DF8A"],[0.672240802675585,"#B2DF8A"],[0.675585284280936,"#B2DF8A"],[0.678929765886288,"#B2DF8A"],[0.682274247491639,"#B2DF8A"],[0.68561872909699,"#B2DF8A"],[0.688963210702341,"#B2DF8A"],[0.692307692307692,"#B2DF8A"],[0.695652173913043,"#B2DF8A"],[0.698996655518395,"#B2DF8A"],[0.702341137123746,"#B2DF8A"],[0.705685618729097,"#B2DF8A"],[0.709030100334448,"#B2DF8A"],[0.712374581939799,"#B2DF8A"],[0.71571906354515,"#B2DF8A"],[0.719063545150502,"#B2DF8A"],[0.722408026755853,"#B2DF8A"],[0.725752508361204,"#B2DF8A"],[0.729096989966555,"#B2DF8A"],[0.732441471571906,"#B2DF8A"],[0.735785953177257,"#B2DF8A"],[0.739130434782609,"#B2DF8A"],[0.74247491638796,"#B2DF8A"],[0.745819397993311,"#B2DF8A"],[0.749163879598662,"#B2DF8A"],[0.752508361204013,"#B2DF8A"],[0.755852842809364,"#B2DF8A"],[0.759197324414716,"#B2DF8A"],[0.762541806020067,"#B2DF8A"],[0.765886287625418,"#B2DF8A"],[0.769230769230769,"#B2DF8A"],[0.77257525083612,"#B2DF8A"],[0.775919732441472,"#B2DF8A"],[0.779264214046823,"#B2DF8A"],[0.782608695652174,"#B2DF8A"],[0.785953177257525,"#B2DF8A"],[0.789297658862876,"#B2DF8A"],[0.792642140468227,"#B2DF8A"],[0.795986622073579,"#B2DF8A"],[0.79933110367893,"#B2DF8A"],[0.802675585284281,"#B2DF8A"],[0.806020066889632,"#B2DF8A"],[0.809364548494983,"#B2DF8A"],[0.812709030100334,"#B2DF8A"],[0.816053511705686,"#B2DF8A"],[0.819397993311037,"#B2DF8A"],[0.822742474916388,"#B2DF8A"],[0.826086956521739,"#B2DF8A"],[0.82943143812709,"#B2DF8A"],[0.832775919732441,"#B2DF8A"],[0.836120401337793,"#B2DF8A"],[0.839464882943144,"#B2DF8A"],[0.842809364548495,"#B2DF8A"],[0.846153846153846,"#B2DF8A"],[0.849498327759197,"#B2DF8A"],[0.852842809364548,"#B2DF8A"],[0.8561872909699,"#B2DF8A"],[0.859531772575251,"#B2DF8A"],[0.862876254180602,"#B2DF8A"],[0.866220735785953,"#B2DF8A"],[0.869565217391304,"#B2DF8A"],[0.872909698996655,"#B2DF8A"],[0.876254180602007,"#B2DF8A"],[0.879598662207358,"#B2DF8A"],[0.882943143812709,"#B2DF8A"],[0.88628762541806,"#B2DF8A"],[0.889632107023411,"#B2DF8A"],[0.892976588628763,"#B2DF8A"],[0.896321070234114,"#B2DF8A"],[0.899665551839465,"#B2DF8A"],[0.903010033444816,"#B2DF8A"],[0.906354515050167,"#B2DF8A"],[0.909698996655518,"#B2DF8A"],[0.91304347826087,"#B2DF8A"],[0.916387959866221,"#B2DF8A"],[0.919732441471572,"#B2DF8A"],[0.923076923076923,"#B2DF8A"],[0.926421404682274,"#B2DF8A"],[0.929765886287625,"#B2DF8A"],[0.933110367892977,"#B2DF8A"],[0.936454849498328,"#B2DF8A"],[0.939799331103679,"#B2DF8A"],[0.94314381270903,"#B2DF8A"],[0.946488294314381,"#B2DF8A"],[0.949832775919732,"#B2DF8A"],[0.953177257525084,"#B2DF8A"],[0.956521739130435,"#B2DF8A"],[0.959866220735786,"#B2DF8A"],[0.963210702341137,"#B2DF8A"],[0.966555183946488,"#B2DF8A"],[0.969899665551839,"#B2DF8A"],[0.973244147157191,"#B2DF8A"],[0.976588628762542,"#B2DF8A"],[0.979933110367893,"#B2DF8A"],[0.983277591973244,"#B2DF8A"],[0.986622073578595,"#B2DF8A"],[0.989966555183946,"#B2DF8A"],[0.993311036789298,"#B2DF8A"],[0.996655518394649,"#B2DF8A"],[1,"#B2DF8A"]],"showscale":true,"z":[[1],[1],[1],[1],[1],[1],[1],[1],[1],[1],[2],[2],[2],[3],[2],[2],[2],[2],[2],[3],[3],[3],[3],[3],[3],[3],[2],[2],[2],[3],[3],[3],[2],[2],[2]],"x":[1],"y":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35],"text":[["value: setosa<br>variable: Species<br>row: 10"],["value: setosa<br>variable: Species<br>row: 7"],["value: setosa<br>variable: Species<br>row: 21"],["value: setosa<br>variable: Species<br>row: 24"],["value: setosa<br>variable: Species<br>row: 14"],["value: setosa<br>variable: Species<br>row: 29"],["value: setosa<br>variable: Species<br>row: 5"],["value: setosa<br>variable: Species<br>row: 22"],["value: setosa<br>variable: Species<br>row: 25"],["value: setosa<br>variable: Species<br>row: 32"],["value: versicolor<br>variable: Species<br>row: 18"],["value: versicolor<br>variable: Species<br>row: 16"],["value: versicolor<br>variable: Species<br>row: 31"],["value: virginica<br>variable: Species<br>row: 33"],["value: versicolor<br>variable: Species<br>row: 27"],["value: versicolor<br>variable: Species<br>row: 26"],["value: versicolor<br>variable: Species<br>row: 20"],["value: versicolor<br>variable: Species<br>row: 28"],["value: versicolor<br>variable: Species<br>row: 19"],["value: virginica<br>variable: Species<br>row: 6"],["value: virginica<br>variable: Species<br>row: 1"],["value: virginica<br>variable: Species<br>row: 30"],["value: virginica<br>variable: Species<br>row: 8"],["value: virginica<br>variable: Species<br>row: 13"],["value: virginica<br>variable: Species<br>row: 17"],["value: virginica<br>variable: Species<br>row: 2"],["value: versicolor<br>variable: Species<br>row: 35"],["value: versicolor<br>variable: Species<br>row: 3"],["value: versicolor<br>variable: Species<br>row: 11"],["value: virginica<br>variable: Species<br>row: 12"],["value: virginica<br>variable: Species<br>row: 4"],["value: virginica<br>variable: Species<br>row: 34"],["value: versicolor<br>variable: Species<br>row: 15"],["value: versicolor<br>variable: Species<br>row: 9"],["value: versicolor<br>variable: Species<br>row: 23"]],"hoverinfo":"text","showlegend":false,"type":"heatmap","xaxis":"x2","yaxis":"y2","frame":null},{"colorbar":{"ticklen":2,"lenmode":"fraction","xanchor":"right","x":-0.1,"y":0,"yanchor":"bottom","len":0.3,"thickness":30},"colorscale":[["0","rgba(68,1,84,1)"],["0.0416666666666667","rgba(71,17,100,1)"],["0.0833333333333333","rgba(72,31,112,1)"],["0.125","rgba(71,45,123,1)"],["0.166666666666667","rgba(68,58,131,1)"],["0.208333333333333","rgba(64,70,136,1)"],["0.25","rgba(59,82,139,1)"],["0.291666666666667","rgba(54,93,141,1)"],["0.333333333333333","rgba(49,104,142,1)"],["0.375","rgba(44,114,142,1)"],["0.416666666666667","rgba(40,124,142,1)"],["0.458333333333333","rgba(36,134,142,1)"],["0.5","rgba(33,144,141,1)"],["0.541666666666667","rgba(31,154,138,1)"],["0.583333333333333","rgba(32,164,134,1)"],["0.625","rgba(39,173,129,1)"],["0.666666666666667","rgba(53,183,121,1)"],["0.708333333333333","rgba(71,193,110,1)"],["0.75","rgba(93,200,99,1)"],["0.791666666666667","rgba(117,208,84,1)"],["0.833333333333333","rgba(143,214,68,1)"],["0.875","rgba(170,220,50,1)"],["0.916666666666667","rgba(199,224,32,1)"],["0.958333333333333","rgba(227,228,24,1)"],["1","rgba(253,231,37,1)"]],"showscale":true,"z":[[3.6,1,0.2,4.6],[3.4,1.4,0.3,4.6],[3.6,1.4,0.1,4.9],[3.5,1.3,0.3,5],[4.2,1.4,0.2,5.5],[4.4,1.5,0.4,5.7],[3.4,1.5,0.4,5.4],[3.4,1.7,0.2,5.4],[3.8,1.6,0.2,5.1],[3.9,1.7,0.4,5.4],[2.2,4,1,6],[2.8,4,1.3,6.1],[2.3,3.3,1,5],[2.5,4.5,1.7,4.9],[2.7,3.9,1.4,5.2],[2.5,4,1.3,5.5],[2.6,4.4,1.2,5.5],[2.7,4.2,1.3,5.6],[2.9,4.2,1.3,5.7],[2.5,5.8,1.8,6.7],[3,5.9,2.1,7.1],[3.2,5.3,2.3,6.4],[3.4,5.6,2.4,6.3],[3.1,5.4,2.1,6.9],[3,5.2,2,6.5],[3,5.5,1.8,6.5],[3.4,4.5,1.6,6],[3,4.4,1.4,6.6],[3.1,4.9,1.5,6.9],[2.6,5.6,1.4,6.1],[2.7,5.1,1.9,5.8],[3,4.8,1.8,6],[2.2,4.5,1.5,6.2],[2.8,4.7,1.2,6.1],[2.9,4.5,1.5,6]],"x":[1,2,3,4],"y":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35],"text":[["row: 10<br>column: Sepal.Width<br>value: 3.6","row: 10<br>column: Petal.Length<br>value: 1","row: 10<br>column: Petal.Width<br>value: 0.2","row: 10<br>column: Sepal.Length<br>value: 4.6"],["row: 7<br>column: Sepal.Width<br>value: 3.4","row: 7<br>column: Petal.Length<br>value: 1.4","row: 7<br>column: Petal.Width<br>value: 0.3","row: 7<br>column: Sepal.Length<br>value: 4.6"],["row: 21<br>column: Sepal.Width<br>value: 3.6","row: 21<br>column: Petal.Length<br>value: 1.4","row: 21<br>column: Petal.Width<br>value: 0.1","row: 21<br>column: Sepal.Length<br>value: 4.9"],["row: 24<br>column: Sepal.Width<br>value: 3.5","row: 24<br>column: Petal.Length<br>value: 1.3","row: 24<br>column: Petal.Width<br>value: 0.3","row: 24<br>column: Sepal.Length<br>value: 5"],["row: 14<br>column: Sepal.Width<br>value: 4.2","row: 14<br>column: Petal.Length<br>value: 1.4","row: 14<br>column: Petal.Width<br>value: 0.2","row: 14<br>column: Sepal.Length<br>value: 5.5"],["row: 29<br>column: Sepal.Width<br>value: 4.4","row: 29<br>column: Petal.Length<br>value: 1.5","row: 29<br>column: Petal.Width<br>value: 0.4","row: 29<br>column: Sepal.Length<br>value: 5.7"],["row: 5<br>column: Sepal.Width<br>value: 3.4","row: 5<br>column: Petal.Length<br>value: 1.5","row: 5<br>column: Petal.Width<br>value: 0.4","row: 5<br>column: Sepal.Length<br>value: 5.4"],["row: 22<br>column: Sepal.Width<br>value: 3.4","row: 22<br>column: Petal.Length<br>value: 1.7","row: 22<br>column: Petal.Width<br>value: 0.2","row: 22<br>column: Sepal.Length<br>value: 5.4"],["row: 25<br>column: Sepal.Width<br>value: 3.8","row: 25<br>column: Petal.Length<br>value: 1.6","row: 25<br>column: Petal.Width<br>value: 0.2","row: 25<br>column: Sepal.Length<br>value: 5.1"],["row: 32<br>column: Sepal.Width<br>value: 3.9","row: 32<br>column: Petal.Length<br>value: 1.7","row: 32<br>column: Petal.Width<br>value: 0.4","row: 32<br>column: Sepal.Length<br>value: 5.4"],["row: 18<br>column: Sepal.Width<br>value: 2.2","row: 18<br>column: Petal.Length<br>value: 4","row: 18<br>column: Petal.Width<br>value: 1","row: 18<br>column: Sepal.Length<br>value: 6"],["row: 16<br>column: Sepal.Width<br>value: 2.8","row: 16<br>column: Petal.Length<br>value: 4","row: 16<br>column: Petal.Width<br>value: 1.3","row: 16<br>column: Sepal.Length<br>value: 6.1"],["row: 31<br>column: Sepal.Width<br>value: 2.3","row: 31<br>column: Petal.Length<br>value: 3.3","row: 31<br>column: Petal.Width<br>value: 1","row: 31<br>column: Sepal.Length<br>value: 5"],["row: 33<br>column: Sepal.Width<br>value: 2.5","row: 33<br>column: Petal.Length<br>value: 4.5","row: 33<br>column: Petal.Width<br>value: 1.7","row: 33<br>column: Sepal.Length<br>value: 4.9"],["row: 27<br>column: Sepal.Width<br>value: 2.7","row: 27<br>column: Petal.Length<br>value: 3.9","row: 27<br>column: Petal.Width<br>value: 1.4","row: 27<br>column: Sepal.Length<br>value: 5.2"],["row: 26<br>column: Sepal.Width<br>value: 2.5","row: 26<br>column: Petal.Length<br>value: 4","row: 26<br>column: Petal.Width<br>value: 1.3","row: 26<br>column: Sepal.Length<br>value: 5.5"],["row: 20<br>column: Sepal.Width<br>value: 2.6","row: 20<br>column: Petal.Length<br>value: 4.4","row: 20<br>column: Petal.Width<br>value: 1.2","row: 20<br>column: Sepal.Length<br>value: 5.5"],["row: 28<br>column: Sepal.Width<br>value: 2.7","row: 28<br>column: Petal.Length<br>value: 4.2","row: 28<br>column: Petal.Width<br>value: 1.3","row: 28<br>column: Sepal.Length<br>value: 5.6"],["row: 19<br>column: Sepal.Width<br>value: 2.9","row: 19<br>column: Petal.Length<br>value: 4.2","row: 19<br>column: Petal.Width<br>value: 1.3","row: 19<br>column: Sepal.Length<br>value: 5.7"],["row: 6<br>column: Sepal.Width<br>value: 2.5","row: 6<br>column: Petal.Length<br>value: 5.8","row: 6<br>column: Petal.Width<br>value: 1.8","row: 6<br>column: Sepal.Length<br>value: 6.7"],["row: 1<br>column: Sepal.Width<br>value: 3","row: 1<br>column: Petal.Length<br>value: 5.9","row: 1<br>column: Petal.Width<br>value: 2.1","row: 1<br>column: Sepal.Length<br>value: 7.1"],["row: 30<br>column: Sepal.Width<br>value: 3.2","row: 30<br>column: Petal.Length<br>value: 5.3","row: 30<br>column: Petal.Width<br>value: 2.3","row: 30<br>column: Sepal.Length<br>value: 6.4"],["row: 8<br>column: Sepal.Width<br>value: 3.4","row: 8<br>column: Petal.Length<br>value: 5.6","row: 8<br>column: Petal.Width<br>value: 2.4","row: 8<br>column: Sepal.Length<br>value: 6.3"],["row: 13<br>column: Sepal.Width<br>value: 3.1","row: 13<br>column: Petal.Length<br>value: 5.4","row: 13<br>column: Petal.Width<br>value: 2.1","row: 13<br>column: Sepal.Length<br>value: 6.9"],["row: 17<br>column: Sepal.Width<br>value: 3","row: 17<br>column: Petal.Length<br>value: 5.2","row: 17<br>column: Petal.Width<br>value: 2","row: 17<br>column: Sepal.Length<br>value: 6.5"],["row: 2<br>column: Sepal.Width<br>value: 3","row: 2<br>column: Petal.Length<br>value: 5.5","row: 2<br>column: Petal.Width<br>value: 1.8","row: 2<br>column: Sepal.Length<br>value: 6.5"],["row: 35<br>column: Sepal.Width<br>value: 3.4","row: 35<br>column: Petal.Length<br>value: 4.5","row: 35<br>column: Petal.Width<br>value: 1.6","row: 35<br>column: Sepal.Length<br>value: 6"],["row: 3<br>column: Sepal.Width<br>value: 3","row: 3<br>column: Petal.Length<br>value: 4.4","row: 3<br>column: Petal.Width<br>value: 1.4","row: 3<br>column: Sepal.Length<br>value: 6.6"],["row: 11<br>column: Sepal.Width<br>value: 3.1","row: 11<br>column: Petal.Length<br>value: 4.9","row: 11<br>column: Petal.Width<br>value: 1.5","row: 11<br>column: Sepal.Length<br>value: 6.9"],["row: 12<br>column: Sepal.Width<br>value: 2.6","row: 12<br>column: Petal.Length<br>value: 5.6","row: 12<br>column: Petal.Width<br>value: 1.4","row: 12<br>column: Sepal.Length<br>value: 6.1"],["row: 4<br>column: Sepal.Width<br>value: 2.7","row: 4<br>column: Petal.Length<br>value: 5.1","row: 4<br>column: Petal.Width<br>value: 1.9","row: 4<br>column: Sepal.Length<br>value: 5.8"],["row: 34<br>column: Sepal.Width<br>value: 3","row: 34<br>column: Petal.Length<br>value: 4.8","row: 34<br>column: Petal.Width<br>value: 1.8","row: 34<br>column: Sepal.Length<br>value: 6"],["row: 15<br>column: Sepal.Width<br>value: 2.2","row: 15<br>column: Petal.Length<br>value: 4.5","row: 15<br>column: Petal.Width<br>value: 1.5","row: 15<br>column: Sepal.Length<br>value: 6.2"],["row: 9<br>column: Sepal.Width<br>value: 2.8","row: 9<br>column: Petal.Length<br>value: 4.7","row: 9<br>column: Petal.Width<br>value: 1.2","row: 9<br>column: Sepal.Length<br>value: 6.1"],["row: 23<br>column: Sepal.Width<br>value: 2.9","row: 23<br>column: Petal.Length<br>value: 4.5","row: 23<br>column: Petal.Width<br>value: 1.5","row: 23<br>column: Sepal.Length<br>value: 6"]],"showlegend":false,"hoverinfo":"text","type":"heatmap","xaxis":"x3","yaxis":"y2","frame":null}],"layout":{"xaxis":{"domain":[0,0.2],"automargin":true,"showticklabels":false,"showgrid":false,"zeroline":false,"anchor":"y2","title":"","range":[0,5.85064099052403],"linecolor":"#ffffff","autorange":"reversed"},"xaxis2":{"domain":[0.2,0.3],"automargin":true,"showticklabels":true,"showgrid":false,"zeroline":false,"anchor":"y2","tickfont":{"size":10},"tickangle":45,"tickvals":[1],"ticktext":["Species"],"linecolor":"#ffffff","range":[0.5,1.5],"title":[]},"xaxis3":{"domain":[0.3,1],"automargin":true,"title":"","range":[0.5,4.5],"linecolor":"#ffffff","showgrid":false,"anchor":"y2","tickfont":{"size":10},"tickangle":45,"tickvals":[1,2,3,4],"ticktext":["Sepal.Width","Petal.Length","Petal.Width","Sepal.Length"],"showticklabels":true},"yaxis2":{"domain":[0,0.8],"automargin":true,"tickfont":{"size":10},"tickangle":0,"tickvals":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35],"ticktext":["10","7","21","24","14","29","5","22","25","32","18","16","31","33","27","26","20","28","19","6","1","30","8","13","17","2","35","3","11","12","4","34","15","9","23"],"linecolor":"#ffffff","range":[0,35.5],"showticklabels":true,"title":"","anchor":"x3","showgrid":false,"side":"right"},"yaxis":{"domain":[0.8,1],"automargin":true,"title":"","range":[0,27.3161124613295],"linecolor":"#ffffff","showgrid":false,"anchor":"x","showticklabels":false,"zeroline":false},"annotations":[],"shapes":[],"images":[],"margin":{"b":72,"l":null,"t":0,"r":12},"hovermode":"closest","showlegend":true,"scene":{"zaxis":{"title":[]}},"title":"","legend":{"y":1,"yanchor":"top"}},"attrs":{"8c86718347b":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20]},"8c852c49537":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":{},"y":{},"xend":{},"yend":{},"type":"scatter","mode":"lines","color":{},"showlegend":false,"colors":"1","hoverinfo":"y","inherit":true},"8c868207854":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":{},"y":{},"xend":{},"yend":{},"type":"scatter","mode":"lines","color":{},"showlegend":false,"colors":"1","hoverinfo":"x","inherit":true},"8c845bea45a":{"z":[[1],[1],[1],[1],[1],[1],[1],[1],[1],[1],[2],[2],[2],[3],[2],[2],[2],[2],[2],[3],[3],[3],[3],[3],[3],[3],[2],[2],[2],[3],[3],[3],[2],[2],[2]],"x":1,"y":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35],"text":[["value: setosa<br>variable: Species<br>row: 10"],["value: setosa<br>variable: Species<br>row: 7"],["value: setosa<br>variable: Species<br>row: 21"],["value: setosa<br>variable: Species<br>row: 24"],["value: setosa<br>variable: Species<br>row: 14"],["value: setosa<br>variable: Species<br>row: 29"],["value: setosa<br>variable: Species<br>row: 5"],["value: setosa<br>variable: Species<br>row: 22"],["value: setosa<br>variable: Species<br>row: 25"],["value: setosa<br>variable: Species<br>row: 32"],["value: versicolor<br>variable: Species<br>row: 18"],["value: versicolor<br>variable: Species<br>row: 16"],["value: versicolor<br>variable: Species<br>row: 31"],["value: virginica<br>variable: Species<br>row: 33"],["value: versicolor<br>variable: Species<br>row: 27"],["value: versicolor<br>variable: Species<br>row: 26"],["value: versicolor<br>variable: Species<br>row: 20"],["value: versicolor<br>variable: Species<br>row: 28"],["value: versicolor<br>variable: Species<br>row: 19"],["value: virginica<br>variable: Species<br>row: 6"],["value: virginica<br>variable: Species<br>row: 1"],["value: virginica<br>variable: Species<br>row: 30"],["value: virginica<br>variable: Species<br>row: 8"],["value: virginica<br>variable: Species<br>row: 13"],["value: virginica<br>variable: Species<br>row: 17"],["value: virginica<br>variable: Species<br>row: 2"],["value: versicolor<br>variable: Species<br>row: 35"],["value: versicolor<br>variable: Species<br>row: 3"],["value: versicolor<br>variable: Species<br>row: 11"],["value: virginica<br>variable: Species<br>row: 12"],["value: virginica<br>variable: Species<br>row: 4"],["value: virginica<br>variable: Species<br>row: 34"],["value: versicolor<br>variable: Species<br>row: 15"],["value: versicolor<br>variable: Species<br>row: 9"],["value: versicolor<br>variable: Species<br>row: 23"]],"hoverinfo":"text","showlegend":false,"colorscale":[[0,"#A6CEE3"],[0.00334448160535117,"#A6CEE3"],[0.00668896321070234,"#A6CEE3"],[0.0100334448160535,"#A6CEE3"],[0.0133779264214047,"#A6CEE3"],[0.0167224080267559,"#A6CEE3"],[0.020066889632107,"#A6CEE3"],[0.0234113712374582,"#A6CEE3"],[0.0267558528428094,"#A6CEE3"],[0.0301003344481605,"#A6CEE3"],[0.0334448160535117,"#A6CEE3"],[0.0367892976588629,"#A6CEE3"],[0.040133779264214,"#A6CEE3"],[0.0434782608695652,"#A6CEE3"],[0.0468227424749164,"#A6CEE3"],[0.0501672240802676,"#A6CEE3"],[0.0535117056856187,"#A6CEE3"],[0.0568561872909699,"#A6CEE3"],[0.0602006688963211,"#A6CEE3"],[0.0635451505016722,"#A6CEE3"],[0.0668896321070234,"#A6CEE3"],[0.0702341137123746,"#A6CEE3"],[0.0735785953177257,"#A6CEE3"],[0.0769230769230769,"#A6CEE3"],[0.0802675585284281,"#A6CEE3"],[0.0836120401337793,"#A6CEE3"],[0.0869565217391304,"#A6CEE3"],[0.0903010033444816,"#A6CEE3"],[0.0936454849498328,"#A6CEE3"],[0.096989966555184,"#A6CEE3"],[0.100334448160535,"#A6CEE3"],[0.103678929765886,"#A6CEE3"],[0.107023411371237,"#A6CEE3"],[0.110367892976589,"#A6CEE3"],[0.11371237458194,"#A6CEE3"],[0.117056856187291,"#A6CEE3"],[0.120401337792642,"#A6CEE3"],[0.123745819397993,"#A6CEE3"],[0.127090301003344,"#A6CEE3"],[0.130434782608696,"#A6CEE3"],[0.133779264214047,"#A6CEE3"],[0.137123745819398,"#A6CEE3"],[0.140468227424749,"#A6CEE3"],[0.1438127090301,"#A6CEE3"],[0.147157190635451,"#A6CEE3"],[0.150501672240803,"#A6CEE3"],[0.153846153846154,"#A6CEE3"],[0.157190635451505,"#A6CEE3"],[0.160535117056856,"#A6CEE3"],[0.163879598662207,"#A6CEE3"],[0.167224080267559,"#A6CEE3"],[0.17056856187291,"#A6CEE3"],[0.173913043478261,"#A6CEE3"],[0.177257525083612,"#A6CEE3"],[0.180602006688963,"#A6CEE3"],[0.183946488294314,"#A6CEE3"],[0.187290969899666,"#A6CEE3"],[0.190635451505017,"#A6CEE3"],[0.193979933110368,"#A6CEE3"],[0.197324414715719,"#A6CEE3"],[0.20066889632107,"#A6CEE3"],[0.204013377926421,"#A6CEE3"],[0.207357859531773,"#A6CEE3"],[0.210702341137124,"#A6CEE3"],[0.214046822742475,"#A6CEE3"],[0.217391304347826,"#A6CEE3"],[0.220735785953177,"#A6CEE3"],[0.224080267558528,"#A6CEE3"],[0.22742474916388,"#A6CEE3"],[0.230769230769231,"#A6CEE3"],[0.234113712374582,"#A6CEE3"],[0.237458193979933,"#A6CEE3"],[0.240802675585284,"#A6CEE3"],[0.244147157190635,"#A6CEE3"],[0.247491638795987,"#A6CEE3"],[0.250836120401338,"#A6CEE3"],[0.254180602006689,"#A6CEE3"],[0.25752508361204,"#A6CEE3"],[0.260869565217391,"#A6CEE3"],[0.264214046822742,"#A6CEE3"],[0.267558528428094,"#A6CEE3"],[0.270903010033445,"#A6CEE3"],[0.274247491638796,"#A6CEE3"],[0.277591973244147,"#A6CEE3"],[0.280936454849498,"#A6CEE3"],[0.284280936454849,"#A6CEE3"],[0.287625418060201,"#A6CEE3"],[0.290969899665552,"#A6CEE3"],[0.294314381270903,"#A6CEE3"],[0.297658862876254,"#A6CEE3"],[0.301003344481605,"#A6CEE3"],[0.304347826086957,"#A6CEE3"],[0.307692307692308,"#A6CEE3"],[0.311036789297659,"#A6CEE3"],[0.31438127090301,"#A6CEE3"],[0.317725752508361,"#A6CEE3"],[0.321070234113712,"#A6CEE3"],[0.324414715719064,"#A6CEE3"],[0.327759197324415,"#A6CEE3"],[0.331103678929766,"#A6CEE3"],[0.334448160535117,"#1F78B4"],[0.337792642140468,"#1F78B4"],[0.341137123745819,"#1F78B4"],[0.344481605351171,"#1F78B4"],[0.347826086956522,"#1F78B4"],[0.351170568561873,"#1F78B4"],[0.354515050167224,"#1F78B4"],[0.357859531772575,"#1F78B4"],[0.361204013377926,"#1F78B4"],[0.364548494983278,"#1F78B4"],[0.367892976588629,"#1F78B4"],[0.37123745819398,"#1F78B4"],[0.374581939799331,"#1F78B4"],[0.377926421404682,"#1F78B4"],[0.381270903010033,"#1F78B4"],[0.384615384615385,"#1F78B4"],[0.387959866220736,"#1F78B4"],[0.391304347826087,"#1F78B4"],[0.394648829431438,"#1F78B4"],[0.397993311036789,"#1F78B4"],[0.40133779264214,"#1F78B4"],[0.404682274247492,"#1F78B4"],[0.408026755852843,"#1F78B4"],[0.411371237458194,"#1F78B4"],[0.414715719063545,"#1F78B4"],[0.418060200668896,"#1F78B4"],[0.421404682274247,"#1F78B4"],[0.424749163879599,"#1F78B4"],[0.42809364548495,"#1F78B4"],[0.431438127090301,"#1F78B4"],[0.434782608695652,"#1F78B4"],[0.438127090301003,"#1F78B4"],[0.441471571906354,"#1F78B4"],[0.444816053511706,"#1F78B4"],[0.448160535117057,"#1F78B4"],[0.451505016722408,"#1F78B4"],[0.454849498327759,"#1F78B4"],[0.45819397993311,"#1F78B4"],[0.461538461538462,"#1F78B4"],[0.464882943143813,"#1F78B4"],[0.468227424749164,"#1F78B4"],[0.471571906354515,"#1F78B4"],[0.474916387959866,"#1F78B4"],[0.478260869565217,"#1F78B4"],[0.481605351170569,"#1F78B4"],[0.48494983277592,"#1F78B4"],[0.488294314381271,"#1F78B4"],[0.491638795986622,"#1F78B4"],[0.494983277591973,"#1F78B4"],[0.498327759197324,"#1F78B4"],[0.501672240802676,"#1F78B4"],[0.505016722408027,"#1F78B4"],[0.508361204013378,"#1F78B4"],[0.511705685618729,"#1F78B4"],[0.51505016722408,"#1F78B4"],[0.518394648829431,"#1F78B4"],[0.521739130434783,"#1F78B4"],[0.525083612040134,"#1F78B4"],[0.528428093645485,"#1F78B4"],[0.531772575250836,"#1F78B4"],[0.535117056856187,"#1F78B4"],[0.538461538461538,"#1F78B4"],[0.54180602006689,"#1F78B4"],[0.545150501672241,"#1F78B4"],[0.548494983277592,"#1F78B4"],[0.551839464882943,"#1F78B4"],[0.555183946488294,"#1F78B4"],[0.558528428093645,"#1F78B4"],[0.561872909698997,"#1F78B4"],[0.565217391304348,"#1F78B4"],[0.568561872909699,"#1F78B4"],[0.57190635451505,"#1F78B4"],[0.575250836120401,"#1F78B4"],[0.578595317725752,"#1F78B4"],[0.581939799331104,"#1F78B4"],[0.585284280936455,"#1F78B4"],[0.588628762541806,"#1F78B4"],[0.591973244147157,"#1F78B4"],[0.595317725752508,"#1F78B4"],[0.598662207357859,"#1F78B4"],[0.602006688963211,"#1F78B4"],[0.605351170568562,"#1F78B4"],[0.608695652173913,"#1F78B4"],[0.612040133779264,"#1F78B4"],[0.615384615384615,"#1F78B4"],[0.618729096989967,"#1F78B4"],[0.622073578595318,"#1F78B4"],[0.625418060200669,"#1F78B4"],[0.62876254180602,"#1F78B4"],[0.632107023411371,"#1F78B4"],[0.635451505016722,"#1F78B4"],[0.638795986622074,"#1F78B4"],[0.642140468227425,"#1F78B4"],[0.645484949832776,"#1F78B4"],[0.648829431438127,"#1F78B4"],[0.652173913043478,"#1F78B4"],[0.655518394648829,"#1F78B4"],[0.658862876254181,"#1F78B4"],[0.662207357859532,"#1F78B4"],[0.665551839464883,"#1F78B4"],[0.668896321070234,"#B2DF8A"],[0.672240802675585,"#B2DF8A"],[0.675585284280936,"#B2DF8A"],[0.678929765886288,"#B2DF8A"],[0.682274247491639,"#B2DF8A"],[0.68561872909699,"#B2DF8A"],[0.688963210702341,"#B2DF8A"],[0.692307692307692,"#B2DF8A"],[0.695652173913043,"#B2DF8A"],[0.698996655518395,"#B2DF8A"],[0.702341137123746,"#B2DF8A"],[0.705685618729097,"#B2DF8A"],[0.709030100334448,"#B2DF8A"],[0.712374581939799,"#B2DF8A"],[0.71571906354515,"#B2DF8A"],[0.719063545150502,"#B2DF8A"],[0.722408026755853,"#B2DF8A"],[0.725752508361204,"#B2DF8A"],[0.729096989966555,"#B2DF8A"],[0.732441471571906,"#B2DF8A"],[0.735785953177257,"#B2DF8A"],[0.739130434782609,"#B2DF8A"],[0.74247491638796,"#B2DF8A"],[0.745819397993311,"#B2DF8A"],[0.749163879598662,"#B2DF8A"],[0.752508361204013,"#B2DF8A"],[0.755852842809364,"#B2DF8A"],[0.759197324414716,"#B2DF8A"],[0.762541806020067,"#B2DF8A"],[0.765886287625418,"#B2DF8A"],[0.769230769230769,"#B2DF8A"],[0.77257525083612,"#B2DF8A"],[0.775919732441472,"#B2DF8A"],[0.779264214046823,"#B2DF8A"],[0.782608695652174,"#B2DF8A"],[0.785953177257525,"#B2DF8A"],[0.789297658862876,"#B2DF8A"],[0.792642140468227,"#B2DF8A"],[0.795986622073579,"#B2DF8A"],[0.79933110367893,"#B2DF8A"],[0.802675585284281,"#B2DF8A"],[0.806020066889632,"#B2DF8A"],[0.809364548494983,"#B2DF8A"],[0.812709030100334,"#B2DF8A"],[0.816053511705686,"#B2DF8A"],[0.819397993311037,"#B2DF8A"],[0.822742474916388,"#B2DF8A"],[0.826086956521739,"#B2DF8A"],[0.82943143812709,"#B2DF8A"],[0.832775919732441,"#B2DF8A"],[0.836120401337793,"#B2DF8A"],[0.839464882943144,"#B2DF8A"],[0.842809364548495,"#B2DF8A"],[0.846153846153846,"#B2DF8A"],[0.849498327759197,"#B2DF8A"],[0.852842809364548,"#B2DF8A"],[0.8561872909699,"#B2DF8A"],[0.859531772575251,"#B2DF8A"],[0.862876254180602,"#B2DF8A"],[0.866220735785953,"#B2DF8A"],[0.869565217391304,"#B2DF8A"],[0.872909698996655,"#B2DF8A"],[0.876254180602007,"#B2DF8A"],[0.879598662207358,"#B2DF8A"],[0.882943143812709,"#B2DF8A"],[0.88628762541806,"#B2DF8A"],[0.889632107023411,"#B2DF8A"],[0.892976588628763,"#B2DF8A"],[0.896321070234114,"#B2DF8A"],[0.899665551839465,"#B2DF8A"],[0.903010033444816,"#B2DF8A"],[0.906354515050167,"#B2DF8A"],[0.909698996655518,"#B2DF8A"],[0.91304347826087,"#B2DF8A"],[0.916387959866221,"#B2DF8A"],[0.919732441471572,"#B2DF8A"],[0.923076923076923,"#B2DF8A"],[0.926421404682274,"#B2DF8A"],[0.929765886287625,"#B2DF8A"],[0.933110367892977,"#B2DF8A"],[0.936454849498328,"#B2DF8A"],[0.939799331103679,"#B2DF8A"],[0.94314381270903,"#B2DF8A"],[0.946488294314381,"#B2DF8A"],[0.949832775919732,"#B2DF8A"],[0.953177257525084,"#B2DF8A"],[0.956521739130435,"#B2DF8A"],[0.959866220735786,"#B2DF8A"],[0.963210702341137,"#B2DF8A"],[0.966555183946488,"#B2DF8A"],[0.969899665551839,"#B2DF8A"],[0.973244147157191,"#B2DF8A"],[0.976588628762542,"#B2DF8A"],[0.979933110367893,"#B2DF8A"],[0.983277591973244,"#B2DF8A"],[0.986622073578595,"#B2DF8A"],[0.989966555183946,"#B2DF8A"],[0.993311036789298,"#B2DF8A"],[0.996655518394649,"#B2DF8A"],[1,"#B2DF8A"]],"colorbar":{"title":"Species","tickmode":"array","tickvals":[1.33333333333333,2,2.66666666666667],"ticktext":["setosa","versicolor","virginica"],"len":0.3},"colors":["#A6CEE3","#1F78B4","#B2DF8A"],"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"heatmap"},"8c82bbc0834":{"z":[[3.6,1,0.2,4.6],[3.4,1.4,0.3,4.6],[3.6,1.4,0.1,4.9],[3.5,1.3,0.3,5],[4.2,1.4,0.2,5.5],[4.4,1.5,0.4,5.7],[3.4,1.5,0.4,5.4],[3.4,1.7,0.2,5.4],[3.8,1.6,0.2,5.1],[3.9,1.7,0.4,5.4],[2.2,4,1,6],[2.8,4,1.3,6.1],[2.3,3.3,1,5],[2.5,4.5,1.7,4.9],[2.7,3.9,1.4,5.2],[2.5,4,1.3,5.5],[2.6,4.4,1.2,5.5],[2.7,4.2,1.3,5.6],[2.9,4.2,1.3,5.7],[2.5,5.8,1.8,6.7],[3,5.9,2.1,7.1],[3.2,5.3,2.3,6.4],[3.4,5.6,2.4,6.3],[3.1,5.4,2.1,6.9],[3,5.2,2,6.5],[3,5.5,1.8,6.5],[3.4,4.5,1.6,6],[3,4.4,1.4,6.6],[3.1,4.9,1.5,6.9],[2.6,5.6,1.4,6.1],[2.7,5.1,1.9,5.8],[3,4.8,1.8,6],[2.2,4.5,1.5,6.2],[2.8,4.7,1.2,6.1],[2.9,4.5,1.5,6]],"x":[1,2,3,4],"y":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35],"text":[["row: 10<br>column: Sepal.Width<br>value: 3.6","row: 10<br>column: Petal.Length<br>value: 1","row: 10<br>column: Petal.Width<br>value: 0.2","row: 10<br>column: Sepal.Length<br>value: 4.6"],["row: 7<br>column: Sepal.Width<br>value: 3.4","row: 7<br>column: Petal.Length<br>value: 1.4","row: 7<br>column: Petal.Width<br>value: 0.3","row: 7<br>column: Sepal.Length<br>value: 4.6"],["row: 21<br>column: Sepal.Width<br>value: 3.6","row: 21<br>column: Petal.Length<br>value: 1.4","row: 21<br>column: Petal.Width<br>value: 0.1","row: 21<br>column: Sepal.Length<br>value: 4.9"],["row: 24<br>column: Sepal.Width<br>value: 3.5","row: 24<br>column: Petal.Length<br>value: 1.3","row: 24<br>column: Petal.Width<br>value: 0.3","row: 24<br>column: Sepal.Length<br>value: 5"],["row: 14<br>column: Sepal.Width<br>value: 4.2","row: 14<br>column: Petal.Length<br>value: 1.4","row: 14<br>column: Petal.Width<br>value: 0.2","row: 14<br>column: Sepal.Length<br>value: 5.5"],["row: 29<br>column: Sepal.Width<br>value: 4.4","row: 29<br>column: Petal.Length<br>value: 1.5","row: 29<br>column: Petal.Width<br>value: 0.4","row: 29<br>column: Sepal.Length<br>value: 5.7"],["row: 5<br>column: Sepal.Width<br>value: 3.4","row: 5<br>column: Petal.Length<br>value: 1.5","row: 5<br>column: Petal.Width<br>value: 0.4","row: 5<br>column: Sepal.Length<br>value: 5.4"],["row: 22<br>column: Sepal.Width<br>value: 3.4","row: 22<br>column: Petal.Length<br>value: 1.7","row: 22<br>column: Petal.Width<br>value: 0.2","row: 22<br>column: Sepal.Length<br>value: 5.4"],["row: 25<br>column: Sepal.Width<br>value: 3.8","row: 25<br>column: Petal.Length<br>value: 1.6","row: 25<br>column: Petal.Width<br>value: 0.2","row: 25<br>column: Sepal.Length<br>value: 5.1"],["row: 32<br>column: Sepal.Width<br>value: 3.9","row: 32<br>column: Petal.Length<br>value: 1.7","row: 32<br>column: Petal.Width<br>value: 0.4","row: 32<br>column: Sepal.Length<br>value: 5.4"],["row: 18<br>column: Sepal.Width<br>value: 2.2","row: 18<br>column: Petal.Length<br>value: 4","row: 18<br>column: Petal.Width<br>value: 1","row: 18<br>column: Sepal.Length<br>value: 6"],["row: 16<br>column: Sepal.Width<br>value: 2.8","row: 16<br>column: Petal.Length<br>value: 4","row: 16<br>column: Petal.Width<br>value: 1.3","row: 16<br>column: Sepal.Length<br>value: 6.1"],["row: 31<br>column: Sepal.Width<br>value: 2.3","row: 31<br>column: Petal.Length<br>value: 3.3","row: 31<br>column: Petal.Width<br>value: 1","row: 31<br>column: Sepal.Length<br>value: 5"],["row: 33<br>column: Sepal.Width<br>value: 2.5","row: 33<br>column: Petal.Length<br>value: 4.5","row: 33<br>column: Petal.Width<br>value: 1.7","row: 33<br>column: Sepal.Length<br>value: 4.9"],["row: 27<br>column: Sepal.Width<br>value: 2.7","row: 27<br>column: Petal.Length<br>value: 3.9","row: 27<br>column: Petal.Width<br>value: 1.4","row: 27<br>column: Sepal.Length<br>value: 5.2"],["row: 26<br>column: Sepal.Width<br>value: 2.5","row: 26<br>column: Petal.Length<br>value: 4","row: 26<br>column: Petal.Width<br>value: 1.3","row: 26<br>column: Sepal.Length<br>value: 5.5"],["row: 20<br>column: Sepal.Width<br>value: 2.6","row: 20<br>column: Petal.Length<br>value: 4.4","row: 20<br>column: Petal.Width<br>value: 1.2","row: 20<br>column: Sepal.Length<br>value: 5.5"],["row: 28<br>column: Sepal.Width<br>value: 2.7","row: 28<br>column: Petal.Length<br>value: 4.2","row: 28<br>column: Petal.Width<br>value: 1.3","row: 28<br>column: Sepal.Length<br>value: 5.6"],["row: 19<br>column: Sepal.Width<br>value: 2.9","row: 19<br>column: Petal.Length<br>value: 4.2","row: 19<br>column: Petal.Width<br>value: 1.3","row: 19<br>column: Sepal.Length<br>value: 5.7"],["row: 6<br>column: Sepal.Width<br>value: 2.5","row: 6<br>column: Petal.Length<br>value: 5.8","row: 6<br>column: Petal.Width<br>value: 1.8","row: 6<br>column: Sepal.Length<br>value: 6.7"],["row: 1<br>column: Sepal.Width<br>value: 3","row: 1<br>column: Petal.Length<br>value: 5.9","row: 1<br>column: Petal.Width<br>value: 2.1","row: 1<br>column: Sepal.Length<br>value: 7.1"],["row: 30<br>column: Sepal.Width<br>value: 3.2","row: 30<br>column: Petal.Length<br>value: 5.3","row: 30<br>column: Petal.Width<br>value: 2.3","row: 30<br>column: Sepal.Length<br>value: 6.4"],["row: 8<br>column: Sepal.Width<br>value: 3.4","row: 8<br>column: Petal.Length<br>value: 5.6","row: 8<br>column: Petal.Width<br>value: 2.4","row: 8<br>column: Sepal.Length<br>value: 6.3"],["row: 13<br>column: Sepal.Width<br>value: 3.1","row: 13<br>column: Petal.Length<br>value: 5.4","row: 13<br>column: Petal.Width<br>value: 2.1","row: 13<br>column: Sepal.Length<br>value: 6.9"],["row: 17<br>column: Sepal.Width<br>value: 3","row: 17<br>column: Petal.Length<br>value: 5.2","row: 17<br>column: Petal.Width<br>value: 2","row: 17<br>column: Sepal.Length<br>value: 6.5"],["row: 2<br>column: Sepal.Width<br>value: 3","row: 2<br>column: Petal.Length<br>value: 5.5","row: 2<br>column: Petal.Width<br>value: 1.8","row: 2<br>column: Sepal.Length<br>value: 6.5"],["row: 35<br>column: Sepal.Width<br>value: 3.4","row: 35<br>column: Petal.Length<br>value: 4.5","row: 35<br>column: Petal.Width<br>value: 1.6","row: 35<br>column: Sepal.Length<br>value: 6"],["row: 3<br>column: Sepal.Width<br>value: 3","row: 3<br>column: Petal.Length<br>value: 4.4","row: 3<br>column: Petal.Width<br>value: 1.4","row: 3<br>column: Sepal.Length<br>value: 6.6"],["row: 11<br>column: Sepal.Width<br>value: 3.1","row: 11<br>column: Petal.Length<br>value: 4.9","row: 11<br>column: Petal.Width<br>value: 1.5","row: 11<br>column: Sepal.Length<br>value: 6.9"],["row: 12<br>column: Sepal.Width<br>value: 2.6","row: 12<br>column: Petal.Length<br>value: 5.6","row: 12<br>column: Petal.Width<br>value: 1.4","row: 12<br>column: Sepal.Length<br>value: 6.1"],["row: 4<br>column: Sepal.Width<br>value: 2.7","row: 4<br>column: Petal.Length<br>value: 5.1","row: 4<br>column: Petal.Width<br>value: 1.9","row: 4<br>column: Sepal.Length<br>value: 5.8"],["row: 34<br>column: Sepal.Width<br>value: 3","row: 34<br>column: Petal.Length<br>value: 4.8","row: 34<br>column: Petal.Width<br>value: 1.8","row: 34<br>column: Sepal.Length<br>value: 6"],["row: 15<br>column: Sepal.Width<br>value: 2.2","row: 15<br>column: Petal.Length<br>value: 4.5","row: 15<br>column: Petal.Width<br>value: 1.5","row: 15<br>column: Sepal.Length<br>value: 6.2"],["row: 9<br>column: Sepal.Width<br>value: 2.8","row: 9<br>column: Petal.Length<br>value: 4.7","row: 9<br>column: Petal.Width<br>value: 1.2","row: 9<br>column: Sepal.Length<br>value: 6.1"],["row: 23<br>column: Sepal.Width<br>value: 2.9","row: 23<br>column: Petal.Length<br>value: 4.5","row: 23<br>column: Petal.Width<br>value: 1.5","row: 23<br>column: Sepal.Length<br>value: 6"]],"showlegend":false,"hoverinfo":"text","zmin":null,"zmax":null,"colors":["#440154FF","#440256FF","#450457FF","#450559FF","#46075AFF","#46085CFF","#460A5DFF","#460B5EFF","#470D60FF","#470E61FF","#471063FF","#471164FF","#471365FF","#481467FF","#481668FF","#481769FF","#48186AFF","#481A6CFF","#481B6DFF","#481C6EFF","#481D6FFF","#481F70FF","#482071FF","#482173FF","#482374FF","#482475FF","#482576FF","#482677FF","#482878FF","#482979FF","#472A7AFF","#472C7AFF","#472D7BFF","#472E7CFF","#472F7DFF","#46307EFF","#46327EFF","#46337FFF","#463480FF","#453581FF","#453781FF","#453882FF","#443983FF","#443A83FF","#443B84FF","#433D84FF","#433E85FF","#423F85FF","#424086FF","#424186FF","#414287FF","#414487FF","#404588FF","#404688FF","#3F4788FF","#3F4889FF","#3E4989FF","#3E4A89FF","#3E4C8AFF","#3D4D8AFF","#3D4E8AFF","#3C4F8AFF","#3C508BFF","#3B518BFF","#3B528BFF","#3A538BFF","#3A548CFF","#39558CFF","#39568CFF","#38588CFF","#38598CFF","#375A8CFF","#375B8DFF","#365C8DFF","#365D8DFF","#355E8DFF","#355F8DFF","#34608DFF","#34618DFF","#33628DFF","#33638DFF","#32648EFF","#32658EFF","#31668EFF","#31678EFF","#31688EFF","#30698EFF","#306A8EFF","#2F6B8EFF","#2F6C8EFF","#2E6D8EFF","#2E6E8EFF","#2E6F8EFF","#2D708EFF","#2D718EFF","#2C718EFF","#2C728EFF","#2C738EFF","#2B748EFF","#2B758EFF","#2A768EFF","#2A778EFF","#2A788EFF","#29798EFF","#297A8EFF","#297B8EFF","#287C8EFF","#287D8EFF","#277E8EFF","#277F8EFF","#27808EFF","#26818EFF","#26828EFF","#26828EFF","#25838EFF","#25848EFF","#25858EFF","#24868EFF","#24878EFF","#23888EFF","#23898EFF","#238A8DFF","#228B8DFF","#228C8DFF","#228D8DFF","#218E8DFF","#218F8DFF","#21908DFF","#21918CFF","#20928CFF","#20928CFF","#20938CFF","#1F948CFF","#1F958BFF","#1F968BFF","#1F978BFF","#1F988BFF","#1F998AFF","#1F9A8AFF","#1E9B8AFF","#1E9C89FF","#1E9D89FF","#1F9E89FF","#1F9F88FF","#1FA088FF","#1FA188FF","#1FA187FF","#1FA287FF","#20A386FF","#20A486FF","#21A585FF","#21A685FF","#22A785FF","#22A884FF","#23A983FF","#24AA83FF","#25AB82FF","#25AC82FF","#26AD81FF","#27AD81FF","#28AE80FF","#29AF7FFF","#2AB07FFF","#2CB17EFF","#2DB27DFF","#2EB37CFF","#2FB47CFF","#31B57BFF","#32B67AFF","#34B679FF","#35B779FF","#37B878FF","#38B977FF","#3ABA76FF","#3BBB75FF","#3DBC74FF","#3FBC73FF","#40BD72FF","#42BE71FF","#44BF70FF","#46C06FFF","#48C16EFF","#4AC16DFF","#4CC26CFF","#4EC36BFF","#50C46AFF","#52C569FF","#54C568FF","#56C667FF","#58C765FF","#5AC864FF","#5CC863FF","#5EC962FF","#60CA60FF","#63CB5FFF","#65CB5EFF","#67CC5CFF","#69CD5BFF","#6CCD5AFF","#6ECE58FF","#70CF57FF","#73D056FF","#75D054FF","#77D153FF","#7AD151FF","#7CD250FF","#7FD34EFF","#81D34DFF","#84D44BFF","#86D549FF","#89D548FF","#8BD646FF","#8ED645FF","#90D743FF","#93D741FF","#95D840FF","#98D83EFF","#9BD93CFF","#9DD93BFF","#A0DA39FF","#A2DA37FF","#A5DB36FF","#A8DB34FF","#AADC32FF","#ADDC30FF","#B0DD2FFF","#B2DD2DFF","#B5DE2BFF","#B8DE29FF","#BADE28FF","#BDDF26FF","#C0DF25FF","#C2DF23FF","#C5E021FF","#C8E020FF","#CAE11FFF","#CDE11DFF","#D0E11CFF","#D2E21BFF","#D5E21AFF","#D8E219FF","#DAE319FF","#DDE318FF","#DFE318FF","#E2E418FF","#E5E419FF","#E7E419FF","#EAE51AFF","#ECE51BFF","#EFE51CFF","#F1E51DFF","#F4E61EFF","#F6E620FF","#F8E621FF","#FBE723FF","#FDE725FF"],"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"heatmap"}},"source":"A","config":{"showSendToCloud":false,"displaylogo":false,"modeBarButtonsToRemove":["sendDataToCloud","select2d","lasso2d","autoScale2d","hoverClosestCartesian","hoverCompareCartesian","sendDataToCloud"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"subplot":true,"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>


---


# Visualizaci√≥n previa


Podemos mejorar la representaci√≥n **estandarizando por rango** las variables, haciendo uso de `rescale()` del paquete `{scales}`


```r
library(scales)
iris_range &lt;- 
  iris_sample %&gt;%
  mutate(across(where(is.numeric), rescale))

heatmaply(iris_range,
          seriate = "mean",
          row_dend_left = TRUE,
          plot_method = "plotly")
```

---


# Visualizaci√≥n previa

<div id="htmlwidget-0c44f57ef2983315589f" style="width:100%;height:840px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-0c44f57ef2983315589f">{"x":{"data":[{"type":"scatter","mode":"markers","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"type":"scatter","mode":"markers","marker":{"color":"rgba(255,127,14,1)","line":{"color":"rgba(255,127,14,1)"}},"error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"line":{"color":"rgba(255,127,14,1)"},"xaxis":"x2","yaxis":"y","frame":null},{"x":[3.125,2.25,null,2.25,2.25,null,2.25,1.5,null,1.5,1.5,null,1.5,1,null,1,1,null,1.5,2,null,2,2,null,2.25,3,null,3,3,null,3.125,4,null,4,4],"y":[3.2063128140195,3.2063128140195,null,3.2063128140195,1.3132283742805,null,1.3132283742805,1.3132283742805,null,1.3132283742805,0.773840891378614,null,0.773840891378614,0.773840891378614,null,0.773840891378614,0,null,0.773840891378614,0.773840891378614,null,0.773840891378614,0,null,1.3132283742805,1.3132283742805,null,1.3132283742805,0,null,3.2063128140195,3.2063128140195,null,3.2063128140195,0],"type":"scatter","mode":"lines","showlegend":false,"hoverinfo":["y","y",null,"y","y",null,"y","y",null,"y","y",null,"y","y",null,"y","y",null,"y","y",null,"y","y",null,"y","y",null,"y","y",null,"y","y",null,"y","y"],"name":"1","marker":{"color":"rgba(0,0,0,1)","line":{"color":"rgba(0,0,0,1)"}},"textfont":{"color":"rgba(0,0,0,1)"},"error_y":{"color":"rgba(0,0,0,1)"},"error_x":{"color":"rgba(0,0,0,1)"},"line":{"color":"rgba(0,0,0,1)"},"xaxis":"x3","yaxis":"y","frame":null},{"x":[1.66036135374942,1.66036135374942,null,1.66036135374942,0.634443395855012,null,0.634443395855012,0.634443395855012,null,0.634443395855012,0.150473893452481,null,0.150473893452481,0.150473893452481,null,0.150473893452481,0,null,0.150473893452481,0.150473893452481,null,0.150473893452481,0,null,0.634443395855012,0.634443395855012,null,0.634443395855012,0.399614426517607,null,0.399614426517607,0.399614426517607,null,0.399614426517607,0.182496337008423,null,0.182496337008423,0.182496337008423,null,0.182496337008423,0.129686977079326,null,0.129686977079326,0.129686977079326,null,0.129686977079326,0,null,0.129686977079326,0.129686977079326,null,0.129686977079326,0,null,0.182496337008423,0.182496337008423,null,0.182496337008423,0.107907578525841,null,0.107907578525841,0.107907578525841,null,0.107907578525841,0,null,0.107907578525841,0.107907578525841,null,0.107907578525841,0,null,0.399614426517607,0.399614426517607,null,0.399614426517607,0.243339945826721,null,0.243339945826721,0.243339945826721,null,0.243339945826721,0.0960594044558961,null,0.0960594044558961,0.0960594044558961,null,0.0960594044558961,0,null,0.0960594044558961,0.0960594044558961,null,0.0960594044558961,0,null,0.243339945826721,0.243339945826721,null,0.243339945826721,0.156345916170876,null,0.156345916170876,0.156345916170876,null,0.156345916170876,0,null,0.156345916170876,0.156345916170876,null,0.156345916170876,0,null,1.66036135374942,1.66036135374942,null,1.66036135374942,1.14765956764818,null,1.14765956764818,1.14765956764818,null,1.14765956764818,0.544489465900116,null,0.544489465900116,0.544489465900116,null,0.544489465900116,0.12451208828435,null,0.12451208828435,0.12451208828435,null,0.12451208828435,0,null,0.12451208828435,0.12451208828435,null,0.12451208828435,0,null,0.544489465900116,0.544489465900116,null,0.544489465900116,0.475750515515348,null,0.475750515515348,0.475750515515348,null,0.475750515515348,0.169613687735708,null,0.169613687735708,0.169613687735708,null,0.169613687735708,0,null,0.169613687735708,0.169613687735708,null,0.169613687735708,0,null,0.475750515515348,0.475750515515348,null,0.475750515515348,0.323198526991148,null,0.323198526991148,0.323198526991148,null,0.323198526991148,0.137398849700658,null,0.137398849700658,0.137398849700658,null,0.137398849700658,0,null,0.137398849700658,0.137398849700658,null,0.137398849700658,0,null,0.323198526991148,0.323198526991148,null,0.323198526991148,0.283915624504946,null,0.283915624504946,0.283915624504946,null,0.283915624504946,0,null,0.283915624504946,0.283915624504946,null,0.283915624504946,0.106347895248276,null,0.106347895248276,0.106347895248276,null,0.106347895248276,0,null,0.106347895248276,0.106347895248276,null,0.106347895248276,0,null,1.14765956764818,1.14765956764818,null,1.14765956764818,0.73350387897341,null,0.73350387897341,0.73350387897341,null,0.73350387897341,0.582837975187665,null,0.582837975187665,0.582837975187665,null,0.582837975187665,0.253123107208002,null,0.253123107208002,0.253123107208002,null,0.253123107208002,0,null,0.253123107208002,0.253123107208002,null,0.253123107208002,0,null,0.582837975187665,0.582837975187665,null,0.582837975187665,0.403072043766498,null,0.403072043766498,0.403072043766498,null,0.403072043766498,0,null,0.403072043766498,0.403072043766498,null,0.403072043766498,0.347359536579261,null,0.347359536579261,0.347359536579261,null,0.347359536579261,0,null,0.347359536579261,0.347359536579261,null,0.347359536579261,0.18557984958511,null,0.18557984958511,0.18557984958511,null,0.18557984958511,0,null,0.18557984958511,0.18557984958511,null,0.18557984958511,0.107379864599332,null,0.107379864599332,0.107379864599332,null,0.107379864599332,0,null,0.107379864599332,0.107379864599332,null,0.107379864599332,0.084984983274546,null,0.084984983274546,0.084984983274546,null,0.084984983274546,0,null,0.084984983274546,0.084984983274546,null,0.084984983274546,0,null,0.73350387897341,0.73350387897341,null,0.73350387897341,0.437936650787663,null,0.437936650787663,0.437936650787663,null,0.437936650787663,0.302587438792158,null,0.302587438792158,0.302587438792158,null,0.302587438792158,0,null,0.302587438792158,0.302587438792158,null,0.302587438792158,0.175025251439118,null,0.175025251439118,0.175025251439118,null,0.175025251439118,0,null,0.175025251439118,0.175025251439118,null,0.175025251439118,0,null,0.437936650787663,0.437936650787663,null,0.437936650787663,0.32846900080918,null,0.32846900080918,0.32846900080918,null,0.32846900080918,0,null,0.32846900080918,0.32846900080918,null,0.32846900080918,0.199921992455322,null,0.199921992455322,0.199921992455322,null,0.199921992455322,0,null,0.199921992455322,0.199921992455322,null,0.199921992455322,0.149483513231763,null,0.149483513231763,0.149483513231763,null,0.149483513231763,0,null,0.149483513231763,0.149483513231763,null,0.149483513231763,0.147104998460392,null,0.147104998460392,0.147104998460392,null,0.147104998460392,0,null,0.147104998460392,0.147104998460392,null,0.147104998460392,0],"y":[11.830078125,4,null,4,4,null,4,1.5,null,1.5,1.5,null,1.5,1,null,1,1,null,1.5,2,null,2,2,null,4,6.5,null,6.5,6.5,null,6.5,4.5,null,4.5,4.5,null,4.5,3.5,null,3.5,3.5,null,3.5,3,null,3,3,null,3.5,4,null,4,4,null,4.5,5.5,null,5.5,5.5,null,5.5,5,null,5,5,null,5.5,6,null,6,6,null,6.5,8.5,null,8.5,8.5,null,8.5,7.5,null,7.5,7.5,null,7.5,7,null,7,7,null,7.5,8,null,8,8,null,8.5,9.5,null,9.5,9.5,null,9.5,9,null,9,9,null,9.5,10,null,10,10,null,11.830078125,19.66015625,null,19.66015625,19.66015625,null,19.66015625,13.28125,null,13.28125,13.28125,null,13.28125,11.5,null,11.5,11.5,null,11.5,11,null,11,11,null,11.5,12,null,12,12,null,13.28125,15.0625,null,15.0625,15.0625,null,15.0625,13.5,null,13.5,13.5,null,13.5,13,null,13,13,null,13.5,14,null,14,14,null,15.0625,16.625,null,16.625,16.625,null,16.625,15.5,null,15.5,15.5,null,15.5,15,null,15,15,null,15.5,16,null,16,16,null,16.625,17.75,null,17.75,17.75,null,17.75,17,null,17,17,null,17.75,18.5,null,18.5,18.5,null,18.5,18,null,18,18,null,18.5,19,null,19,19,null,19.66015625,26.0390625,null,26.0390625,26.0390625,null,26.0390625,21.734375,null,21.734375,21.734375,null,21.734375,20.5,null,20.5,20.5,null,20.5,20,null,20,20,null,20.5,21,null,21,21,null,21.734375,22.96875,null,22.96875,22.96875,null,22.96875,22,null,22,22,null,22.96875,23.9375,null,23.9375,23.9375,null,23.9375,23,null,23,23,null,23.9375,24.875,null,24.875,24.875,null,24.875,24,null,24,24,null,24.875,25.75,null,25.75,25.75,null,25.75,25,null,25,25,null,25.75,26.5,null,26.5,26.5,null,26.5,26,null,26,26,null,26.5,27,null,27,27,null,26.0390625,30.34375,null,30.34375,30.34375,null,30.34375,28.75,null,28.75,28.75,null,28.75,28,null,28,28,null,28.75,29.5,null,29.5,29.5,null,29.5,29,null,29,29,null,29.5,30,null,30,30,null,30.34375,31.9375,null,31.9375,31.9375,null,31.9375,31,null,31,31,null,31.9375,32.875,null,32.875,32.875,null,32.875,32,null,32,32,null,32.875,33.75,null,33.75,33.75,null,33.75,33,null,33,33,null,33.75,34.5,null,34.5,34.5,null,34.5,34,null,34,34,null,34.5,35,null,35,35],"type":"scatter","mode":"lines","showlegend":false,"hoverinfo":["x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x"],"name":"1","marker":{"color":"rgba(0,0,0,1)","line":{"color":"rgba(0,0,0,1)"}},"textfont":{"color":"rgba(0,0,0,1)"},"error_y":{"color":"rgba(0,0,0,1)"},"error_x":{"color":"rgba(0,0,0,1)"},"line":{"color":"rgba(0,0,0,1)"},"xaxis":"x","yaxis":"y2","frame":null},{"colorbar":{"title":"Species","ticklen":2,"tickmode":"array","tickvals":[1.33333333333333,2,2.66666666666667],"ticktext":["setosa","versicolor","virginica"],"len":0.3,"lenmode":"fraction","y":1,"yanchor":"top"},"colorscale":[[0,"#A6CEE3"],[0.00334448160535117,"#A6CEE3"],[0.00668896321070234,"#A6CEE3"],[0.0100334448160535,"#A6CEE3"],[0.0133779264214047,"#A6CEE3"],[0.0167224080267559,"#A6CEE3"],[0.020066889632107,"#A6CEE3"],[0.0234113712374582,"#A6CEE3"],[0.0267558528428094,"#A6CEE3"],[0.0301003344481605,"#A6CEE3"],[0.0334448160535117,"#A6CEE3"],[0.0367892976588629,"#A6CEE3"],[0.040133779264214,"#A6CEE3"],[0.0434782608695652,"#A6CEE3"],[0.0468227424749164,"#A6CEE3"],[0.0501672240802676,"#A6CEE3"],[0.0535117056856187,"#A6CEE3"],[0.0568561872909699,"#A6CEE3"],[0.0602006688963211,"#A6CEE3"],[0.0635451505016722,"#A6CEE3"],[0.0668896321070234,"#A6CEE3"],[0.0702341137123746,"#A6CEE3"],[0.0735785953177257,"#A6CEE3"],[0.0769230769230769,"#A6CEE3"],[0.0802675585284281,"#A6CEE3"],[0.0836120401337793,"#A6CEE3"],[0.0869565217391304,"#A6CEE3"],[0.0903010033444816,"#A6CEE3"],[0.0936454849498328,"#A6CEE3"],[0.096989966555184,"#A6CEE3"],[0.100334448160535,"#A6CEE3"],[0.103678929765886,"#A6CEE3"],[0.107023411371237,"#A6CEE3"],[0.110367892976589,"#A6CEE3"],[0.11371237458194,"#A6CEE3"],[0.117056856187291,"#A6CEE3"],[0.120401337792642,"#A6CEE3"],[0.123745819397993,"#A6CEE3"],[0.127090301003344,"#A6CEE3"],[0.130434782608696,"#A6CEE3"],[0.133779264214047,"#A6CEE3"],[0.137123745819398,"#A6CEE3"],[0.140468227424749,"#A6CEE3"],[0.1438127090301,"#A6CEE3"],[0.147157190635451,"#A6CEE3"],[0.150501672240803,"#A6CEE3"],[0.153846153846154,"#A6CEE3"],[0.157190635451505,"#A6CEE3"],[0.160535117056856,"#A6CEE3"],[0.163879598662207,"#A6CEE3"],[0.167224080267559,"#A6CEE3"],[0.17056856187291,"#A6CEE3"],[0.173913043478261,"#A6CEE3"],[0.177257525083612,"#A6CEE3"],[0.180602006688963,"#A6CEE3"],[0.183946488294314,"#A6CEE3"],[0.187290969899666,"#A6CEE3"],[0.190635451505017,"#A6CEE3"],[0.193979933110368,"#A6CEE3"],[0.197324414715719,"#A6CEE3"],[0.20066889632107,"#A6CEE3"],[0.204013377926421,"#A6CEE3"],[0.207357859531773,"#A6CEE3"],[0.210702341137124,"#A6CEE3"],[0.214046822742475,"#A6CEE3"],[0.217391304347826,"#A6CEE3"],[0.220735785953177,"#A6CEE3"],[0.224080267558528,"#A6CEE3"],[0.22742474916388,"#A6CEE3"],[0.230769230769231,"#A6CEE3"],[0.234113712374582,"#A6CEE3"],[0.237458193979933,"#A6CEE3"],[0.240802675585284,"#A6CEE3"],[0.244147157190635,"#A6CEE3"],[0.247491638795987,"#A6CEE3"],[0.250836120401338,"#A6CEE3"],[0.254180602006689,"#A6CEE3"],[0.25752508361204,"#A6CEE3"],[0.260869565217391,"#A6CEE3"],[0.264214046822742,"#A6CEE3"],[0.267558528428094,"#A6CEE3"],[0.270903010033445,"#A6CEE3"],[0.274247491638796,"#A6CEE3"],[0.277591973244147,"#A6CEE3"],[0.280936454849498,"#A6CEE3"],[0.284280936454849,"#A6CEE3"],[0.287625418060201,"#A6CEE3"],[0.290969899665552,"#A6CEE3"],[0.294314381270903,"#A6CEE3"],[0.297658862876254,"#A6CEE3"],[0.301003344481605,"#A6CEE3"],[0.304347826086957,"#A6CEE3"],[0.307692307692308,"#A6CEE3"],[0.311036789297659,"#A6CEE3"],[0.31438127090301,"#A6CEE3"],[0.317725752508361,"#A6CEE3"],[0.321070234113712,"#A6CEE3"],[0.324414715719064,"#A6CEE3"],[0.327759197324415,"#A6CEE3"],[0.331103678929766,"#A6CEE3"],[0.334448160535117,"#1F78B4"],[0.337792642140468,"#1F78B4"],[0.341137123745819,"#1F78B4"],[0.344481605351171,"#1F78B4"],[0.347826086956522,"#1F78B4"],[0.351170568561873,"#1F78B4"],[0.354515050167224,"#1F78B4"],[0.357859531772575,"#1F78B4"],[0.361204013377926,"#1F78B4"],[0.364548494983278,"#1F78B4"],[0.367892976588629,"#1F78B4"],[0.37123745819398,"#1F78B4"],[0.374581939799331,"#1F78B4"],[0.377926421404682,"#1F78B4"],[0.381270903010033,"#1F78B4"],[0.384615384615385,"#1F78B4"],[0.387959866220736,"#1F78B4"],[0.391304347826087,"#1F78B4"],[0.394648829431438,"#1F78B4"],[0.397993311036789,"#1F78B4"],[0.40133779264214,"#1F78B4"],[0.404682274247492,"#1F78B4"],[0.408026755852843,"#1F78B4"],[0.411371237458194,"#1F78B4"],[0.414715719063545,"#1F78B4"],[0.418060200668896,"#1F78B4"],[0.421404682274247,"#1F78B4"],[0.424749163879599,"#1F78B4"],[0.42809364548495,"#1F78B4"],[0.431438127090301,"#1F78B4"],[0.434782608695652,"#1F78B4"],[0.438127090301003,"#1F78B4"],[0.441471571906354,"#1F78B4"],[0.444816053511706,"#1F78B4"],[0.448160535117057,"#1F78B4"],[0.451505016722408,"#1F78B4"],[0.454849498327759,"#1F78B4"],[0.45819397993311,"#1F78B4"],[0.461538461538462,"#1F78B4"],[0.464882943143813,"#1F78B4"],[0.468227424749164,"#1F78B4"],[0.471571906354515,"#1F78B4"],[0.474916387959866,"#1F78B4"],[0.478260869565217,"#1F78B4"],[0.481605351170569,"#1F78B4"],[0.48494983277592,"#1F78B4"],[0.488294314381271,"#1F78B4"],[0.491638795986622,"#1F78B4"],[0.494983277591973,"#1F78B4"],[0.498327759197324,"#1F78B4"],[0.501672240802676,"#1F78B4"],[0.505016722408027,"#1F78B4"],[0.508361204013378,"#1F78B4"],[0.511705685618729,"#1F78B4"],[0.51505016722408,"#1F78B4"],[0.518394648829431,"#1F78B4"],[0.521739130434783,"#1F78B4"],[0.525083612040134,"#1F78B4"],[0.528428093645485,"#1F78B4"],[0.531772575250836,"#1F78B4"],[0.535117056856187,"#1F78B4"],[0.538461538461538,"#1F78B4"],[0.54180602006689,"#1F78B4"],[0.545150501672241,"#1F78B4"],[0.548494983277592,"#1F78B4"],[0.551839464882943,"#1F78B4"],[0.555183946488294,"#1F78B4"],[0.558528428093645,"#1F78B4"],[0.561872909698997,"#1F78B4"],[0.565217391304348,"#1F78B4"],[0.568561872909699,"#1F78B4"],[0.57190635451505,"#1F78B4"],[0.575250836120401,"#1F78B4"],[0.578595317725752,"#1F78B4"],[0.581939799331104,"#1F78B4"],[0.585284280936455,"#1F78B4"],[0.588628762541806,"#1F78B4"],[0.591973244147157,"#1F78B4"],[0.595317725752508,"#1F78B4"],[0.598662207357859,"#1F78B4"],[0.602006688963211,"#1F78B4"],[0.605351170568562,"#1F78B4"],[0.608695652173913,"#1F78B4"],[0.612040133779264,"#1F78B4"],[0.615384615384615,"#1F78B4"],[0.618729096989967,"#1F78B4"],[0.622073578595318,"#1F78B4"],[0.625418060200669,"#1F78B4"],[0.62876254180602,"#1F78B4"],[0.632107023411371,"#1F78B4"],[0.635451505016722,"#1F78B4"],[0.638795986622074,"#1F78B4"],[0.642140468227425,"#1F78B4"],[0.645484949832776,"#1F78B4"],[0.648829431438127,"#1F78B4"],[0.652173913043478,"#1F78B4"],[0.655518394648829,"#1F78B4"],[0.658862876254181,"#1F78B4"],[0.662207357859532,"#1F78B4"],[0.665551839464883,"#1F78B4"],[0.668896321070234,"#B2DF8A"],[0.672240802675585,"#B2DF8A"],[0.675585284280936,"#B2DF8A"],[0.678929765886288,"#B2DF8A"],[0.682274247491639,"#B2DF8A"],[0.68561872909699,"#B2DF8A"],[0.688963210702341,"#B2DF8A"],[0.692307692307692,"#B2DF8A"],[0.695652173913043,"#B2DF8A"],[0.698996655518395,"#B2DF8A"],[0.702341137123746,"#B2DF8A"],[0.705685618729097,"#B2DF8A"],[0.709030100334448,"#B2DF8A"],[0.712374581939799,"#B2DF8A"],[0.71571906354515,"#B2DF8A"],[0.719063545150502,"#B2DF8A"],[0.722408026755853,"#B2DF8A"],[0.725752508361204,"#B2DF8A"],[0.729096989966555,"#B2DF8A"],[0.732441471571906,"#B2DF8A"],[0.735785953177257,"#B2DF8A"],[0.739130434782609,"#B2DF8A"],[0.74247491638796,"#B2DF8A"],[0.745819397993311,"#B2DF8A"],[0.749163879598662,"#B2DF8A"],[0.752508361204013,"#B2DF8A"],[0.755852842809364,"#B2DF8A"],[0.759197324414716,"#B2DF8A"],[0.762541806020067,"#B2DF8A"],[0.765886287625418,"#B2DF8A"],[0.769230769230769,"#B2DF8A"],[0.77257525083612,"#B2DF8A"],[0.775919732441472,"#B2DF8A"],[0.779264214046823,"#B2DF8A"],[0.782608695652174,"#B2DF8A"],[0.785953177257525,"#B2DF8A"],[0.789297658862876,"#B2DF8A"],[0.792642140468227,"#B2DF8A"],[0.795986622073579,"#B2DF8A"],[0.79933110367893,"#B2DF8A"],[0.802675585284281,"#B2DF8A"],[0.806020066889632,"#B2DF8A"],[0.809364548494983,"#B2DF8A"],[0.812709030100334,"#B2DF8A"],[0.816053511705686,"#B2DF8A"],[0.819397993311037,"#B2DF8A"],[0.822742474916388,"#B2DF8A"],[0.826086956521739,"#B2DF8A"],[0.82943143812709,"#B2DF8A"],[0.832775919732441,"#B2DF8A"],[0.836120401337793,"#B2DF8A"],[0.839464882943144,"#B2DF8A"],[0.842809364548495,"#B2DF8A"],[0.846153846153846,"#B2DF8A"],[0.849498327759197,"#B2DF8A"],[0.852842809364548,"#B2DF8A"],[0.8561872909699,"#B2DF8A"],[0.859531772575251,"#B2DF8A"],[0.862876254180602,"#B2DF8A"],[0.866220735785953,"#B2DF8A"],[0.869565217391304,"#B2DF8A"],[0.872909698996655,"#B2DF8A"],[0.876254180602007,"#B2DF8A"],[0.879598662207358,"#B2DF8A"],[0.882943143812709,"#B2DF8A"],[0.88628762541806,"#B2DF8A"],[0.889632107023411,"#B2DF8A"],[0.892976588628763,"#B2DF8A"],[0.896321070234114,"#B2DF8A"],[0.899665551839465,"#B2DF8A"],[0.903010033444816,"#B2DF8A"],[0.906354515050167,"#B2DF8A"],[0.909698996655518,"#B2DF8A"],[0.91304347826087,"#B2DF8A"],[0.916387959866221,"#B2DF8A"],[0.919732441471572,"#B2DF8A"],[0.923076923076923,"#B2DF8A"],[0.926421404682274,"#B2DF8A"],[0.929765886287625,"#B2DF8A"],[0.933110367892977,"#B2DF8A"],[0.936454849498328,"#B2DF8A"],[0.939799331103679,"#B2DF8A"],[0.94314381270903,"#B2DF8A"],[0.946488294314381,"#B2DF8A"],[0.949832775919732,"#B2DF8A"],[0.953177257525084,"#B2DF8A"],[0.956521739130435,"#B2DF8A"],[0.959866220735786,"#B2DF8A"],[0.963210702341137,"#B2DF8A"],[0.966555183946488,"#B2DF8A"],[0.969899665551839,"#B2DF8A"],[0.973244147157191,"#B2DF8A"],[0.976588628762542,"#B2DF8A"],[0.979933110367893,"#B2DF8A"],[0.983277591973244,"#B2DF8A"],[0.986622073578595,"#B2DF8A"],[0.989966555183946,"#B2DF8A"],[0.993311036789298,"#B2DF8A"],[0.996655518394649,"#B2DF8A"],[1,"#B2DF8A"]],"showscale":true,"z":[[1],[1],[1],[1],[1],[1],[1],[1],[1],[1],[3],[3],[2],[2],[3],[3],[3],[3],[3],[2],[2],[2],[3],[2],[2],[2],[2],[3],[3],[3],[2],[2],[2],[2],[2]],"x":[1],"y":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35],"text":[["value: setosa<br>variable: Species<br>row: 14"],["value: setosa<br>variable: Species<br>row: 29"],["value: setosa<br>variable: Species<br>row: 10"],["value: setosa<br>variable: Species<br>row: 7"],["value: setosa<br>variable: Species<br>row: 21"],["value: setosa<br>variable: Species<br>row: 24"],["value: setosa<br>variable: Species<br>row: 22"],["value: setosa<br>variable: Species<br>row: 5"],["value: setosa<br>variable: Species<br>row: 25"],["value: setosa<br>variable: Species<br>row: 32"],["value: virginica<br>variable: Species<br>row: 30"],["value: virginica<br>variable: Species<br>row: 8"],["value: versicolor<br>variable: Species<br>row: 3"],["value: versicolor<br>variable: Species<br>row: 11"],["value: virginica<br>variable: Species<br>row: 13"],["value: virginica<br>variable: Species<br>row: 1"],["value: virginica<br>variable: Species<br>row: 6"],["value: virginica<br>variable: Species<br>row: 2"],["value: virginica<br>variable: Species<br>row: 17"],["value: versicolor<br>variable: Species<br>row: 18"],["value: versicolor<br>variable: Species<br>row: 15"],["value: versicolor<br>variable: Species<br>row: 31"],["value: virginica<br>variable: Species<br>row: 33"],["value: versicolor<br>variable: Species<br>row: 27"],["value: versicolor<br>variable: Species<br>row: 26"],["value: versicolor<br>variable: Species<br>row: 20"],["value: versicolor<br>variable: Species<br>row: 28"],["value: virginica<br>variable: Species<br>row: 12"],["value: virginica<br>variable: Species<br>row: 4"],["value: virginica<br>variable: Species<br>row: 34"],["value: versicolor<br>variable: Species<br>row: 35"],["value: versicolor<br>variable: Species<br>row: 19"],["value: versicolor<br>variable: Species<br>row: 9"],["value: versicolor<br>variable: Species<br>row: 16"],["value: versicolor<br>variable: Species<br>row: 23"]],"hoverinfo":"text","showlegend":false,"type":"heatmap","xaxis":"x2","yaxis":"y2","frame":null},{"colorbar":{"ticklen":2,"lenmode":"fraction","xanchor":"right","x":-0.1,"y":0,"yanchor":"bottom","len":0.3,"thickness":30},"colorscale":[["0","rgba(68,1,84,1)"],["0.0416666666666667","rgba(71,17,100,1)"],["0.0833333333333333","rgba(72,31,112,1)"],["0.125","rgba(71,45,123,1)"],["0.166666666666667","rgba(68,58,131,1)"],["0.208333333333333","rgba(64,70,136,1)"],["0.25","rgba(59,82,139,1)"],["0.291666666666667","rgba(54,93,141,1)"],["0.333333333333333","rgba(49,104,142,1)"],["0.375","rgba(44,114,142,1)"],["0.416666666666667","rgba(40,124,142,1)"],["0.458333333333333","rgba(36,134,142,1)"],["0.5","rgba(33,144,141,1)"],["0.541666666666667","rgba(31,154,138,1)"],["0.583333333333333","rgba(32,164,134,1)"],["0.625","rgba(39,173,129,1)"],["0.666666666666667","rgba(53,183,121,1)"],["0.708333333333333","rgba(71,193,110,1)"],["0.75","rgba(93,200,99,1)"],["0.791666666666667","rgba(117,208,84,1)"],["0.833333333333333","rgba(143,214,68,1)"],["0.875","rgba(170,220,50,1)"],["0.916666666666667","rgba(199,224,32,1)"],["0.958333333333333","rgba(227,228,24,1)"],["1","rgba(253,231,37,1)"]],"showscale":true,"z":[[0.0434782608695652,0.0816326530612245,0.36,0.909090909090909],[0.130434782608696,0.102040816326531,0.44,1],[0.0434782608695652,0,0,0.636363636363636],[0.0869565217391304,0.0816326530612245,0,0.545454545454545],[0,0.0816326530612245,0.12,0.636363636363636],[0.0869565217391304,0.0612244897959184,0.16,0.590909090909091],[0.0434782608695652,0.142857142857143,0.32,0.545454545454545],[0.130434782608696,0.102040816326531,0.32,0.545454545454545],[0.0434782608695652,0.122448979591837,0.2,0.727272727272727],[0.130434782608696,0.142857142857143,0.32,0.772727272727273],[0.956521739130435,0.877551020408163,0.72,0.454545454545455],[1,0.938775510204081,0.68,0.545454545454545],[0.565217391304348,0.693877551020408,0.8,0.363636363636364],[0.608695652173913,0.795918367346939,0.92,0.409090909090909],[0.869565217391304,0.897959183673469,0.92,0.409090909090909],[0.869565217391304,1,1,0.363636363636364],[0.739130434782609,0.979591836734694,0.84,0.136363636363636],[0.739130434782609,0.918367346938775,0.76,0.363636363636364],[0.826086956521739,0.857142857142857,0.76,0.363636363636364],[0.391304347826087,0.612244897959184,0.56,0],[0.608695652173913,0.714285714285714,0.64,0],[0.391304347826087,0.469387755102041,0.16,0.0454545454545453],[0.695652173913043,0.714285714285714,0.12,0.136363636363636],[0.565217391304348,0.591836734693878,0.24,0.227272727272727],[0.521739130434783,0.612244897959184,0.36,0.136363636363636],[0.478260869565217,0.693877551020408,0.36,0.181818181818182],[0.521739130434783,0.653061224489796,0.4,0.227272727272727],[0.565217391304348,0.938775510204081,0.6,0.181818181818182],[0.782608695652174,0.836734693877551,0.48,0.227272727272727],[0.739130434782609,0.775510204081633,0.56,0.363636363636364],[0.652173913043478,0.714285714285714,0.56,0.545454545454545],[0.521739130434783,0.653061224489796,0.44,0.318181818181818],[0.478260869565217,0.755102040816326,0.6,0.272727272727273],[0.521739130434783,0.612244897959184,0.6,0.272727272727273],[0.608695652173913,0.714285714285714,0.56,0.318181818181818]],"x":[1,2,3,4],"y":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35],"text":[["row: 14<br>column: Petal.Width<br>value: 0.0434782608695652","row: 14<br>column: Petal.Length<br>value: 0.0816326530612245","row: 14<br>column: Sepal.Length<br>value: 0.36","row: 14<br>column: Sepal.Width<br>value: 0.909090909090909"],["row: 29<br>column: Petal.Width<br>value: 0.130434782608696","row: 29<br>column: Petal.Length<br>value: 0.102040816326531","row: 29<br>column: Sepal.Length<br>value: 0.44","row: 29<br>column: Sepal.Width<br>value: 1"],["row: 10<br>column: Petal.Width<br>value: 0.0434782608695652","row: 10<br>column: Petal.Length<br>value: 0","row: 10<br>column: Sepal.Length<br>value: 0","row: 10<br>column: Sepal.Width<br>value: 0.636363636363636"],["row: 7<br>column: Petal.Width<br>value: 0.0869565217391304","row: 7<br>column: Petal.Length<br>value: 0.0816326530612245","row: 7<br>column: Sepal.Length<br>value: 0","row: 7<br>column: Sepal.Width<br>value: 0.545454545454545"],["row: 21<br>column: Petal.Width<br>value: 0","row: 21<br>column: Petal.Length<br>value: 0.0816326530612245","row: 21<br>column: Sepal.Length<br>value: 0.12","row: 21<br>column: Sepal.Width<br>value: 0.636363636363636"],["row: 24<br>column: Petal.Width<br>value: 0.0869565217391304","row: 24<br>column: Petal.Length<br>value: 0.0612244897959184","row: 24<br>column: Sepal.Length<br>value: 0.16","row: 24<br>column: Sepal.Width<br>value: 0.590909090909091"],["row: 22<br>column: Petal.Width<br>value: 0.0434782608695652","row: 22<br>column: Petal.Length<br>value: 0.142857142857143","row: 22<br>column: Sepal.Length<br>value: 0.32","row: 22<br>column: Sepal.Width<br>value: 0.545454545454545"],["row: 5<br>column: Petal.Width<br>value: 0.130434782608696","row: 5<br>column: Petal.Length<br>value: 0.102040816326531","row: 5<br>column: Sepal.Length<br>value: 0.32","row: 5<br>column: Sepal.Width<br>value: 0.545454545454545"],["row: 25<br>column: Petal.Width<br>value: 0.0434782608695652","row: 25<br>column: Petal.Length<br>value: 0.122448979591837","row: 25<br>column: Sepal.Length<br>value: 0.2","row: 25<br>column: Sepal.Width<br>value: 0.727272727272727"],["row: 32<br>column: Petal.Width<br>value: 0.130434782608696","row: 32<br>column: Petal.Length<br>value: 0.142857142857143","row: 32<br>column: Sepal.Length<br>value: 0.32","row: 32<br>column: Sepal.Width<br>value: 0.772727272727273"],["row: 30<br>column: Petal.Width<br>value: 0.956521739130435","row: 30<br>column: Petal.Length<br>value: 0.877551020408163","row: 30<br>column: Sepal.Length<br>value: 0.72","row: 30<br>column: Sepal.Width<br>value: 0.454545454545455"],["row: 8<br>column: Petal.Width<br>value: 1","row: 8<br>column: Petal.Length<br>value: 0.938775510204081","row: 8<br>column: Sepal.Length<br>value: 0.68","row: 8<br>column: Sepal.Width<br>value: 0.545454545454545"],["row: 3<br>column: Petal.Width<br>value: 0.565217391304348","row: 3<br>column: Petal.Length<br>value: 0.693877551020408","row: 3<br>column: Sepal.Length<br>value: 0.8","row: 3<br>column: Sepal.Width<br>value: 0.363636363636364"],["row: 11<br>column: Petal.Width<br>value: 0.608695652173913","row: 11<br>column: Petal.Length<br>value: 0.795918367346939","row: 11<br>column: Sepal.Length<br>value: 0.92","row: 11<br>column: Sepal.Width<br>value: 0.409090909090909"],["row: 13<br>column: Petal.Width<br>value: 0.869565217391304","row: 13<br>column: Petal.Length<br>value: 0.897959183673469","row: 13<br>column: Sepal.Length<br>value: 0.92","row: 13<br>column: Sepal.Width<br>value: 0.409090909090909"],["row: 1<br>column: Petal.Width<br>value: 0.869565217391304","row: 1<br>column: Petal.Length<br>value: 1","row: 1<br>column: Sepal.Length<br>value: 1","row: 1<br>column: Sepal.Width<br>value: 0.363636363636364"],["row: 6<br>column: Petal.Width<br>value: 0.739130434782609","row: 6<br>column: Petal.Length<br>value: 0.979591836734694","row: 6<br>column: Sepal.Length<br>value: 0.84","row: 6<br>column: Sepal.Width<br>value: 0.136363636363636"],["row: 2<br>column: Petal.Width<br>value: 0.739130434782609","row: 2<br>column: Petal.Length<br>value: 0.918367346938775","row: 2<br>column: Sepal.Length<br>value: 0.76","row: 2<br>column: Sepal.Width<br>value: 0.363636363636364"],["row: 17<br>column: Petal.Width<br>value: 0.826086956521739","row: 17<br>column: Petal.Length<br>value: 0.857142857142857","row: 17<br>column: Sepal.Length<br>value: 0.76","row: 17<br>column: Sepal.Width<br>value: 0.363636363636364"],["row: 18<br>column: Petal.Width<br>value: 0.391304347826087","row: 18<br>column: Petal.Length<br>value: 0.612244897959184","row: 18<br>column: Sepal.Length<br>value: 0.56","row: 18<br>column: Sepal.Width<br>value: 0"],["row: 15<br>column: Petal.Width<br>value: 0.608695652173913","row: 15<br>column: Petal.Length<br>value: 0.714285714285714","row: 15<br>column: Sepal.Length<br>value: 0.64","row: 15<br>column: Sepal.Width<br>value: 0"],["row: 31<br>column: Petal.Width<br>value: 0.391304347826087","row: 31<br>column: Petal.Length<br>value: 0.469387755102041","row: 31<br>column: Sepal.Length<br>value: 0.16","row: 31<br>column: Sepal.Width<br>value: 0.0454545454545453"],["row: 33<br>column: Petal.Width<br>value: 0.695652173913043","row: 33<br>column: Petal.Length<br>value: 0.714285714285714","row: 33<br>column: Sepal.Length<br>value: 0.12","row: 33<br>column: Sepal.Width<br>value: 0.136363636363636"],["row: 27<br>column: Petal.Width<br>value: 0.565217391304348","row: 27<br>column: Petal.Length<br>value: 0.591836734693878","row: 27<br>column: Sepal.Length<br>value: 0.24","row: 27<br>column: Sepal.Width<br>value: 0.227272727272727"],["row: 26<br>column: Petal.Width<br>value: 0.521739130434783","row: 26<br>column: Petal.Length<br>value: 0.612244897959184","row: 26<br>column: Sepal.Length<br>value: 0.36","row: 26<br>column: Sepal.Width<br>value: 0.136363636363636"],["row: 20<br>column: Petal.Width<br>value: 0.478260869565217","row: 20<br>column: Petal.Length<br>value: 0.693877551020408","row: 20<br>column: Sepal.Length<br>value: 0.36","row: 20<br>column: Sepal.Width<br>value: 0.181818181818182"],["row: 28<br>column: Petal.Width<br>value: 0.521739130434783","row: 28<br>column: Petal.Length<br>value: 0.653061224489796","row: 28<br>column: Sepal.Length<br>value: 0.4","row: 28<br>column: Sepal.Width<br>value: 0.227272727272727"],["row: 12<br>column: Petal.Width<br>value: 0.565217391304348","row: 12<br>column: Petal.Length<br>value: 0.938775510204081","row: 12<br>column: Sepal.Length<br>value: 0.6","row: 12<br>column: Sepal.Width<br>value: 0.181818181818182"],["row: 4<br>column: Petal.Width<br>value: 0.782608695652174","row: 4<br>column: Petal.Length<br>value: 0.836734693877551","row: 4<br>column: Sepal.Length<br>value: 0.48","row: 4<br>column: Sepal.Width<br>value: 0.227272727272727"],["row: 34<br>column: Petal.Width<br>value: 0.739130434782609","row: 34<br>column: Petal.Length<br>value: 0.775510204081633","row: 34<br>column: Sepal.Length<br>value: 0.56","row: 34<br>column: Sepal.Width<br>value: 0.363636363636364"],["row: 35<br>column: Petal.Width<br>value: 0.652173913043478","row: 35<br>column: Petal.Length<br>value: 0.714285714285714","row: 35<br>column: Sepal.Length<br>value: 0.56","row: 35<br>column: Sepal.Width<br>value: 0.545454545454545"],["row: 19<br>column: Petal.Width<br>value: 0.521739130434783","row: 19<br>column: Petal.Length<br>value: 0.653061224489796","row: 19<br>column: Sepal.Length<br>value: 0.44","row: 19<br>column: Sepal.Width<br>value: 0.318181818181818"],["row: 9<br>column: Petal.Width<br>value: 0.478260869565217","row: 9<br>column: Petal.Length<br>value: 0.755102040816326","row: 9<br>column: Sepal.Length<br>value: 0.6","row: 9<br>column: Sepal.Width<br>value: 0.272727272727273"],["row: 16<br>column: Petal.Width<br>value: 0.521739130434783","row: 16<br>column: Petal.Length<br>value: 0.612244897959184","row: 16<br>column: Sepal.Length<br>value: 0.6","row: 16<br>column: Sepal.Width<br>value: 0.272727272727273"],["row: 23<br>column: Petal.Width<br>value: 0.608695652173913","row: 23<br>column: Petal.Length<br>value: 0.714285714285714","row: 23<br>column: Sepal.Length<br>value: 0.56","row: 23<br>column: Sepal.Width<br>value: 0.318181818181818"]],"showlegend":false,"hoverinfo":"text","type":"heatmap","xaxis":"x3","yaxis":"y2","frame":null}],"layout":{"xaxis":{"domain":[0,0.2],"automargin":true,"showticklabels":false,"showgrid":false,"zeroline":false,"anchor":"y2","title":"","range":[0,1.66036135374942],"linecolor":"#ffffff","autorange":"reversed"},"xaxis2":{"domain":[0.2,0.3],"automargin":true,"showticklabels":true,"showgrid":false,"zeroline":false,"anchor":"y2","tickfont":{"size":10},"tickangle":45,"tickvals":[1],"ticktext":["Species"],"linecolor":"#ffffff","range":[0.5,1.5],"title":[]},"xaxis3":{"domain":[0.3,1],"automargin":true,"title":"","range":[0.5,4.5],"linecolor":"#ffffff","showgrid":false,"anchor":"y2","tickfont":{"size":10},"tickangle":45,"tickvals":[1,2,3,4],"ticktext":["Petal.Width","Petal.Length","Sepal.Length","Sepal.Width"],"showticklabels":true},"yaxis2":{"domain":[0,0.8],"automargin":true,"tickfont":{"size":10},"tickangle":0,"tickvals":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35],"ticktext":["14","29","10","7","21","24","22","5","25","32","30","8","3","11","13","1","6","2","17","18","15","31","33","27","26","20","28","12","4","34","35","19","9","16","23"],"linecolor":"#ffffff","range":[0,35.5],"showticklabels":true,"title":"","anchor":"x3","showgrid":false,"side":"right"},"yaxis":{"domain":[0.8,1],"automargin":true,"title":"","range":[0,3.2063128140195],"linecolor":"#ffffff","showgrid":false,"anchor":"x","showticklabels":false,"zeroline":false},"annotations":[],"shapes":[],"images":[],"margin":{"b":72,"l":null,"t":0,"r":12},"hovermode":"closest","showlegend":true,"scene":{"zaxis":{"title":[]}},"title":"","legend":{"y":1,"yanchor":"top"}},"attrs":{"8c8f425044":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20]},"8c86d0e8eeb":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":{},"y":{},"xend":{},"yend":{},"type":"scatter","mode":"lines","color":{},"showlegend":false,"colors":"1","hoverinfo":"y","inherit":true},"8c856c91e3c":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":{},"y":{},"xend":{},"yend":{},"type":"scatter","mode":"lines","color":{},"showlegend":false,"colors":"1","hoverinfo":"x","inherit":true},"8c855c17278":{"z":[[1],[1],[1],[1],[1],[1],[1],[1],[1],[1],[3],[3],[2],[2],[3],[3],[3],[3],[3],[2],[2],[2],[3],[2],[2],[2],[2],[3],[3],[3],[2],[2],[2],[2],[2]],"x":1,"y":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35],"text":[["value: setosa<br>variable: Species<br>row: 14"],["value: setosa<br>variable: Species<br>row: 29"],["value: setosa<br>variable: Species<br>row: 10"],["value: setosa<br>variable: Species<br>row: 7"],["value: setosa<br>variable: Species<br>row: 21"],["value: setosa<br>variable: Species<br>row: 24"],["value: setosa<br>variable: Species<br>row: 22"],["value: setosa<br>variable: Species<br>row: 5"],["value: setosa<br>variable: Species<br>row: 25"],["value: setosa<br>variable: Species<br>row: 32"],["value: virginica<br>variable: Species<br>row: 30"],["value: virginica<br>variable: Species<br>row: 8"],["value: versicolor<br>variable: Species<br>row: 3"],["value: versicolor<br>variable: Species<br>row: 11"],["value: virginica<br>variable: Species<br>row: 13"],["value: virginica<br>variable: Species<br>row: 1"],["value: virginica<br>variable: Species<br>row: 6"],["value: virginica<br>variable: Species<br>row: 2"],["value: virginica<br>variable: Species<br>row: 17"],["value: versicolor<br>variable: Species<br>row: 18"],["value: versicolor<br>variable: Species<br>row: 15"],["value: versicolor<br>variable: Species<br>row: 31"],["value: virginica<br>variable: Species<br>row: 33"],["value: versicolor<br>variable: Species<br>row: 27"],["value: versicolor<br>variable: Species<br>row: 26"],["value: versicolor<br>variable: Species<br>row: 20"],["value: versicolor<br>variable: Species<br>row: 28"],["value: virginica<br>variable: Species<br>row: 12"],["value: virginica<br>variable: Species<br>row: 4"],["value: virginica<br>variable: Species<br>row: 34"],["value: versicolor<br>variable: Species<br>row: 35"],["value: versicolor<br>variable: Species<br>row: 19"],["value: versicolor<br>variable: Species<br>row: 9"],["value: versicolor<br>variable: Species<br>row: 16"],["value: versicolor<br>variable: Species<br>row: 23"]],"hoverinfo":"text","showlegend":false,"colorscale":[[0,"#A6CEE3"],[0.00334448160535117,"#A6CEE3"],[0.00668896321070234,"#A6CEE3"],[0.0100334448160535,"#A6CEE3"],[0.0133779264214047,"#A6CEE3"],[0.0167224080267559,"#A6CEE3"],[0.020066889632107,"#A6CEE3"],[0.0234113712374582,"#A6CEE3"],[0.0267558528428094,"#A6CEE3"],[0.0301003344481605,"#A6CEE3"],[0.0334448160535117,"#A6CEE3"],[0.0367892976588629,"#A6CEE3"],[0.040133779264214,"#A6CEE3"],[0.0434782608695652,"#A6CEE3"],[0.0468227424749164,"#A6CEE3"],[0.0501672240802676,"#A6CEE3"],[0.0535117056856187,"#A6CEE3"],[0.0568561872909699,"#A6CEE3"],[0.0602006688963211,"#A6CEE3"],[0.0635451505016722,"#A6CEE3"],[0.0668896321070234,"#A6CEE3"],[0.0702341137123746,"#A6CEE3"],[0.0735785953177257,"#A6CEE3"],[0.0769230769230769,"#A6CEE3"],[0.0802675585284281,"#A6CEE3"],[0.0836120401337793,"#A6CEE3"],[0.0869565217391304,"#A6CEE3"],[0.0903010033444816,"#A6CEE3"],[0.0936454849498328,"#A6CEE3"],[0.096989966555184,"#A6CEE3"],[0.100334448160535,"#A6CEE3"],[0.103678929765886,"#A6CEE3"],[0.107023411371237,"#A6CEE3"],[0.110367892976589,"#A6CEE3"],[0.11371237458194,"#A6CEE3"],[0.117056856187291,"#A6CEE3"],[0.120401337792642,"#A6CEE3"],[0.123745819397993,"#A6CEE3"],[0.127090301003344,"#A6CEE3"],[0.130434782608696,"#A6CEE3"],[0.133779264214047,"#A6CEE3"],[0.137123745819398,"#A6CEE3"],[0.140468227424749,"#A6CEE3"],[0.1438127090301,"#A6CEE3"],[0.147157190635451,"#A6CEE3"],[0.150501672240803,"#A6CEE3"],[0.153846153846154,"#A6CEE3"],[0.157190635451505,"#A6CEE3"],[0.160535117056856,"#A6CEE3"],[0.163879598662207,"#A6CEE3"],[0.167224080267559,"#A6CEE3"],[0.17056856187291,"#A6CEE3"],[0.173913043478261,"#A6CEE3"],[0.177257525083612,"#A6CEE3"],[0.180602006688963,"#A6CEE3"],[0.183946488294314,"#A6CEE3"],[0.187290969899666,"#A6CEE3"],[0.190635451505017,"#A6CEE3"],[0.193979933110368,"#A6CEE3"],[0.197324414715719,"#A6CEE3"],[0.20066889632107,"#A6CEE3"],[0.204013377926421,"#A6CEE3"],[0.207357859531773,"#A6CEE3"],[0.210702341137124,"#A6CEE3"],[0.214046822742475,"#A6CEE3"],[0.217391304347826,"#A6CEE3"],[0.220735785953177,"#A6CEE3"],[0.224080267558528,"#A6CEE3"],[0.22742474916388,"#A6CEE3"],[0.230769230769231,"#A6CEE3"],[0.234113712374582,"#A6CEE3"],[0.237458193979933,"#A6CEE3"],[0.240802675585284,"#A6CEE3"],[0.244147157190635,"#A6CEE3"],[0.247491638795987,"#A6CEE3"],[0.250836120401338,"#A6CEE3"],[0.254180602006689,"#A6CEE3"],[0.25752508361204,"#A6CEE3"],[0.260869565217391,"#A6CEE3"],[0.264214046822742,"#A6CEE3"],[0.267558528428094,"#A6CEE3"],[0.270903010033445,"#A6CEE3"],[0.274247491638796,"#A6CEE3"],[0.277591973244147,"#A6CEE3"],[0.280936454849498,"#A6CEE3"],[0.284280936454849,"#A6CEE3"],[0.287625418060201,"#A6CEE3"],[0.290969899665552,"#A6CEE3"],[0.294314381270903,"#A6CEE3"],[0.297658862876254,"#A6CEE3"],[0.301003344481605,"#A6CEE3"],[0.304347826086957,"#A6CEE3"],[0.307692307692308,"#A6CEE3"],[0.311036789297659,"#A6CEE3"],[0.31438127090301,"#A6CEE3"],[0.317725752508361,"#A6CEE3"],[0.321070234113712,"#A6CEE3"],[0.324414715719064,"#A6CEE3"],[0.327759197324415,"#A6CEE3"],[0.331103678929766,"#A6CEE3"],[0.334448160535117,"#1F78B4"],[0.337792642140468,"#1F78B4"],[0.341137123745819,"#1F78B4"],[0.344481605351171,"#1F78B4"],[0.347826086956522,"#1F78B4"],[0.351170568561873,"#1F78B4"],[0.354515050167224,"#1F78B4"],[0.357859531772575,"#1F78B4"],[0.361204013377926,"#1F78B4"],[0.364548494983278,"#1F78B4"],[0.367892976588629,"#1F78B4"],[0.37123745819398,"#1F78B4"],[0.374581939799331,"#1F78B4"],[0.377926421404682,"#1F78B4"],[0.381270903010033,"#1F78B4"],[0.384615384615385,"#1F78B4"],[0.387959866220736,"#1F78B4"],[0.391304347826087,"#1F78B4"],[0.394648829431438,"#1F78B4"],[0.397993311036789,"#1F78B4"],[0.40133779264214,"#1F78B4"],[0.404682274247492,"#1F78B4"],[0.408026755852843,"#1F78B4"],[0.411371237458194,"#1F78B4"],[0.414715719063545,"#1F78B4"],[0.418060200668896,"#1F78B4"],[0.421404682274247,"#1F78B4"],[0.424749163879599,"#1F78B4"],[0.42809364548495,"#1F78B4"],[0.431438127090301,"#1F78B4"],[0.434782608695652,"#1F78B4"],[0.438127090301003,"#1F78B4"],[0.441471571906354,"#1F78B4"],[0.444816053511706,"#1F78B4"],[0.448160535117057,"#1F78B4"],[0.451505016722408,"#1F78B4"],[0.454849498327759,"#1F78B4"],[0.45819397993311,"#1F78B4"],[0.461538461538462,"#1F78B4"],[0.464882943143813,"#1F78B4"],[0.468227424749164,"#1F78B4"],[0.471571906354515,"#1F78B4"],[0.474916387959866,"#1F78B4"],[0.478260869565217,"#1F78B4"],[0.481605351170569,"#1F78B4"],[0.48494983277592,"#1F78B4"],[0.488294314381271,"#1F78B4"],[0.491638795986622,"#1F78B4"],[0.494983277591973,"#1F78B4"],[0.498327759197324,"#1F78B4"],[0.501672240802676,"#1F78B4"],[0.505016722408027,"#1F78B4"],[0.508361204013378,"#1F78B4"],[0.511705685618729,"#1F78B4"],[0.51505016722408,"#1F78B4"],[0.518394648829431,"#1F78B4"],[0.521739130434783,"#1F78B4"],[0.525083612040134,"#1F78B4"],[0.528428093645485,"#1F78B4"],[0.531772575250836,"#1F78B4"],[0.535117056856187,"#1F78B4"],[0.538461538461538,"#1F78B4"],[0.54180602006689,"#1F78B4"],[0.545150501672241,"#1F78B4"],[0.548494983277592,"#1F78B4"],[0.551839464882943,"#1F78B4"],[0.555183946488294,"#1F78B4"],[0.558528428093645,"#1F78B4"],[0.561872909698997,"#1F78B4"],[0.565217391304348,"#1F78B4"],[0.568561872909699,"#1F78B4"],[0.57190635451505,"#1F78B4"],[0.575250836120401,"#1F78B4"],[0.578595317725752,"#1F78B4"],[0.581939799331104,"#1F78B4"],[0.585284280936455,"#1F78B4"],[0.588628762541806,"#1F78B4"],[0.591973244147157,"#1F78B4"],[0.595317725752508,"#1F78B4"],[0.598662207357859,"#1F78B4"],[0.602006688963211,"#1F78B4"],[0.605351170568562,"#1F78B4"],[0.608695652173913,"#1F78B4"],[0.612040133779264,"#1F78B4"],[0.615384615384615,"#1F78B4"],[0.618729096989967,"#1F78B4"],[0.622073578595318,"#1F78B4"],[0.625418060200669,"#1F78B4"],[0.62876254180602,"#1F78B4"],[0.632107023411371,"#1F78B4"],[0.635451505016722,"#1F78B4"],[0.638795986622074,"#1F78B4"],[0.642140468227425,"#1F78B4"],[0.645484949832776,"#1F78B4"],[0.648829431438127,"#1F78B4"],[0.652173913043478,"#1F78B4"],[0.655518394648829,"#1F78B4"],[0.658862876254181,"#1F78B4"],[0.662207357859532,"#1F78B4"],[0.665551839464883,"#1F78B4"],[0.668896321070234,"#B2DF8A"],[0.672240802675585,"#B2DF8A"],[0.675585284280936,"#B2DF8A"],[0.678929765886288,"#B2DF8A"],[0.682274247491639,"#B2DF8A"],[0.68561872909699,"#B2DF8A"],[0.688963210702341,"#B2DF8A"],[0.692307692307692,"#B2DF8A"],[0.695652173913043,"#B2DF8A"],[0.698996655518395,"#B2DF8A"],[0.702341137123746,"#B2DF8A"],[0.705685618729097,"#B2DF8A"],[0.709030100334448,"#B2DF8A"],[0.712374581939799,"#B2DF8A"],[0.71571906354515,"#B2DF8A"],[0.719063545150502,"#B2DF8A"],[0.722408026755853,"#B2DF8A"],[0.725752508361204,"#B2DF8A"],[0.729096989966555,"#B2DF8A"],[0.732441471571906,"#B2DF8A"],[0.735785953177257,"#B2DF8A"],[0.739130434782609,"#B2DF8A"],[0.74247491638796,"#B2DF8A"],[0.745819397993311,"#B2DF8A"],[0.749163879598662,"#B2DF8A"],[0.752508361204013,"#B2DF8A"],[0.755852842809364,"#B2DF8A"],[0.759197324414716,"#B2DF8A"],[0.762541806020067,"#B2DF8A"],[0.765886287625418,"#B2DF8A"],[0.769230769230769,"#B2DF8A"],[0.77257525083612,"#B2DF8A"],[0.775919732441472,"#B2DF8A"],[0.779264214046823,"#B2DF8A"],[0.782608695652174,"#B2DF8A"],[0.785953177257525,"#B2DF8A"],[0.789297658862876,"#B2DF8A"],[0.792642140468227,"#B2DF8A"],[0.795986622073579,"#B2DF8A"],[0.79933110367893,"#B2DF8A"],[0.802675585284281,"#B2DF8A"],[0.806020066889632,"#B2DF8A"],[0.809364548494983,"#B2DF8A"],[0.812709030100334,"#B2DF8A"],[0.816053511705686,"#B2DF8A"],[0.819397993311037,"#B2DF8A"],[0.822742474916388,"#B2DF8A"],[0.826086956521739,"#B2DF8A"],[0.82943143812709,"#B2DF8A"],[0.832775919732441,"#B2DF8A"],[0.836120401337793,"#B2DF8A"],[0.839464882943144,"#B2DF8A"],[0.842809364548495,"#B2DF8A"],[0.846153846153846,"#B2DF8A"],[0.849498327759197,"#B2DF8A"],[0.852842809364548,"#B2DF8A"],[0.8561872909699,"#B2DF8A"],[0.859531772575251,"#B2DF8A"],[0.862876254180602,"#B2DF8A"],[0.866220735785953,"#B2DF8A"],[0.869565217391304,"#B2DF8A"],[0.872909698996655,"#B2DF8A"],[0.876254180602007,"#B2DF8A"],[0.879598662207358,"#B2DF8A"],[0.882943143812709,"#B2DF8A"],[0.88628762541806,"#B2DF8A"],[0.889632107023411,"#B2DF8A"],[0.892976588628763,"#B2DF8A"],[0.896321070234114,"#B2DF8A"],[0.899665551839465,"#B2DF8A"],[0.903010033444816,"#B2DF8A"],[0.906354515050167,"#B2DF8A"],[0.909698996655518,"#B2DF8A"],[0.91304347826087,"#B2DF8A"],[0.916387959866221,"#B2DF8A"],[0.919732441471572,"#B2DF8A"],[0.923076923076923,"#B2DF8A"],[0.926421404682274,"#B2DF8A"],[0.929765886287625,"#B2DF8A"],[0.933110367892977,"#B2DF8A"],[0.936454849498328,"#B2DF8A"],[0.939799331103679,"#B2DF8A"],[0.94314381270903,"#B2DF8A"],[0.946488294314381,"#B2DF8A"],[0.949832775919732,"#B2DF8A"],[0.953177257525084,"#B2DF8A"],[0.956521739130435,"#B2DF8A"],[0.959866220735786,"#B2DF8A"],[0.963210702341137,"#B2DF8A"],[0.966555183946488,"#B2DF8A"],[0.969899665551839,"#B2DF8A"],[0.973244147157191,"#B2DF8A"],[0.976588628762542,"#B2DF8A"],[0.979933110367893,"#B2DF8A"],[0.983277591973244,"#B2DF8A"],[0.986622073578595,"#B2DF8A"],[0.989966555183946,"#B2DF8A"],[0.993311036789298,"#B2DF8A"],[0.996655518394649,"#B2DF8A"],[1,"#B2DF8A"]],"colorbar":{"title":"Species","tickmode":"array","tickvals":[1.33333333333333,2,2.66666666666667],"ticktext":["setosa","versicolor","virginica"],"len":0.3},"colors":["#A6CEE3","#1F78B4","#B2DF8A"],"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"heatmap"},"8c82de021a7":{"z":[[0.0434782608695652,0.0816326530612245,0.36,0.909090909090909],[0.130434782608696,0.102040816326531,0.44,1],[0.0434782608695652,0,0,0.636363636363636],[0.0869565217391304,0.0816326530612245,0,0.545454545454545],[0,0.0816326530612245,0.12,0.636363636363636],[0.0869565217391304,0.0612244897959184,0.16,0.590909090909091],[0.0434782608695652,0.142857142857143,0.32,0.545454545454545],[0.130434782608696,0.102040816326531,0.32,0.545454545454545],[0.0434782608695652,0.122448979591837,0.2,0.727272727272727],[0.130434782608696,0.142857142857143,0.32,0.772727272727273],[0.956521739130435,0.877551020408163,0.72,0.454545454545455],[1,0.938775510204081,0.68,0.545454545454545],[0.565217391304348,0.693877551020408,0.8,0.363636363636364],[0.608695652173913,0.795918367346939,0.92,0.409090909090909],[0.869565217391304,0.897959183673469,0.92,0.409090909090909],[0.869565217391304,1,1,0.363636363636364],[0.739130434782609,0.979591836734694,0.84,0.136363636363636],[0.739130434782609,0.918367346938775,0.76,0.363636363636364],[0.826086956521739,0.857142857142857,0.76,0.363636363636364],[0.391304347826087,0.612244897959184,0.56,0],[0.608695652173913,0.714285714285714,0.64,0],[0.391304347826087,0.469387755102041,0.16,0.0454545454545453],[0.695652173913043,0.714285714285714,0.12,0.136363636363636],[0.565217391304348,0.591836734693878,0.24,0.227272727272727],[0.521739130434783,0.612244897959184,0.36,0.136363636363636],[0.478260869565217,0.693877551020408,0.36,0.181818181818182],[0.521739130434783,0.653061224489796,0.4,0.227272727272727],[0.565217391304348,0.938775510204081,0.6,0.181818181818182],[0.782608695652174,0.836734693877551,0.48,0.227272727272727],[0.739130434782609,0.775510204081633,0.56,0.363636363636364],[0.652173913043478,0.714285714285714,0.56,0.545454545454545],[0.521739130434783,0.653061224489796,0.44,0.318181818181818],[0.478260869565217,0.755102040816326,0.6,0.272727272727273],[0.521739130434783,0.612244897959184,0.6,0.272727272727273],[0.608695652173913,0.714285714285714,0.56,0.318181818181818]],"x":[1,2,3,4],"y":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35],"text":[["row: 14<br>column: Petal.Width<br>value: 0.0434782608695652","row: 14<br>column: Petal.Length<br>value: 0.0816326530612245","row: 14<br>column: Sepal.Length<br>value: 0.36","row: 14<br>column: Sepal.Width<br>value: 0.909090909090909"],["row: 29<br>column: Petal.Width<br>value: 0.130434782608696","row: 29<br>column: Petal.Length<br>value: 0.102040816326531","row: 29<br>column: Sepal.Length<br>value: 0.44","row: 29<br>column: Sepal.Width<br>value: 1"],["row: 10<br>column: Petal.Width<br>value: 0.0434782608695652","row: 10<br>column: Petal.Length<br>value: 0","row: 10<br>column: Sepal.Length<br>value: 0","row: 10<br>column: Sepal.Width<br>value: 0.636363636363636"],["row: 7<br>column: Petal.Width<br>value: 0.0869565217391304","row: 7<br>column: Petal.Length<br>value: 0.0816326530612245","row: 7<br>column: Sepal.Length<br>value: 0","row: 7<br>column: Sepal.Width<br>value: 0.545454545454545"],["row: 21<br>column: Petal.Width<br>value: 0","row: 21<br>column: Petal.Length<br>value: 0.0816326530612245","row: 21<br>column: Sepal.Length<br>value: 0.12","row: 21<br>column: Sepal.Width<br>value: 0.636363636363636"],["row: 24<br>column: Petal.Width<br>value: 0.0869565217391304","row: 24<br>column: Petal.Length<br>value: 0.0612244897959184","row: 24<br>column: Sepal.Length<br>value: 0.16","row: 24<br>column: Sepal.Width<br>value: 0.590909090909091"],["row: 22<br>column: Petal.Width<br>value: 0.0434782608695652","row: 22<br>column: Petal.Length<br>value: 0.142857142857143","row: 22<br>column: Sepal.Length<br>value: 0.32","row: 22<br>column: Sepal.Width<br>value: 0.545454545454545"],["row: 5<br>column: Petal.Width<br>value: 0.130434782608696","row: 5<br>column: Petal.Length<br>value: 0.102040816326531","row: 5<br>column: Sepal.Length<br>value: 0.32","row: 5<br>column: Sepal.Width<br>value: 0.545454545454545"],["row: 25<br>column: Petal.Width<br>value: 0.0434782608695652","row: 25<br>column: Petal.Length<br>value: 0.122448979591837","row: 25<br>column: Sepal.Length<br>value: 0.2","row: 25<br>column: Sepal.Width<br>value: 0.727272727272727"],["row: 32<br>column: Petal.Width<br>value: 0.130434782608696","row: 32<br>column: Petal.Length<br>value: 0.142857142857143","row: 32<br>column: Sepal.Length<br>value: 0.32","row: 32<br>column: Sepal.Width<br>value: 0.772727272727273"],["row: 30<br>column: Petal.Width<br>value: 0.956521739130435","row: 30<br>column: Petal.Length<br>value: 0.877551020408163","row: 30<br>column: Sepal.Length<br>value: 0.72","row: 30<br>column: Sepal.Width<br>value: 0.454545454545455"],["row: 8<br>column: Petal.Width<br>value: 1","row: 8<br>column: Petal.Length<br>value: 0.938775510204081","row: 8<br>column: Sepal.Length<br>value: 0.68","row: 8<br>column: Sepal.Width<br>value: 0.545454545454545"],["row: 3<br>column: Petal.Width<br>value: 0.565217391304348","row: 3<br>column: Petal.Length<br>value: 0.693877551020408","row: 3<br>column: Sepal.Length<br>value: 0.8","row: 3<br>column: Sepal.Width<br>value: 0.363636363636364"],["row: 11<br>column: Petal.Width<br>value: 0.608695652173913","row: 11<br>column: Petal.Length<br>value: 0.795918367346939","row: 11<br>column: Sepal.Length<br>value: 0.92","row: 11<br>column: Sepal.Width<br>value: 0.409090909090909"],["row: 13<br>column: Petal.Width<br>value: 0.869565217391304","row: 13<br>column: Petal.Length<br>value: 0.897959183673469","row: 13<br>column: Sepal.Length<br>value: 0.92","row: 13<br>column: Sepal.Width<br>value: 0.409090909090909"],["row: 1<br>column: Petal.Width<br>value: 0.869565217391304","row: 1<br>column: Petal.Length<br>value: 1","row: 1<br>column: Sepal.Length<br>value: 1","row: 1<br>column: Sepal.Width<br>value: 0.363636363636364"],["row: 6<br>column: Petal.Width<br>value: 0.739130434782609","row: 6<br>column: Petal.Length<br>value: 0.979591836734694","row: 6<br>column: Sepal.Length<br>value: 0.84","row: 6<br>column: Sepal.Width<br>value: 0.136363636363636"],["row: 2<br>column: Petal.Width<br>value: 0.739130434782609","row: 2<br>column: Petal.Length<br>value: 0.918367346938775","row: 2<br>column: Sepal.Length<br>value: 0.76","row: 2<br>column: Sepal.Width<br>value: 0.363636363636364"],["row: 17<br>column: Petal.Width<br>value: 0.826086956521739","row: 17<br>column: Petal.Length<br>value: 0.857142857142857","row: 17<br>column: Sepal.Length<br>value: 0.76","row: 17<br>column: Sepal.Width<br>value: 0.363636363636364"],["row: 18<br>column: Petal.Width<br>value: 0.391304347826087","row: 18<br>column: Petal.Length<br>value: 0.612244897959184","row: 18<br>column: Sepal.Length<br>value: 0.56","row: 18<br>column: Sepal.Width<br>value: 0"],["row: 15<br>column: Petal.Width<br>value: 0.608695652173913","row: 15<br>column: Petal.Length<br>value: 0.714285714285714","row: 15<br>column: Sepal.Length<br>value: 0.64","row: 15<br>column: Sepal.Width<br>value: 0"],["row: 31<br>column: Petal.Width<br>value: 0.391304347826087","row: 31<br>column: Petal.Length<br>value: 0.469387755102041","row: 31<br>column: Sepal.Length<br>value: 0.16","row: 31<br>column: Sepal.Width<br>value: 0.0454545454545453"],["row: 33<br>column: Petal.Width<br>value: 0.695652173913043","row: 33<br>column: Petal.Length<br>value: 0.714285714285714","row: 33<br>column: Sepal.Length<br>value: 0.12","row: 33<br>column: Sepal.Width<br>value: 0.136363636363636"],["row: 27<br>column: Petal.Width<br>value: 0.565217391304348","row: 27<br>column: Petal.Length<br>value: 0.591836734693878","row: 27<br>column: Sepal.Length<br>value: 0.24","row: 27<br>column: Sepal.Width<br>value: 0.227272727272727"],["row: 26<br>column: Petal.Width<br>value: 0.521739130434783","row: 26<br>column: Petal.Length<br>value: 0.612244897959184","row: 26<br>column: Sepal.Length<br>value: 0.36","row: 26<br>column: Sepal.Width<br>value: 0.136363636363636"],["row: 20<br>column: Petal.Width<br>value: 0.478260869565217","row: 20<br>column: Petal.Length<br>value: 0.693877551020408","row: 20<br>column: Sepal.Length<br>value: 0.36","row: 20<br>column: Sepal.Width<br>value: 0.181818181818182"],["row: 28<br>column: Petal.Width<br>value: 0.521739130434783","row: 28<br>column: Petal.Length<br>value: 0.653061224489796","row: 28<br>column: Sepal.Length<br>value: 0.4","row: 28<br>column: Sepal.Width<br>value: 0.227272727272727"],["row: 12<br>column: Petal.Width<br>value: 0.565217391304348","row: 12<br>column: Petal.Length<br>value: 0.938775510204081","row: 12<br>column: Sepal.Length<br>value: 0.6","row: 12<br>column: Sepal.Width<br>value: 0.181818181818182"],["row: 4<br>column: Petal.Width<br>value: 0.782608695652174","row: 4<br>column: Petal.Length<br>value: 0.836734693877551","row: 4<br>column: Sepal.Length<br>value: 0.48","row: 4<br>column: Sepal.Width<br>value: 0.227272727272727"],["row: 34<br>column: Petal.Width<br>value: 0.739130434782609","row: 34<br>column: Petal.Length<br>value: 0.775510204081633","row: 34<br>column: Sepal.Length<br>value: 0.56","row: 34<br>column: Sepal.Width<br>value: 0.363636363636364"],["row: 35<br>column: Petal.Width<br>value: 0.652173913043478","row: 35<br>column: Petal.Length<br>value: 0.714285714285714","row: 35<br>column: Sepal.Length<br>value: 0.56","row: 35<br>column: Sepal.Width<br>value: 0.545454545454545"],["row: 19<br>column: Petal.Width<br>value: 0.521739130434783","row: 19<br>column: Petal.Length<br>value: 0.653061224489796","row: 19<br>column: Sepal.Length<br>value: 0.44","row: 19<br>column: Sepal.Width<br>value: 0.318181818181818"],["row: 9<br>column: Petal.Width<br>value: 0.478260869565217","row: 9<br>column: Petal.Length<br>value: 0.755102040816326","row: 9<br>column: Sepal.Length<br>value: 0.6","row: 9<br>column: Sepal.Width<br>value: 0.272727272727273"],["row: 16<br>column: Petal.Width<br>value: 0.521739130434783","row: 16<br>column: Petal.Length<br>value: 0.612244897959184","row: 16<br>column: Sepal.Length<br>value: 0.6","row: 16<br>column: Sepal.Width<br>value: 0.272727272727273"],["row: 23<br>column: Petal.Width<br>value: 0.608695652173913","row: 23<br>column: Petal.Length<br>value: 0.714285714285714","row: 23<br>column: Sepal.Length<br>value: 0.56","row: 23<br>column: Sepal.Width<br>value: 0.318181818181818"]],"showlegend":false,"hoverinfo":"text","zmin":null,"zmax":null,"colors":["#440154FF","#440256FF","#450457FF","#450559FF","#46075AFF","#46085CFF","#460A5DFF","#460B5EFF","#470D60FF","#470E61FF","#471063FF","#471164FF","#471365FF","#481467FF","#481668FF","#481769FF","#48186AFF","#481A6CFF","#481B6DFF","#481C6EFF","#481D6FFF","#481F70FF","#482071FF","#482173FF","#482374FF","#482475FF","#482576FF","#482677FF","#482878FF","#482979FF","#472A7AFF","#472C7AFF","#472D7BFF","#472E7CFF","#472F7DFF","#46307EFF","#46327EFF","#46337FFF","#463480FF","#453581FF","#453781FF","#453882FF","#443983FF","#443A83FF","#443B84FF","#433D84FF","#433E85FF","#423F85FF","#424086FF","#424186FF","#414287FF","#414487FF","#404588FF","#404688FF","#3F4788FF","#3F4889FF","#3E4989FF","#3E4A89FF","#3E4C8AFF","#3D4D8AFF","#3D4E8AFF","#3C4F8AFF","#3C508BFF","#3B518BFF","#3B528BFF","#3A538BFF","#3A548CFF","#39558CFF","#39568CFF","#38588CFF","#38598CFF","#375A8CFF","#375B8DFF","#365C8DFF","#365D8DFF","#355E8DFF","#355F8DFF","#34608DFF","#34618DFF","#33628DFF","#33638DFF","#32648EFF","#32658EFF","#31668EFF","#31678EFF","#31688EFF","#30698EFF","#306A8EFF","#2F6B8EFF","#2F6C8EFF","#2E6D8EFF","#2E6E8EFF","#2E6F8EFF","#2D708EFF","#2D718EFF","#2C718EFF","#2C728EFF","#2C738EFF","#2B748EFF","#2B758EFF","#2A768EFF","#2A778EFF","#2A788EFF","#29798EFF","#297A8EFF","#297B8EFF","#287C8EFF","#287D8EFF","#277E8EFF","#277F8EFF","#27808EFF","#26818EFF","#26828EFF","#26828EFF","#25838EFF","#25848EFF","#25858EFF","#24868EFF","#24878EFF","#23888EFF","#23898EFF","#238A8DFF","#228B8DFF","#228C8DFF","#228D8DFF","#218E8DFF","#218F8DFF","#21908DFF","#21918CFF","#20928CFF","#20928CFF","#20938CFF","#1F948CFF","#1F958BFF","#1F968BFF","#1F978BFF","#1F988BFF","#1F998AFF","#1F9A8AFF","#1E9B8AFF","#1E9C89FF","#1E9D89FF","#1F9E89FF","#1F9F88FF","#1FA088FF","#1FA188FF","#1FA187FF","#1FA287FF","#20A386FF","#20A486FF","#21A585FF","#21A685FF","#22A785FF","#22A884FF","#23A983FF","#24AA83FF","#25AB82FF","#25AC82FF","#26AD81FF","#27AD81FF","#28AE80FF","#29AF7FFF","#2AB07FFF","#2CB17EFF","#2DB27DFF","#2EB37CFF","#2FB47CFF","#31B57BFF","#32B67AFF","#34B679FF","#35B779FF","#37B878FF","#38B977FF","#3ABA76FF","#3BBB75FF","#3DBC74FF","#3FBC73FF","#40BD72FF","#42BE71FF","#44BF70FF","#46C06FFF","#48C16EFF","#4AC16DFF","#4CC26CFF","#4EC36BFF","#50C46AFF","#52C569FF","#54C568FF","#56C667FF","#58C765FF","#5AC864FF","#5CC863FF","#5EC962FF","#60CA60FF","#63CB5FFF","#65CB5EFF","#67CC5CFF","#69CD5BFF","#6CCD5AFF","#6ECE58FF","#70CF57FF","#73D056FF","#75D054FF","#77D153FF","#7AD151FF","#7CD250FF","#7FD34EFF","#81D34DFF","#84D44BFF","#86D549FF","#89D548FF","#8BD646FF","#8ED645FF","#90D743FF","#93D741FF","#95D840FF","#98D83EFF","#9BD93CFF","#9DD93BFF","#A0DA39FF","#A2DA37FF","#A5DB36FF","#A8DB34FF","#AADC32FF","#ADDC30FF","#B0DD2FFF","#B2DD2DFF","#B5DE2BFF","#B8DE29FF","#BADE28FF","#BDDF26FF","#C0DF25FF","#C2DF23FF","#C5E021FF","#C8E020FF","#CAE11FFF","#CDE11DFF","#D0E11CFF","#D2E21BFF","#D5E21AFF","#D8E219FF","#DAE319FF","#DDE318FF","#DFE318FF","#E2E418FF","#E5E419FF","#E7E419FF","#EAE51AFF","#ECE51BFF","#EFE51CFF","#F1E51DFF","#F4E61EFF","#F6E620FF","#F8E621FF","#FBE723FF","#FDE725FF"],"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"heatmap"}},"source":"A","config":{"showSendToCloud":false,"displaylogo":false,"modeBarButtonsToRemove":["sendDataToCloud","select2d","lasso2d","autoScale2d","hoverClosestCartesian","hoverCompareCartesian","sendDataToCloud"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"subplot":true,"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>


---

# Visualizaci√≥n previa

Con `seriate = ...` podemos cambiar el m√©todo de ordenaci√≥n para una mejor visualizaci√≥n


```r
heatmaply(iris_range,
          seriate = "OLO",
          row_dend_left = TRUE,
          plot_method = "plotly")
```

---

# Visualizaci√≥n previa

<div id="htmlwidget-ed18d622a76f1d8b9e78" style="width:100%;height:840px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-ed18d622a76f1d8b9e78">{"x":{"data":[{"type":"scatter","mode":"markers","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"type":"scatter","mode":"markers","marker":{"color":"rgba(255,127,14,1)","line":{"color":"rgba(255,127,14,1)"}},"error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"line":{"color":"rgba(255,127,14,1)"},"xaxis":"x2","yaxis":"y","frame":null},{"x":[1.875,1,null,1,1,null,1.875,2.75,null,2.75,2.75,null,2.75,2,null,2,2,null,2.75,3.5,null,3.5,3.5,null,3.5,3,null,3,3,null,3.5,4,null,4,4],"y":[3.2063128140195,3.2063128140195,null,3.2063128140195,0,null,3.2063128140195,3.2063128140195,null,3.2063128140195,1.3132283742805,null,1.3132283742805,1.3132283742805,null,1.3132283742805,0,null,1.3132283742805,1.3132283742805,null,1.3132283742805,0.773840891378614,null,0.773840891378614,0.773840891378614,null,0.773840891378614,0,null,0.773840891378614,0.773840891378614,null,0.773840891378614,0],"type":"scatter","mode":"lines","showlegend":false,"hoverinfo":["y","y",null,"y","y",null,"y","y",null,"y","y",null,"y","y",null,"y","y",null,"y","y",null,"y","y",null,"y","y",null,"y","y",null,"y","y",null,"y","y"],"name":"1","marker":{"color":"rgba(0,0,0,1)","line":{"color":"rgba(0,0,0,1)"}},"textfont":{"color":"rgba(0,0,0,1)"},"error_y":{"color":"rgba(0,0,0,1)"},"error_x":{"color":"rgba(0,0,0,1)"},"line":{"color":"rgba(0,0,0,1)"},"xaxis":"x3","yaxis":"y","frame":null},{"x":[1.66036135374942,1.66036135374942,null,1.66036135374942,0.634443395855012,null,0.634443395855012,0.634443395855012,null,0.634443395855012,0.150473893452481,null,0.150473893452481,0.150473893452481,null,0.150473893452481,0,null,0.150473893452481,0.150473893452481,null,0.150473893452481,0,null,0.634443395855012,0.634443395855012,null,0.634443395855012,0.399614426517607,null,0.399614426517607,0.399614426517607,null,0.399614426517607,0.243339945826721,null,0.243339945826721,0.243339945826721,null,0.243339945826721,0.156345916170876,null,0.156345916170876,0.156345916170876,null,0.156345916170876,0,null,0.156345916170876,0.156345916170876,null,0.156345916170876,0,null,0.243339945826721,0.243339945826721,null,0.243339945826721,0.0960594044558961,null,0.0960594044558961,0.0960594044558961,null,0.0960594044558961,0,null,0.0960594044558961,0.0960594044558961,null,0.0960594044558961,0,null,0.399614426517607,0.399614426517607,null,0.399614426517607,0.182496337008423,null,0.182496337008423,0.182496337008423,null,0.182496337008423,0.107907578525841,null,0.107907578525841,0.107907578525841,null,0.107907578525841,0,null,0.107907578525841,0.107907578525841,null,0.107907578525841,0,null,0.182496337008423,0.182496337008423,null,0.182496337008423,0.129686977079326,null,0.129686977079326,0.129686977079326,null,0.129686977079326,0,null,0.129686977079326,0.129686977079326,null,0.129686977079326,0,null,1.66036135374942,1.66036135374942,null,1.66036135374942,1.14765956764818,null,1.14765956764818,1.14765956764818,null,1.14765956764818,0.73350387897341,null,0.73350387897341,0.73350387897341,null,0.73350387897341,0.582837975187665,null,0.582837975187665,0.582837975187665,null,0.582837975187665,0.403072043766498,null,0.403072043766498,0.403072043766498,null,0.403072043766498,0,null,0.403072043766498,0.403072043766498,null,0.403072043766498,0.347359536579261,null,0.347359536579261,0.347359536579261,null,0.347359536579261,0,null,0.347359536579261,0.347359536579261,null,0.347359536579261,0.18557984958511,null,0.18557984958511,0.18557984958511,null,0.18557984958511,0,null,0.18557984958511,0.18557984958511,null,0.18557984958511,0.107379864599332,null,0.107379864599332,0.107379864599332,null,0.107379864599332,0.084984983274546,null,0.084984983274546,0.084984983274546,null,0.084984983274546,0,null,0.084984983274546,0.084984983274546,null,0.084984983274546,0,null,0.107379864599332,0.107379864599332,null,0.107379864599332,0,null,0.582837975187665,0.582837975187665,null,0.582837975187665,0.253123107208002,null,0.253123107208002,0.253123107208002,null,0.253123107208002,0,null,0.253123107208002,0.253123107208002,null,0.253123107208002,0,null,0.73350387897341,0.73350387897341,null,0.73350387897341,0.437936650787663,null,0.437936650787663,0.437936650787663,null,0.437936650787663,0.302587438792158,null,0.302587438792158,0.302587438792158,null,0.302587438792158,0,null,0.302587438792158,0.302587438792158,null,0.302587438792158,0.175025251439118,null,0.175025251439118,0.175025251439118,null,0.175025251439118,0,null,0.175025251439118,0.175025251439118,null,0.175025251439118,0,null,0.437936650787663,0.437936650787663,null,0.437936650787663,0.32846900080918,null,0.32846900080918,0.32846900080918,null,0.32846900080918,0,null,0.32846900080918,0.32846900080918,null,0.32846900080918,0.199921992455322,null,0.199921992455322,0.199921992455322,null,0.199921992455322,0,null,0.199921992455322,0.199921992455322,null,0.199921992455322,0.149483513231763,null,0.149483513231763,0.149483513231763,null,0.149483513231763,0.147104998460392,null,0.147104998460392,0.147104998460392,null,0.147104998460392,0,null,0.147104998460392,0.147104998460392,null,0.147104998460392,0,null,0.149483513231763,0.149483513231763,null,0.149483513231763,0,null,1.14765956764818,1.14765956764818,null,1.14765956764818,0.544489465900116,null,0.544489465900116,0.544489465900116,null,0.544489465900116,0.475750515515348,null,0.475750515515348,0.475750515515348,null,0.475750515515348,0.169613687735708,null,0.169613687735708,0.169613687735708,null,0.169613687735708,0,null,0.169613687735708,0.169613687735708,null,0.169613687735708,0,null,0.475750515515348,0.475750515515348,null,0.475750515515348,0.323198526991148,null,0.323198526991148,0.323198526991148,null,0.323198526991148,0.137398849700658,null,0.137398849700658,0.137398849700658,null,0.137398849700658,0,null,0.137398849700658,0.137398849700658,null,0.137398849700658,0,null,0.323198526991148,0.323198526991148,null,0.323198526991148,0.283915624504946,null,0.283915624504946,0.283915624504946,null,0.283915624504946,0,null,0.283915624504946,0.283915624504946,null,0.283915624504946,0.106347895248276,null,0.106347895248276,0.106347895248276,null,0.106347895248276,0,null,0.106347895248276,0.106347895248276,null,0.106347895248276,0,null,0.544489465900116,0.544489465900116,null,0.544489465900116,0.12451208828435,null,0.12451208828435,0.12451208828435,null,0.12451208828435,0,null,0.12451208828435,0.12451208828435,null,0.12451208828435,0],"y":[14.466796875,4,null,4,4,null,4,1.5,null,1.5,1.5,null,1.5,1,null,1,1,null,1.5,2,null,2,2,null,4,6.5,null,6.5,6.5,null,6.5,4.5,null,4.5,4.5,null,4.5,3.5,null,3.5,3.5,null,3.5,3,null,3,3,null,3.5,4,null,4,4,null,4.5,5.5,null,5.5,5.5,null,5.5,5,null,5,5,null,5.5,6,null,6,6,null,6.5,8.5,null,8.5,8.5,null,8.5,7.5,null,7.5,7.5,null,7.5,7,null,7,7,null,7.5,8,null,8,8,null,8.5,9.5,null,9.5,9.5,null,9.5,9,null,9,9,null,9.5,10,null,10,10,null,14.466796875,24.93359375,null,24.93359375,24.93359375,null,24.93359375,18.0859375,null,18.0859375,18.0859375,null,18.0859375,14.765625,null,14.765625,14.765625,null,14.765625,12.03125,null,12.03125,12.03125,null,12.03125,11,null,11,11,null,12.03125,13.0625,null,13.0625,13.0625,null,13.0625,12,null,12,12,null,13.0625,14.125,null,14.125,14.125,null,14.125,13,null,13,13,null,14.125,15.25,null,15.25,15.25,null,15.25,14.5,null,14.5,14.5,null,14.5,14,null,14,14,null,14.5,15,null,15,15,null,15.25,16,null,16,16,null,14.765625,17.5,null,17.5,17.5,null,17.5,17,null,17,17,null,17.5,18,null,18,18,null,18.0859375,21.40625,null,21.40625,21.40625,null,21.40625,19.75,null,19.75,19.75,null,19.75,19,null,19,19,null,19.75,20.5,null,20.5,20.5,null,20.5,20,null,20,20,null,20.5,21,null,21,21,null,21.40625,23.0625,null,23.0625,23.0625,null,23.0625,22,null,22,22,null,23.0625,24.125,null,24.125,24.125,null,24.125,23,null,23,23,null,24.125,25.25,null,25.25,25.25,null,25.25,24.5,null,24.5,24.5,null,24.5,24,null,24,24,null,24.5,25,null,25,25,null,25.25,26,null,26,26,null,24.93359375,31.78125,null,31.78125,31.78125,null,31.78125,29.0625,null,29.0625,29.0625,null,29.0625,27.5,null,27.5,27.5,null,27.5,27,null,27,27,null,27.5,28,null,28,28,null,29.0625,30.625,null,30.625,30.625,null,30.625,29.5,null,29.5,29.5,null,29.5,29,null,29,29,null,29.5,30,null,30,30,null,30.625,31.75,null,31.75,31.75,null,31.75,31,null,31,31,null,31.75,32.5,null,32.5,32.5,null,32.5,32,null,32,32,null,32.5,33,null,33,33,null,31.78125,34.5,null,34.5,34.5,null,34.5,34,null,34,34,null,34.5,35,null,35,35],"type":"scatter","mode":"lines","showlegend":false,"hoverinfo":["x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x"],"name":"1","marker":{"color":"rgba(0,0,0,1)","line":{"color":"rgba(0,0,0,1)"}},"textfont":{"color":"rgba(0,0,0,1)"},"error_y":{"color":"rgba(0,0,0,1)"},"error_x":{"color":"rgba(0,0,0,1)"},"line":{"color":"rgba(0,0,0,1)"},"xaxis":"x","yaxis":"y2","frame":null},{"colorbar":{"title":"Species","ticklen":2,"tickmode":"array","tickvals":[1.33333333333333,2,2.66666666666667],"ticktext":["setosa","versicolor","virginica"],"len":0.3,"lenmode":"fraction","y":1,"yanchor":"top"},"colorscale":[[0,"#A6CEE3"],[0.00334448160535117,"#A6CEE3"],[0.00668896321070234,"#A6CEE3"],[0.0100334448160535,"#A6CEE3"],[0.0133779264214047,"#A6CEE3"],[0.0167224080267559,"#A6CEE3"],[0.020066889632107,"#A6CEE3"],[0.0234113712374582,"#A6CEE3"],[0.0267558528428094,"#A6CEE3"],[0.0301003344481605,"#A6CEE3"],[0.0334448160535117,"#A6CEE3"],[0.0367892976588629,"#A6CEE3"],[0.040133779264214,"#A6CEE3"],[0.0434782608695652,"#A6CEE3"],[0.0468227424749164,"#A6CEE3"],[0.0501672240802676,"#A6CEE3"],[0.0535117056856187,"#A6CEE3"],[0.0568561872909699,"#A6CEE3"],[0.0602006688963211,"#A6CEE3"],[0.0635451505016722,"#A6CEE3"],[0.0668896321070234,"#A6CEE3"],[0.0702341137123746,"#A6CEE3"],[0.0735785953177257,"#A6CEE3"],[0.0769230769230769,"#A6CEE3"],[0.0802675585284281,"#A6CEE3"],[0.0836120401337793,"#A6CEE3"],[0.0869565217391304,"#A6CEE3"],[0.0903010033444816,"#A6CEE3"],[0.0936454849498328,"#A6CEE3"],[0.096989966555184,"#A6CEE3"],[0.100334448160535,"#A6CEE3"],[0.103678929765886,"#A6CEE3"],[0.107023411371237,"#A6CEE3"],[0.110367892976589,"#A6CEE3"],[0.11371237458194,"#A6CEE3"],[0.117056856187291,"#A6CEE3"],[0.120401337792642,"#A6CEE3"],[0.123745819397993,"#A6CEE3"],[0.127090301003344,"#A6CEE3"],[0.130434782608696,"#A6CEE3"],[0.133779264214047,"#A6CEE3"],[0.137123745819398,"#A6CEE3"],[0.140468227424749,"#A6CEE3"],[0.1438127090301,"#A6CEE3"],[0.147157190635451,"#A6CEE3"],[0.150501672240803,"#A6CEE3"],[0.153846153846154,"#A6CEE3"],[0.157190635451505,"#A6CEE3"],[0.160535117056856,"#A6CEE3"],[0.163879598662207,"#A6CEE3"],[0.167224080267559,"#A6CEE3"],[0.17056856187291,"#A6CEE3"],[0.173913043478261,"#A6CEE3"],[0.177257525083612,"#A6CEE3"],[0.180602006688963,"#A6CEE3"],[0.183946488294314,"#A6CEE3"],[0.187290969899666,"#A6CEE3"],[0.190635451505017,"#A6CEE3"],[0.193979933110368,"#A6CEE3"],[0.197324414715719,"#A6CEE3"],[0.20066889632107,"#A6CEE3"],[0.204013377926421,"#A6CEE3"],[0.207357859531773,"#A6CEE3"],[0.210702341137124,"#A6CEE3"],[0.214046822742475,"#A6CEE3"],[0.217391304347826,"#A6CEE3"],[0.220735785953177,"#A6CEE3"],[0.224080267558528,"#A6CEE3"],[0.22742474916388,"#A6CEE3"],[0.230769230769231,"#A6CEE3"],[0.234113712374582,"#A6CEE3"],[0.237458193979933,"#A6CEE3"],[0.240802675585284,"#A6CEE3"],[0.244147157190635,"#A6CEE3"],[0.247491638795987,"#A6CEE3"],[0.250836120401338,"#A6CEE3"],[0.254180602006689,"#A6CEE3"],[0.25752508361204,"#A6CEE3"],[0.260869565217391,"#A6CEE3"],[0.264214046822742,"#A6CEE3"],[0.267558528428094,"#A6CEE3"],[0.270903010033445,"#A6CEE3"],[0.274247491638796,"#A6CEE3"],[0.277591973244147,"#A6CEE3"],[0.280936454849498,"#A6CEE3"],[0.284280936454849,"#A6CEE3"],[0.287625418060201,"#A6CEE3"],[0.290969899665552,"#A6CEE3"],[0.294314381270903,"#A6CEE3"],[0.297658862876254,"#A6CEE3"],[0.301003344481605,"#A6CEE3"],[0.304347826086957,"#A6CEE3"],[0.307692307692308,"#A6CEE3"],[0.311036789297659,"#A6CEE3"],[0.31438127090301,"#A6CEE3"],[0.317725752508361,"#A6CEE3"],[0.321070234113712,"#A6CEE3"],[0.324414715719064,"#A6CEE3"],[0.327759197324415,"#A6CEE3"],[0.331103678929766,"#A6CEE3"],[0.334448160535117,"#1F78B4"],[0.337792642140468,"#1F78B4"],[0.341137123745819,"#1F78B4"],[0.344481605351171,"#1F78B4"],[0.347826086956522,"#1F78B4"],[0.351170568561873,"#1F78B4"],[0.354515050167224,"#1F78B4"],[0.357859531772575,"#1F78B4"],[0.361204013377926,"#1F78B4"],[0.364548494983278,"#1F78B4"],[0.367892976588629,"#1F78B4"],[0.37123745819398,"#1F78B4"],[0.374581939799331,"#1F78B4"],[0.377926421404682,"#1F78B4"],[0.381270903010033,"#1F78B4"],[0.384615384615385,"#1F78B4"],[0.387959866220736,"#1F78B4"],[0.391304347826087,"#1F78B4"],[0.394648829431438,"#1F78B4"],[0.397993311036789,"#1F78B4"],[0.40133779264214,"#1F78B4"],[0.404682274247492,"#1F78B4"],[0.408026755852843,"#1F78B4"],[0.411371237458194,"#1F78B4"],[0.414715719063545,"#1F78B4"],[0.418060200668896,"#1F78B4"],[0.421404682274247,"#1F78B4"],[0.424749163879599,"#1F78B4"],[0.42809364548495,"#1F78B4"],[0.431438127090301,"#1F78B4"],[0.434782608695652,"#1F78B4"],[0.438127090301003,"#1F78B4"],[0.441471571906354,"#1F78B4"],[0.444816053511706,"#1F78B4"],[0.448160535117057,"#1F78B4"],[0.451505016722408,"#1F78B4"],[0.454849498327759,"#1F78B4"],[0.45819397993311,"#1F78B4"],[0.461538461538462,"#1F78B4"],[0.464882943143813,"#1F78B4"],[0.468227424749164,"#1F78B4"],[0.471571906354515,"#1F78B4"],[0.474916387959866,"#1F78B4"],[0.478260869565217,"#1F78B4"],[0.481605351170569,"#1F78B4"],[0.48494983277592,"#1F78B4"],[0.488294314381271,"#1F78B4"],[0.491638795986622,"#1F78B4"],[0.494983277591973,"#1F78B4"],[0.498327759197324,"#1F78B4"],[0.501672240802676,"#1F78B4"],[0.505016722408027,"#1F78B4"],[0.508361204013378,"#1F78B4"],[0.511705685618729,"#1F78B4"],[0.51505016722408,"#1F78B4"],[0.518394648829431,"#1F78B4"],[0.521739130434783,"#1F78B4"],[0.525083612040134,"#1F78B4"],[0.528428093645485,"#1F78B4"],[0.531772575250836,"#1F78B4"],[0.535117056856187,"#1F78B4"],[0.538461538461538,"#1F78B4"],[0.54180602006689,"#1F78B4"],[0.545150501672241,"#1F78B4"],[0.548494983277592,"#1F78B4"],[0.551839464882943,"#1F78B4"],[0.555183946488294,"#1F78B4"],[0.558528428093645,"#1F78B4"],[0.561872909698997,"#1F78B4"],[0.565217391304348,"#1F78B4"],[0.568561872909699,"#1F78B4"],[0.57190635451505,"#1F78B4"],[0.575250836120401,"#1F78B4"],[0.578595317725752,"#1F78B4"],[0.581939799331104,"#1F78B4"],[0.585284280936455,"#1F78B4"],[0.588628762541806,"#1F78B4"],[0.591973244147157,"#1F78B4"],[0.595317725752508,"#1F78B4"],[0.598662207357859,"#1F78B4"],[0.602006688963211,"#1F78B4"],[0.605351170568562,"#1F78B4"],[0.608695652173913,"#1F78B4"],[0.612040133779264,"#1F78B4"],[0.615384615384615,"#1F78B4"],[0.618729096989967,"#1F78B4"],[0.622073578595318,"#1F78B4"],[0.625418060200669,"#1F78B4"],[0.62876254180602,"#1F78B4"],[0.632107023411371,"#1F78B4"],[0.635451505016722,"#1F78B4"],[0.638795986622074,"#1F78B4"],[0.642140468227425,"#1F78B4"],[0.645484949832776,"#1F78B4"],[0.648829431438127,"#1F78B4"],[0.652173913043478,"#1F78B4"],[0.655518394648829,"#1F78B4"],[0.658862876254181,"#1F78B4"],[0.662207357859532,"#1F78B4"],[0.665551839464883,"#1F78B4"],[0.668896321070234,"#B2DF8A"],[0.672240802675585,"#B2DF8A"],[0.675585284280936,"#B2DF8A"],[0.678929765886288,"#B2DF8A"],[0.682274247491639,"#B2DF8A"],[0.68561872909699,"#B2DF8A"],[0.688963210702341,"#B2DF8A"],[0.692307692307692,"#B2DF8A"],[0.695652173913043,"#B2DF8A"],[0.698996655518395,"#B2DF8A"],[0.702341137123746,"#B2DF8A"],[0.705685618729097,"#B2DF8A"],[0.709030100334448,"#B2DF8A"],[0.712374581939799,"#B2DF8A"],[0.71571906354515,"#B2DF8A"],[0.719063545150502,"#B2DF8A"],[0.722408026755853,"#B2DF8A"],[0.725752508361204,"#B2DF8A"],[0.729096989966555,"#B2DF8A"],[0.732441471571906,"#B2DF8A"],[0.735785953177257,"#B2DF8A"],[0.739130434782609,"#B2DF8A"],[0.74247491638796,"#B2DF8A"],[0.745819397993311,"#B2DF8A"],[0.749163879598662,"#B2DF8A"],[0.752508361204013,"#B2DF8A"],[0.755852842809364,"#B2DF8A"],[0.759197324414716,"#B2DF8A"],[0.762541806020067,"#B2DF8A"],[0.765886287625418,"#B2DF8A"],[0.769230769230769,"#B2DF8A"],[0.77257525083612,"#B2DF8A"],[0.775919732441472,"#B2DF8A"],[0.779264214046823,"#B2DF8A"],[0.782608695652174,"#B2DF8A"],[0.785953177257525,"#B2DF8A"],[0.789297658862876,"#B2DF8A"],[0.792642140468227,"#B2DF8A"],[0.795986622073579,"#B2DF8A"],[0.79933110367893,"#B2DF8A"],[0.802675585284281,"#B2DF8A"],[0.806020066889632,"#B2DF8A"],[0.809364548494983,"#B2DF8A"],[0.812709030100334,"#B2DF8A"],[0.816053511705686,"#B2DF8A"],[0.819397993311037,"#B2DF8A"],[0.822742474916388,"#B2DF8A"],[0.826086956521739,"#B2DF8A"],[0.82943143812709,"#B2DF8A"],[0.832775919732441,"#B2DF8A"],[0.836120401337793,"#B2DF8A"],[0.839464882943144,"#B2DF8A"],[0.842809364548495,"#B2DF8A"],[0.846153846153846,"#B2DF8A"],[0.849498327759197,"#B2DF8A"],[0.852842809364548,"#B2DF8A"],[0.8561872909699,"#B2DF8A"],[0.859531772575251,"#B2DF8A"],[0.862876254180602,"#B2DF8A"],[0.866220735785953,"#B2DF8A"],[0.869565217391304,"#B2DF8A"],[0.872909698996655,"#B2DF8A"],[0.876254180602007,"#B2DF8A"],[0.879598662207358,"#B2DF8A"],[0.882943143812709,"#B2DF8A"],[0.88628762541806,"#B2DF8A"],[0.889632107023411,"#B2DF8A"],[0.892976588628763,"#B2DF8A"],[0.896321070234114,"#B2DF8A"],[0.899665551839465,"#B2DF8A"],[0.903010033444816,"#B2DF8A"],[0.906354515050167,"#B2DF8A"],[0.909698996655518,"#B2DF8A"],[0.91304347826087,"#B2DF8A"],[0.916387959866221,"#B2DF8A"],[0.919732441471572,"#B2DF8A"],[0.923076923076923,"#B2DF8A"],[0.926421404682274,"#B2DF8A"],[0.929765886287625,"#B2DF8A"],[0.933110367892977,"#B2DF8A"],[0.936454849498328,"#B2DF8A"],[0.939799331103679,"#B2DF8A"],[0.94314381270903,"#B2DF8A"],[0.946488294314381,"#B2DF8A"],[0.949832775919732,"#B2DF8A"],[0.953177257525084,"#B2DF8A"],[0.956521739130435,"#B2DF8A"],[0.959866220735786,"#B2DF8A"],[0.963210702341137,"#B2DF8A"],[0.966555183946488,"#B2DF8A"],[0.969899665551839,"#B2DF8A"],[0.973244147157191,"#B2DF8A"],[0.976588628762542,"#B2DF8A"],[0.979933110367893,"#B2DF8A"],[0.983277591973244,"#B2DF8A"],[0.986622073578595,"#B2DF8A"],[0.989966555183946,"#B2DF8A"],[0.993311036789298,"#B2DF8A"],[0.996655518394649,"#B2DF8A"],[1,"#B2DF8A"]],"showscale":true,"z":[[1],[1],[1],[1],[1],[1],[1],[1],[1],[1],[2],[3],[2],[2],[2],[2],[2],[2],[3],[3],[3],[2],[2],[2],[2],[2],[2],[2],[3],[3],[3],[3],[3],[3],[3]],"x":[1],"y":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35],"text":[["value: setosa<br>variable: Species<br>row: 29"],["value: setosa<br>variable: Species<br>row: 14"],["value: setosa<br>variable: Species<br>row: 32"],["value: setosa<br>variable: Species<br>row: 25"],["value: setosa<br>variable: Species<br>row: 22"],["value: setosa<br>variable: Species<br>row: 5"],["value: setosa<br>variable: Species<br>row: 24"],["value: setosa<br>variable: Species<br>row: 21"],["value: setosa<br>variable: Species<br>row: 10"],["value: setosa<br>variable: Species<br>row: 7"],["value: versicolor<br>variable: Species<br>row: 31"],["value: virginica<br>variable: Species<br>row: 33"],["value: versicolor<br>variable: Species<br>row: 27"],["value: versicolor<br>variable: Species<br>row: 28"],["value: versicolor<br>variable: Species<br>row: 20"],["value: versicolor<br>variable: Species<br>row: 26"],["value: versicolor<br>variable: Species<br>row: 18"],["value: versicolor<br>variable: Species<br>row: 15"],["value: virginica<br>variable: Species<br>row: 12"],["value: virginica<br>variable: Species<br>row: 4"],["value: virginica<br>variable: Species<br>row: 34"],["value: versicolor<br>variable: Species<br>row: 35"],["value: versicolor<br>variable: Species<br>row: 19"],["value: versicolor<br>variable: Species<br>row: 23"],["value: versicolor<br>variable: Species<br>row: 16"],["value: versicolor<br>variable: Species<br>row: 9"],["value: versicolor<br>variable: Species<br>row: 3"],["value: versicolor<br>variable: Species<br>row: 11"],["value: virginica<br>variable: Species<br>row: 13"],["value: virginica<br>variable: Species<br>row: 1"],["value: virginica<br>variable: Species<br>row: 6"],["value: virginica<br>variable: Species<br>row: 2"],["value: virginica<br>variable: Species<br>row: 17"],["value: virginica<br>variable: Species<br>row: 30"],["value: virginica<br>variable: Species<br>row: 8"]],"hoverinfo":"text","showlegend":false,"type":"heatmap","xaxis":"x2","yaxis":"y2","frame":null},{"colorbar":{"ticklen":2,"lenmode":"fraction","xanchor":"right","x":-0.1,"y":0,"yanchor":"bottom","len":0.3,"thickness":30},"colorscale":[["0","rgba(68,1,84,1)"],["0.0416666666666667","rgba(71,17,100,1)"],["0.0833333333333333","rgba(72,31,112,1)"],["0.125","rgba(71,45,123,1)"],["0.166666666666667","rgba(68,58,131,1)"],["0.208333333333333","rgba(64,70,136,1)"],["0.25","rgba(59,82,139,1)"],["0.291666666666667","rgba(54,93,141,1)"],["0.333333333333333","rgba(49,104,142,1)"],["0.375","rgba(44,114,142,1)"],["0.416666666666667","rgba(40,124,142,1)"],["0.458333333333333","rgba(36,134,142,1)"],["0.5","rgba(33,144,141,1)"],["0.541666666666667","rgba(31,154,138,1)"],["0.583333333333333","rgba(32,164,134,1)"],["0.625","rgba(39,173,129,1)"],["0.666666666666667","rgba(53,183,121,1)"],["0.708333333333333","rgba(71,193,110,1)"],["0.75","rgba(93,200,99,1)"],["0.791666666666667","rgba(117,208,84,1)"],["0.833333333333333","rgba(143,214,68,1)"],["0.875","rgba(170,220,50,1)"],["0.916666666666667","rgba(199,224,32,1)"],["0.958333333333333","rgba(227,228,24,1)"],["1","rgba(253,231,37,1)"]],"showscale":true,"z":[[1,0.44,0.130434782608696,0.102040816326531],[0.909090909090909,0.36,0.0434782608695652,0.0816326530612245],[0.772727272727273,0.32,0.130434782608696,0.142857142857143],[0.727272727272727,0.2,0.0434782608695652,0.122448979591837],[0.545454545454545,0.32,0.0434782608695652,0.142857142857143],[0.545454545454545,0.32,0.130434782608696,0.102040816326531],[0.590909090909091,0.16,0.0869565217391304,0.0612244897959184],[0.636363636363636,0.12,0,0.0816326530612245],[0.636363636363636,0,0.0434782608695652,0],[0.545454545454545,0,0.0869565217391304,0.0816326530612245],[0.0454545454545453,0.16,0.391304347826087,0.469387755102041],[0.136363636363636,0.12,0.695652173913043,0.714285714285714],[0.227272727272727,0.24,0.565217391304348,0.591836734693878],[0.227272727272727,0.4,0.521739130434783,0.653061224489796],[0.181818181818182,0.36,0.478260869565217,0.693877551020408],[0.136363636363636,0.36,0.521739130434783,0.612244897959184],[0,0.56,0.391304347826087,0.612244897959184],[0,0.64,0.608695652173913,0.714285714285714],[0.181818181818182,0.6,0.565217391304348,0.938775510204081],[0.227272727272727,0.48,0.782608695652174,0.836734693877551],[0.363636363636364,0.56,0.739130434782609,0.775510204081633],[0.545454545454545,0.56,0.652173913043478,0.714285714285714],[0.318181818181818,0.44,0.521739130434783,0.653061224489796],[0.318181818181818,0.56,0.608695652173913,0.714285714285714],[0.272727272727273,0.6,0.521739130434783,0.612244897959184],[0.272727272727273,0.6,0.478260869565217,0.755102040816326],[0.363636363636364,0.8,0.565217391304348,0.693877551020408],[0.409090909090909,0.92,0.608695652173913,0.795918367346939],[0.409090909090909,0.92,0.869565217391304,0.897959183673469],[0.363636363636364,1,0.869565217391304,1],[0.136363636363636,0.84,0.739130434782609,0.979591836734694],[0.363636363636364,0.76,0.739130434782609,0.918367346938775],[0.363636363636364,0.76,0.826086956521739,0.857142857142857],[0.454545454545455,0.72,0.956521739130435,0.877551020408163],[0.545454545454545,0.68,1,0.938775510204081]],"x":[1,2,3,4],"y":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35],"text":[["row: 29<br>column: Sepal.Width<br>value: 1","row: 29<br>column: Sepal.Length<br>value: 0.44","row: 29<br>column: Petal.Width<br>value: 0.130434782608696","row: 29<br>column: Petal.Length<br>value: 0.102040816326531"],["row: 14<br>column: Sepal.Width<br>value: 0.909090909090909","row: 14<br>column: Sepal.Length<br>value: 0.36","row: 14<br>column: Petal.Width<br>value: 0.0434782608695652","row: 14<br>column: Petal.Length<br>value: 0.0816326530612245"],["row: 32<br>column: Sepal.Width<br>value: 0.772727272727273","row: 32<br>column: Sepal.Length<br>value: 0.32","row: 32<br>column: Petal.Width<br>value: 0.130434782608696","row: 32<br>column: Petal.Length<br>value: 0.142857142857143"],["row: 25<br>column: Sepal.Width<br>value: 0.727272727272727","row: 25<br>column: Sepal.Length<br>value: 0.2","row: 25<br>column: Petal.Width<br>value: 0.0434782608695652","row: 25<br>column: Petal.Length<br>value: 0.122448979591837"],["row: 22<br>column: Sepal.Width<br>value: 0.545454545454545","row: 22<br>column: Sepal.Length<br>value: 0.32","row: 22<br>column: Petal.Width<br>value: 0.0434782608695652","row: 22<br>column: Petal.Length<br>value: 0.142857142857143"],["row: 5<br>column: Sepal.Width<br>value: 0.545454545454545","row: 5<br>column: Sepal.Length<br>value: 0.32","row: 5<br>column: Petal.Width<br>value: 0.130434782608696","row: 5<br>column: Petal.Length<br>value: 0.102040816326531"],["row: 24<br>column: Sepal.Width<br>value: 0.590909090909091","row: 24<br>column: Sepal.Length<br>value: 0.16","row: 24<br>column: Petal.Width<br>value: 0.0869565217391304","row: 24<br>column: Petal.Length<br>value: 0.0612244897959184"],["row: 21<br>column: Sepal.Width<br>value: 0.636363636363636","row: 21<br>column: Sepal.Length<br>value: 0.12","row: 21<br>column: Petal.Width<br>value: 0","row: 21<br>column: Petal.Length<br>value: 0.0816326530612245"],["row: 10<br>column: Sepal.Width<br>value: 0.636363636363636","row: 10<br>column: Sepal.Length<br>value: 0","row: 10<br>column: Petal.Width<br>value: 0.0434782608695652","row: 10<br>column: Petal.Length<br>value: 0"],["row: 7<br>column: Sepal.Width<br>value: 0.545454545454545","row: 7<br>column: Sepal.Length<br>value: 0","row: 7<br>column: Petal.Width<br>value: 0.0869565217391304","row: 7<br>column: Petal.Length<br>value: 0.0816326530612245"],["row: 31<br>column: Sepal.Width<br>value: 0.0454545454545453","row: 31<br>column: Sepal.Length<br>value: 0.16","row: 31<br>column: Petal.Width<br>value: 0.391304347826087","row: 31<br>column: Petal.Length<br>value: 0.469387755102041"],["row: 33<br>column: Sepal.Width<br>value: 0.136363636363636","row: 33<br>column: Sepal.Length<br>value: 0.12","row: 33<br>column: Petal.Width<br>value: 0.695652173913043","row: 33<br>column: Petal.Length<br>value: 0.714285714285714"],["row: 27<br>column: Sepal.Width<br>value: 0.227272727272727","row: 27<br>column: Sepal.Length<br>value: 0.24","row: 27<br>column: Petal.Width<br>value: 0.565217391304348","row: 27<br>column: Petal.Length<br>value: 0.591836734693878"],["row: 28<br>column: Sepal.Width<br>value: 0.227272727272727","row: 28<br>column: Sepal.Length<br>value: 0.4","row: 28<br>column: Petal.Width<br>value: 0.521739130434783","row: 28<br>column: Petal.Length<br>value: 0.653061224489796"],["row: 20<br>column: Sepal.Width<br>value: 0.181818181818182","row: 20<br>column: Sepal.Length<br>value: 0.36","row: 20<br>column: Petal.Width<br>value: 0.478260869565217","row: 20<br>column: Petal.Length<br>value: 0.693877551020408"],["row: 26<br>column: Sepal.Width<br>value: 0.136363636363636","row: 26<br>column: Sepal.Length<br>value: 0.36","row: 26<br>column: Petal.Width<br>value: 0.521739130434783","row: 26<br>column: Petal.Length<br>value: 0.612244897959184"],["row: 18<br>column: Sepal.Width<br>value: 0","row: 18<br>column: Sepal.Length<br>value: 0.56","row: 18<br>column: Petal.Width<br>value: 0.391304347826087","row: 18<br>column: Petal.Length<br>value: 0.612244897959184"],["row: 15<br>column: Sepal.Width<br>value: 0","row: 15<br>column: Sepal.Length<br>value: 0.64","row: 15<br>column: Petal.Width<br>value: 0.608695652173913","row: 15<br>column: Petal.Length<br>value: 0.714285714285714"],["row: 12<br>column: Sepal.Width<br>value: 0.181818181818182","row: 12<br>column: Sepal.Length<br>value: 0.6","row: 12<br>column: Petal.Width<br>value: 0.565217391304348","row: 12<br>column: Petal.Length<br>value: 0.938775510204081"],["row: 4<br>column: Sepal.Width<br>value: 0.227272727272727","row: 4<br>column: Sepal.Length<br>value: 0.48","row: 4<br>column: Petal.Width<br>value: 0.782608695652174","row: 4<br>column: Petal.Length<br>value: 0.836734693877551"],["row: 34<br>column: Sepal.Width<br>value: 0.363636363636364","row: 34<br>column: Sepal.Length<br>value: 0.56","row: 34<br>column: Petal.Width<br>value: 0.739130434782609","row: 34<br>column: Petal.Length<br>value: 0.775510204081633"],["row: 35<br>column: Sepal.Width<br>value: 0.545454545454545","row: 35<br>column: Sepal.Length<br>value: 0.56","row: 35<br>column: Petal.Width<br>value: 0.652173913043478","row: 35<br>column: Petal.Length<br>value: 0.714285714285714"],["row: 19<br>column: Sepal.Width<br>value: 0.318181818181818","row: 19<br>column: Sepal.Length<br>value: 0.44","row: 19<br>column: Petal.Width<br>value: 0.521739130434783","row: 19<br>column: Petal.Length<br>value: 0.653061224489796"],["row: 23<br>column: Sepal.Width<br>value: 0.318181818181818","row: 23<br>column: Sepal.Length<br>value: 0.56","row: 23<br>column: Petal.Width<br>value: 0.608695652173913","row: 23<br>column: Petal.Length<br>value: 0.714285714285714"],["row: 16<br>column: Sepal.Width<br>value: 0.272727272727273","row: 16<br>column: Sepal.Length<br>value: 0.6","row: 16<br>column: Petal.Width<br>value: 0.521739130434783","row: 16<br>column: Petal.Length<br>value: 0.612244897959184"],["row: 9<br>column: Sepal.Width<br>value: 0.272727272727273","row: 9<br>column: Sepal.Length<br>value: 0.6","row: 9<br>column: Petal.Width<br>value: 0.478260869565217","row: 9<br>column: Petal.Length<br>value: 0.755102040816326"],["row: 3<br>column: Sepal.Width<br>value: 0.363636363636364","row: 3<br>column: Sepal.Length<br>value: 0.8","row: 3<br>column: Petal.Width<br>value: 0.565217391304348","row: 3<br>column: Petal.Length<br>value: 0.693877551020408"],["row: 11<br>column: Sepal.Width<br>value: 0.409090909090909","row: 11<br>column: Sepal.Length<br>value: 0.92","row: 11<br>column: Petal.Width<br>value: 0.608695652173913","row: 11<br>column: Petal.Length<br>value: 0.795918367346939"],["row: 13<br>column: Sepal.Width<br>value: 0.409090909090909","row: 13<br>column: Sepal.Length<br>value: 0.92","row: 13<br>column: Petal.Width<br>value: 0.869565217391304","row: 13<br>column: Petal.Length<br>value: 0.897959183673469"],["row: 1<br>column: Sepal.Width<br>value: 0.363636363636364","row: 1<br>column: Sepal.Length<br>value: 1","row: 1<br>column: Petal.Width<br>value: 0.869565217391304","row: 1<br>column: Petal.Length<br>value: 1"],["row: 6<br>column: Sepal.Width<br>value: 0.136363636363636","row: 6<br>column: Sepal.Length<br>value: 0.84","row: 6<br>column: Petal.Width<br>value: 0.739130434782609","row: 6<br>column: Petal.Length<br>value: 0.979591836734694"],["row: 2<br>column: Sepal.Width<br>value: 0.363636363636364","row: 2<br>column: Sepal.Length<br>value: 0.76","row: 2<br>column: Petal.Width<br>value: 0.739130434782609","row: 2<br>column: Petal.Length<br>value: 0.918367346938775"],["row: 17<br>column: Sepal.Width<br>value: 0.363636363636364","row: 17<br>column: Sepal.Length<br>value: 0.76","row: 17<br>column: Petal.Width<br>value: 0.826086956521739","row: 17<br>column: Petal.Length<br>value: 0.857142857142857"],["row: 30<br>column: Sepal.Width<br>value: 0.454545454545455","row: 30<br>column: Sepal.Length<br>value: 0.72","row: 30<br>column: Petal.Width<br>value: 0.956521739130435","row: 30<br>column: Petal.Length<br>value: 0.877551020408163"],["row: 8<br>column: Sepal.Width<br>value: 0.545454545454545","row: 8<br>column: Sepal.Length<br>value: 0.68","row: 8<br>column: Petal.Width<br>value: 1","row: 8<br>column: Petal.Length<br>value: 0.938775510204081"]],"showlegend":false,"hoverinfo":"text","type":"heatmap","xaxis":"x3","yaxis":"y2","frame":null}],"layout":{"xaxis":{"domain":[0,0.2],"automargin":true,"showticklabels":false,"showgrid":false,"zeroline":false,"anchor":"y2","title":"","range":[0,1.66036135374942],"linecolor":"#ffffff","autorange":"reversed"},"xaxis2":{"domain":[0.2,0.3],"automargin":true,"showticklabels":true,"showgrid":false,"zeroline":false,"anchor":"y2","tickfont":{"size":10},"tickangle":45,"tickvals":[1],"ticktext":["Species"],"linecolor":"#ffffff","range":[0.5,1.5],"title":[]},"xaxis3":{"domain":[0.3,1],"automargin":true,"title":"","range":[0.5,4.5],"linecolor":"#ffffff","showgrid":false,"anchor":"y2","tickfont":{"size":10},"tickangle":45,"tickvals":[1,2,3,4],"ticktext":["Sepal.Width","Sepal.Length","Petal.Width","Petal.Length"],"showticklabels":true},"yaxis2":{"domain":[0,0.8],"automargin":true,"tickfont":{"size":10},"tickangle":0,"tickvals":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35],"ticktext":["29","14","32","25","22","5","24","21","10","7","31","33","27","28","20","26","18","15","12","4","34","35","19","23","16","9","3","11","13","1","6","2","17","30","8"],"linecolor":"#ffffff","range":[0,35.5],"showticklabels":true,"title":"","anchor":"x3","showgrid":false,"side":"right"},"yaxis":{"domain":[0.8,1],"automargin":true,"title":"","range":[0,3.2063128140195],"linecolor":"#ffffff","showgrid":false,"anchor":"x","showticklabels":false,"zeroline":false},"annotations":[],"shapes":[],"images":[],"margin":{"b":72,"l":null,"t":0,"r":12},"hovermode":"closest","showlegend":true,"scene":{"zaxis":{"title":[]}},"title":"","legend":{"y":1,"yanchor":"top"}},"attrs":{"8c83606688d":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20]},"8c83917efdf":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":{},"y":{},"xend":{},"yend":{},"type":"scatter","mode":"lines","color":{},"showlegend":false,"colors":"1","hoverinfo":"y","inherit":true},"8c8528536c1":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":{},"y":{},"xend":{},"yend":{},"type":"scatter","mode":"lines","color":{},"showlegend":false,"colors":"1","hoverinfo":"x","inherit":true},"8c83e010940":{"z":[[1],[1],[1],[1],[1],[1],[1],[1],[1],[1],[2],[3],[2],[2],[2],[2],[2],[2],[3],[3],[3],[2],[2],[2],[2],[2],[2],[2],[3],[3],[3],[3],[3],[3],[3]],"x":1,"y":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35],"text":[["value: setosa<br>variable: Species<br>row: 29"],["value: setosa<br>variable: Species<br>row: 14"],["value: setosa<br>variable: Species<br>row: 32"],["value: setosa<br>variable: Species<br>row: 25"],["value: setosa<br>variable: Species<br>row: 22"],["value: setosa<br>variable: Species<br>row: 5"],["value: setosa<br>variable: Species<br>row: 24"],["value: setosa<br>variable: Species<br>row: 21"],["value: setosa<br>variable: Species<br>row: 10"],["value: setosa<br>variable: Species<br>row: 7"],["value: versicolor<br>variable: Species<br>row: 31"],["value: virginica<br>variable: Species<br>row: 33"],["value: versicolor<br>variable: Species<br>row: 27"],["value: versicolor<br>variable: Species<br>row: 28"],["value: versicolor<br>variable: Species<br>row: 20"],["value: versicolor<br>variable: Species<br>row: 26"],["value: versicolor<br>variable: Species<br>row: 18"],["value: versicolor<br>variable: Species<br>row: 15"],["value: virginica<br>variable: Species<br>row: 12"],["value: virginica<br>variable: Species<br>row: 4"],["value: virginica<br>variable: Species<br>row: 34"],["value: versicolor<br>variable: Species<br>row: 35"],["value: versicolor<br>variable: Species<br>row: 19"],["value: versicolor<br>variable: Species<br>row: 23"],["value: versicolor<br>variable: Species<br>row: 16"],["value: versicolor<br>variable: Species<br>row: 9"],["value: versicolor<br>variable: Species<br>row: 3"],["value: versicolor<br>variable: Species<br>row: 11"],["value: virginica<br>variable: Species<br>row: 13"],["value: virginica<br>variable: Species<br>row: 1"],["value: virginica<br>variable: Species<br>row: 6"],["value: virginica<br>variable: Species<br>row: 2"],["value: virginica<br>variable: Species<br>row: 17"],["value: virginica<br>variable: Species<br>row: 30"],["value: virginica<br>variable: Species<br>row: 8"]],"hoverinfo":"text","showlegend":false,"colorscale":[[0,"#A6CEE3"],[0.00334448160535117,"#A6CEE3"],[0.00668896321070234,"#A6CEE3"],[0.0100334448160535,"#A6CEE3"],[0.0133779264214047,"#A6CEE3"],[0.0167224080267559,"#A6CEE3"],[0.020066889632107,"#A6CEE3"],[0.0234113712374582,"#A6CEE3"],[0.0267558528428094,"#A6CEE3"],[0.0301003344481605,"#A6CEE3"],[0.0334448160535117,"#A6CEE3"],[0.0367892976588629,"#A6CEE3"],[0.040133779264214,"#A6CEE3"],[0.0434782608695652,"#A6CEE3"],[0.0468227424749164,"#A6CEE3"],[0.0501672240802676,"#A6CEE3"],[0.0535117056856187,"#A6CEE3"],[0.0568561872909699,"#A6CEE3"],[0.0602006688963211,"#A6CEE3"],[0.0635451505016722,"#A6CEE3"],[0.0668896321070234,"#A6CEE3"],[0.0702341137123746,"#A6CEE3"],[0.0735785953177257,"#A6CEE3"],[0.0769230769230769,"#A6CEE3"],[0.0802675585284281,"#A6CEE3"],[0.0836120401337793,"#A6CEE3"],[0.0869565217391304,"#A6CEE3"],[0.0903010033444816,"#A6CEE3"],[0.0936454849498328,"#A6CEE3"],[0.096989966555184,"#A6CEE3"],[0.100334448160535,"#A6CEE3"],[0.103678929765886,"#A6CEE3"],[0.107023411371237,"#A6CEE3"],[0.110367892976589,"#A6CEE3"],[0.11371237458194,"#A6CEE3"],[0.117056856187291,"#A6CEE3"],[0.120401337792642,"#A6CEE3"],[0.123745819397993,"#A6CEE3"],[0.127090301003344,"#A6CEE3"],[0.130434782608696,"#A6CEE3"],[0.133779264214047,"#A6CEE3"],[0.137123745819398,"#A6CEE3"],[0.140468227424749,"#A6CEE3"],[0.1438127090301,"#A6CEE3"],[0.147157190635451,"#A6CEE3"],[0.150501672240803,"#A6CEE3"],[0.153846153846154,"#A6CEE3"],[0.157190635451505,"#A6CEE3"],[0.160535117056856,"#A6CEE3"],[0.163879598662207,"#A6CEE3"],[0.167224080267559,"#A6CEE3"],[0.17056856187291,"#A6CEE3"],[0.173913043478261,"#A6CEE3"],[0.177257525083612,"#A6CEE3"],[0.180602006688963,"#A6CEE3"],[0.183946488294314,"#A6CEE3"],[0.187290969899666,"#A6CEE3"],[0.190635451505017,"#A6CEE3"],[0.193979933110368,"#A6CEE3"],[0.197324414715719,"#A6CEE3"],[0.20066889632107,"#A6CEE3"],[0.204013377926421,"#A6CEE3"],[0.207357859531773,"#A6CEE3"],[0.210702341137124,"#A6CEE3"],[0.214046822742475,"#A6CEE3"],[0.217391304347826,"#A6CEE3"],[0.220735785953177,"#A6CEE3"],[0.224080267558528,"#A6CEE3"],[0.22742474916388,"#A6CEE3"],[0.230769230769231,"#A6CEE3"],[0.234113712374582,"#A6CEE3"],[0.237458193979933,"#A6CEE3"],[0.240802675585284,"#A6CEE3"],[0.244147157190635,"#A6CEE3"],[0.247491638795987,"#A6CEE3"],[0.250836120401338,"#A6CEE3"],[0.254180602006689,"#A6CEE3"],[0.25752508361204,"#A6CEE3"],[0.260869565217391,"#A6CEE3"],[0.264214046822742,"#A6CEE3"],[0.267558528428094,"#A6CEE3"],[0.270903010033445,"#A6CEE3"],[0.274247491638796,"#A6CEE3"],[0.277591973244147,"#A6CEE3"],[0.280936454849498,"#A6CEE3"],[0.284280936454849,"#A6CEE3"],[0.287625418060201,"#A6CEE3"],[0.290969899665552,"#A6CEE3"],[0.294314381270903,"#A6CEE3"],[0.297658862876254,"#A6CEE3"],[0.301003344481605,"#A6CEE3"],[0.304347826086957,"#A6CEE3"],[0.307692307692308,"#A6CEE3"],[0.311036789297659,"#A6CEE3"],[0.31438127090301,"#A6CEE3"],[0.317725752508361,"#A6CEE3"],[0.321070234113712,"#A6CEE3"],[0.324414715719064,"#A6CEE3"],[0.327759197324415,"#A6CEE3"],[0.331103678929766,"#A6CEE3"],[0.334448160535117,"#1F78B4"],[0.337792642140468,"#1F78B4"],[0.341137123745819,"#1F78B4"],[0.344481605351171,"#1F78B4"],[0.347826086956522,"#1F78B4"],[0.351170568561873,"#1F78B4"],[0.354515050167224,"#1F78B4"],[0.357859531772575,"#1F78B4"],[0.361204013377926,"#1F78B4"],[0.364548494983278,"#1F78B4"],[0.367892976588629,"#1F78B4"],[0.37123745819398,"#1F78B4"],[0.374581939799331,"#1F78B4"],[0.377926421404682,"#1F78B4"],[0.381270903010033,"#1F78B4"],[0.384615384615385,"#1F78B4"],[0.387959866220736,"#1F78B4"],[0.391304347826087,"#1F78B4"],[0.394648829431438,"#1F78B4"],[0.397993311036789,"#1F78B4"],[0.40133779264214,"#1F78B4"],[0.404682274247492,"#1F78B4"],[0.408026755852843,"#1F78B4"],[0.411371237458194,"#1F78B4"],[0.414715719063545,"#1F78B4"],[0.418060200668896,"#1F78B4"],[0.421404682274247,"#1F78B4"],[0.424749163879599,"#1F78B4"],[0.42809364548495,"#1F78B4"],[0.431438127090301,"#1F78B4"],[0.434782608695652,"#1F78B4"],[0.438127090301003,"#1F78B4"],[0.441471571906354,"#1F78B4"],[0.444816053511706,"#1F78B4"],[0.448160535117057,"#1F78B4"],[0.451505016722408,"#1F78B4"],[0.454849498327759,"#1F78B4"],[0.45819397993311,"#1F78B4"],[0.461538461538462,"#1F78B4"],[0.464882943143813,"#1F78B4"],[0.468227424749164,"#1F78B4"],[0.471571906354515,"#1F78B4"],[0.474916387959866,"#1F78B4"],[0.478260869565217,"#1F78B4"],[0.481605351170569,"#1F78B4"],[0.48494983277592,"#1F78B4"],[0.488294314381271,"#1F78B4"],[0.491638795986622,"#1F78B4"],[0.494983277591973,"#1F78B4"],[0.498327759197324,"#1F78B4"],[0.501672240802676,"#1F78B4"],[0.505016722408027,"#1F78B4"],[0.508361204013378,"#1F78B4"],[0.511705685618729,"#1F78B4"],[0.51505016722408,"#1F78B4"],[0.518394648829431,"#1F78B4"],[0.521739130434783,"#1F78B4"],[0.525083612040134,"#1F78B4"],[0.528428093645485,"#1F78B4"],[0.531772575250836,"#1F78B4"],[0.535117056856187,"#1F78B4"],[0.538461538461538,"#1F78B4"],[0.54180602006689,"#1F78B4"],[0.545150501672241,"#1F78B4"],[0.548494983277592,"#1F78B4"],[0.551839464882943,"#1F78B4"],[0.555183946488294,"#1F78B4"],[0.558528428093645,"#1F78B4"],[0.561872909698997,"#1F78B4"],[0.565217391304348,"#1F78B4"],[0.568561872909699,"#1F78B4"],[0.57190635451505,"#1F78B4"],[0.575250836120401,"#1F78B4"],[0.578595317725752,"#1F78B4"],[0.581939799331104,"#1F78B4"],[0.585284280936455,"#1F78B4"],[0.588628762541806,"#1F78B4"],[0.591973244147157,"#1F78B4"],[0.595317725752508,"#1F78B4"],[0.598662207357859,"#1F78B4"],[0.602006688963211,"#1F78B4"],[0.605351170568562,"#1F78B4"],[0.608695652173913,"#1F78B4"],[0.612040133779264,"#1F78B4"],[0.615384615384615,"#1F78B4"],[0.618729096989967,"#1F78B4"],[0.622073578595318,"#1F78B4"],[0.625418060200669,"#1F78B4"],[0.62876254180602,"#1F78B4"],[0.632107023411371,"#1F78B4"],[0.635451505016722,"#1F78B4"],[0.638795986622074,"#1F78B4"],[0.642140468227425,"#1F78B4"],[0.645484949832776,"#1F78B4"],[0.648829431438127,"#1F78B4"],[0.652173913043478,"#1F78B4"],[0.655518394648829,"#1F78B4"],[0.658862876254181,"#1F78B4"],[0.662207357859532,"#1F78B4"],[0.665551839464883,"#1F78B4"],[0.668896321070234,"#B2DF8A"],[0.672240802675585,"#B2DF8A"],[0.675585284280936,"#B2DF8A"],[0.678929765886288,"#B2DF8A"],[0.682274247491639,"#B2DF8A"],[0.68561872909699,"#B2DF8A"],[0.688963210702341,"#B2DF8A"],[0.692307692307692,"#B2DF8A"],[0.695652173913043,"#B2DF8A"],[0.698996655518395,"#B2DF8A"],[0.702341137123746,"#B2DF8A"],[0.705685618729097,"#B2DF8A"],[0.709030100334448,"#B2DF8A"],[0.712374581939799,"#B2DF8A"],[0.71571906354515,"#B2DF8A"],[0.719063545150502,"#B2DF8A"],[0.722408026755853,"#B2DF8A"],[0.725752508361204,"#B2DF8A"],[0.729096989966555,"#B2DF8A"],[0.732441471571906,"#B2DF8A"],[0.735785953177257,"#B2DF8A"],[0.739130434782609,"#B2DF8A"],[0.74247491638796,"#B2DF8A"],[0.745819397993311,"#B2DF8A"],[0.749163879598662,"#B2DF8A"],[0.752508361204013,"#B2DF8A"],[0.755852842809364,"#B2DF8A"],[0.759197324414716,"#B2DF8A"],[0.762541806020067,"#B2DF8A"],[0.765886287625418,"#B2DF8A"],[0.769230769230769,"#B2DF8A"],[0.77257525083612,"#B2DF8A"],[0.775919732441472,"#B2DF8A"],[0.779264214046823,"#B2DF8A"],[0.782608695652174,"#B2DF8A"],[0.785953177257525,"#B2DF8A"],[0.789297658862876,"#B2DF8A"],[0.792642140468227,"#B2DF8A"],[0.795986622073579,"#B2DF8A"],[0.79933110367893,"#B2DF8A"],[0.802675585284281,"#B2DF8A"],[0.806020066889632,"#B2DF8A"],[0.809364548494983,"#B2DF8A"],[0.812709030100334,"#B2DF8A"],[0.816053511705686,"#B2DF8A"],[0.819397993311037,"#B2DF8A"],[0.822742474916388,"#B2DF8A"],[0.826086956521739,"#B2DF8A"],[0.82943143812709,"#B2DF8A"],[0.832775919732441,"#B2DF8A"],[0.836120401337793,"#B2DF8A"],[0.839464882943144,"#B2DF8A"],[0.842809364548495,"#B2DF8A"],[0.846153846153846,"#B2DF8A"],[0.849498327759197,"#B2DF8A"],[0.852842809364548,"#B2DF8A"],[0.8561872909699,"#B2DF8A"],[0.859531772575251,"#B2DF8A"],[0.862876254180602,"#B2DF8A"],[0.866220735785953,"#B2DF8A"],[0.869565217391304,"#B2DF8A"],[0.872909698996655,"#B2DF8A"],[0.876254180602007,"#B2DF8A"],[0.879598662207358,"#B2DF8A"],[0.882943143812709,"#B2DF8A"],[0.88628762541806,"#B2DF8A"],[0.889632107023411,"#B2DF8A"],[0.892976588628763,"#B2DF8A"],[0.896321070234114,"#B2DF8A"],[0.899665551839465,"#B2DF8A"],[0.903010033444816,"#B2DF8A"],[0.906354515050167,"#B2DF8A"],[0.909698996655518,"#B2DF8A"],[0.91304347826087,"#B2DF8A"],[0.916387959866221,"#B2DF8A"],[0.919732441471572,"#B2DF8A"],[0.923076923076923,"#B2DF8A"],[0.926421404682274,"#B2DF8A"],[0.929765886287625,"#B2DF8A"],[0.933110367892977,"#B2DF8A"],[0.936454849498328,"#B2DF8A"],[0.939799331103679,"#B2DF8A"],[0.94314381270903,"#B2DF8A"],[0.946488294314381,"#B2DF8A"],[0.949832775919732,"#B2DF8A"],[0.953177257525084,"#B2DF8A"],[0.956521739130435,"#B2DF8A"],[0.959866220735786,"#B2DF8A"],[0.963210702341137,"#B2DF8A"],[0.966555183946488,"#B2DF8A"],[0.969899665551839,"#B2DF8A"],[0.973244147157191,"#B2DF8A"],[0.976588628762542,"#B2DF8A"],[0.979933110367893,"#B2DF8A"],[0.983277591973244,"#B2DF8A"],[0.986622073578595,"#B2DF8A"],[0.989966555183946,"#B2DF8A"],[0.993311036789298,"#B2DF8A"],[0.996655518394649,"#B2DF8A"],[1,"#B2DF8A"]],"colorbar":{"title":"Species","tickmode":"array","tickvals":[1.33333333333333,2,2.66666666666667],"ticktext":["setosa","versicolor","virginica"],"len":0.3},"colors":["#A6CEE3","#1F78B4","#B2DF8A"],"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"heatmap"},"8c827cde33a":{"z":[[1,0.44,0.130434782608696,0.102040816326531],[0.909090909090909,0.36,0.0434782608695652,0.0816326530612245],[0.772727272727273,0.32,0.130434782608696,0.142857142857143],[0.727272727272727,0.2,0.0434782608695652,0.122448979591837],[0.545454545454545,0.32,0.0434782608695652,0.142857142857143],[0.545454545454545,0.32,0.130434782608696,0.102040816326531],[0.590909090909091,0.16,0.0869565217391304,0.0612244897959184],[0.636363636363636,0.12,0,0.0816326530612245],[0.636363636363636,0,0.0434782608695652,0],[0.545454545454545,0,0.0869565217391304,0.0816326530612245],[0.0454545454545453,0.16,0.391304347826087,0.469387755102041],[0.136363636363636,0.12,0.695652173913043,0.714285714285714],[0.227272727272727,0.24,0.565217391304348,0.591836734693878],[0.227272727272727,0.4,0.521739130434783,0.653061224489796],[0.181818181818182,0.36,0.478260869565217,0.693877551020408],[0.136363636363636,0.36,0.521739130434783,0.612244897959184],[0,0.56,0.391304347826087,0.612244897959184],[0,0.64,0.608695652173913,0.714285714285714],[0.181818181818182,0.6,0.565217391304348,0.938775510204081],[0.227272727272727,0.48,0.782608695652174,0.836734693877551],[0.363636363636364,0.56,0.739130434782609,0.775510204081633],[0.545454545454545,0.56,0.652173913043478,0.714285714285714],[0.318181818181818,0.44,0.521739130434783,0.653061224489796],[0.318181818181818,0.56,0.608695652173913,0.714285714285714],[0.272727272727273,0.6,0.521739130434783,0.612244897959184],[0.272727272727273,0.6,0.478260869565217,0.755102040816326],[0.363636363636364,0.8,0.565217391304348,0.693877551020408],[0.409090909090909,0.92,0.608695652173913,0.795918367346939],[0.409090909090909,0.92,0.869565217391304,0.897959183673469],[0.363636363636364,1,0.869565217391304,1],[0.136363636363636,0.84,0.739130434782609,0.979591836734694],[0.363636363636364,0.76,0.739130434782609,0.918367346938775],[0.363636363636364,0.76,0.826086956521739,0.857142857142857],[0.454545454545455,0.72,0.956521739130435,0.877551020408163],[0.545454545454545,0.68,1,0.938775510204081]],"x":[1,2,3,4],"y":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35],"text":[["row: 29<br>column: Sepal.Width<br>value: 1","row: 29<br>column: Sepal.Length<br>value: 0.44","row: 29<br>column: Petal.Width<br>value: 0.130434782608696","row: 29<br>column: Petal.Length<br>value: 0.102040816326531"],["row: 14<br>column: Sepal.Width<br>value: 0.909090909090909","row: 14<br>column: Sepal.Length<br>value: 0.36","row: 14<br>column: Petal.Width<br>value: 0.0434782608695652","row: 14<br>column: Petal.Length<br>value: 0.0816326530612245"],["row: 32<br>column: Sepal.Width<br>value: 0.772727272727273","row: 32<br>column: Sepal.Length<br>value: 0.32","row: 32<br>column: Petal.Width<br>value: 0.130434782608696","row: 32<br>column: Petal.Length<br>value: 0.142857142857143"],["row: 25<br>column: Sepal.Width<br>value: 0.727272727272727","row: 25<br>column: Sepal.Length<br>value: 0.2","row: 25<br>column: Petal.Width<br>value: 0.0434782608695652","row: 25<br>column: Petal.Length<br>value: 0.122448979591837"],["row: 22<br>column: Sepal.Width<br>value: 0.545454545454545","row: 22<br>column: Sepal.Length<br>value: 0.32","row: 22<br>column: Petal.Width<br>value: 0.0434782608695652","row: 22<br>column: Petal.Length<br>value: 0.142857142857143"],["row: 5<br>column: Sepal.Width<br>value: 0.545454545454545","row: 5<br>column: Sepal.Length<br>value: 0.32","row: 5<br>column: Petal.Width<br>value: 0.130434782608696","row: 5<br>column: Petal.Length<br>value: 0.102040816326531"],["row: 24<br>column: Sepal.Width<br>value: 0.590909090909091","row: 24<br>column: Sepal.Length<br>value: 0.16","row: 24<br>column: Petal.Width<br>value: 0.0869565217391304","row: 24<br>column: Petal.Length<br>value: 0.0612244897959184"],["row: 21<br>column: Sepal.Width<br>value: 0.636363636363636","row: 21<br>column: Sepal.Length<br>value: 0.12","row: 21<br>column: Petal.Width<br>value: 0","row: 21<br>column: Petal.Length<br>value: 0.0816326530612245"],["row: 10<br>column: Sepal.Width<br>value: 0.636363636363636","row: 10<br>column: Sepal.Length<br>value: 0","row: 10<br>column: Petal.Width<br>value: 0.0434782608695652","row: 10<br>column: Petal.Length<br>value: 0"],["row: 7<br>column: Sepal.Width<br>value: 0.545454545454545","row: 7<br>column: Sepal.Length<br>value: 0","row: 7<br>column: Petal.Width<br>value: 0.0869565217391304","row: 7<br>column: Petal.Length<br>value: 0.0816326530612245"],["row: 31<br>column: Sepal.Width<br>value: 0.0454545454545453","row: 31<br>column: Sepal.Length<br>value: 0.16","row: 31<br>column: Petal.Width<br>value: 0.391304347826087","row: 31<br>column: Petal.Length<br>value: 0.469387755102041"],["row: 33<br>column: Sepal.Width<br>value: 0.136363636363636","row: 33<br>column: Sepal.Length<br>value: 0.12","row: 33<br>column: Petal.Width<br>value: 0.695652173913043","row: 33<br>column: Petal.Length<br>value: 0.714285714285714"],["row: 27<br>column: Sepal.Width<br>value: 0.227272727272727","row: 27<br>column: Sepal.Length<br>value: 0.24","row: 27<br>column: Petal.Width<br>value: 0.565217391304348","row: 27<br>column: Petal.Length<br>value: 0.591836734693878"],["row: 28<br>column: Sepal.Width<br>value: 0.227272727272727","row: 28<br>column: Sepal.Length<br>value: 0.4","row: 28<br>column: Petal.Width<br>value: 0.521739130434783","row: 28<br>column: Petal.Length<br>value: 0.653061224489796"],["row: 20<br>column: Sepal.Width<br>value: 0.181818181818182","row: 20<br>column: Sepal.Length<br>value: 0.36","row: 20<br>column: Petal.Width<br>value: 0.478260869565217","row: 20<br>column: Petal.Length<br>value: 0.693877551020408"],["row: 26<br>column: Sepal.Width<br>value: 0.136363636363636","row: 26<br>column: Sepal.Length<br>value: 0.36","row: 26<br>column: Petal.Width<br>value: 0.521739130434783","row: 26<br>column: Petal.Length<br>value: 0.612244897959184"],["row: 18<br>column: Sepal.Width<br>value: 0","row: 18<br>column: Sepal.Length<br>value: 0.56","row: 18<br>column: Petal.Width<br>value: 0.391304347826087","row: 18<br>column: Petal.Length<br>value: 0.612244897959184"],["row: 15<br>column: Sepal.Width<br>value: 0","row: 15<br>column: Sepal.Length<br>value: 0.64","row: 15<br>column: Petal.Width<br>value: 0.608695652173913","row: 15<br>column: Petal.Length<br>value: 0.714285714285714"],["row: 12<br>column: Sepal.Width<br>value: 0.181818181818182","row: 12<br>column: Sepal.Length<br>value: 0.6","row: 12<br>column: Petal.Width<br>value: 0.565217391304348","row: 12<br>column: Petal.Length<br>value: 0.938775510204081"],["row: 4<br>column: Sepal.Width<br>value: 0.227272727272727","row: 4<br>column: Sepal.Length<br>value: 0.48","row: 4<br>column: Petal.Width<br>value: 0.782608695652174","row: 4<br>column: Petal.Length<br>value: 0.836734693877551"],["row: 34<br>column: Sepal.Width<br>value: 0.363636363636364","row: 34<br>column: Sepal.Length<br>value: 0.56","row: 34<br>column: Petal.Width<br>value: 0.739130434782609","row: 34<br>column: Petal.Length<br>value: 0.775510204081633"],["row: 35<br>column: Sepal.Width<br>value: 0.545454545454545","row: 35<br>column: Sepal.Length<br>value: 0.56","row: 35<br>column: Petal.Width<br>value: 0.652173913043478","row: 35<br>column: Petal.Length<br>value: 0.714285714285714"],["row: 19<br>column: Sepal.Width<br>value: 0.318181818181818","row: 19<br>column: Sepal.Length<br>value: 0.44","row: 19<br>column: Petal.Width<br>value: 0.521739130434783","row: 19<br>column: Petal.Length<br>value: 0.653061224489796"],["row: 23<br>column: Sepal.Width<br>value: 0.318181818181818","row: 23<br>column: Sepal.Length<br>value: 0.56","row: 23<br>column: Petal.Width<br>value: 0.608695652173913","row: 23<br>column: Petal.Length<br>value: 0.714285714285714"],["row: 16<br>column: Sepal.Width<br>value: 0.272727272727273","row: 16<br>column: Sepal.Length<br>value: 0.6","row: 16<br>column: Petal.Width<br>value: 0.521739130434783","row: 16<br>column: Petal.Length<br>value: 0.612244897959184"],["row: 9<br>column: Sepal.Width<br>value: 0.272727272727273","row: 9<br>column: Sepal.Length<br>value: 0.6","row: 9<br>column: Petal.Width<br>value: 0.478260869565217","row: 9<br>column: Petal.Length<br>value: 0.755102040816326"],["row: 3<br>column: Sepal.Width<br>value: 0.363636363636364","row: 3<br>column: Sepal.Length<br>value: 0.8","row: 3<br>column: Petal.Width<br>value: 0.565217391304348","row: 3<br>column: Petal.Length<br>value: 0.693877551020408"],["row: 11<br>column: Sepal.Width<br>value: 0.409090909090909","row: 11<br>column: Sepal.Length<br>value: 0.92","row: 11<br>column: Petal.Width<br>value: 0.608695652173913","row: 11<br>column: Petal.Length<br>value: 0.795918367346939"],["row: 13<br>column: Sepal.Width<br>value: 0.409090909090909","row: 13<br>column: Sepal.Length<br>value: 0.92","row: 13<br>column: Petal.Width<br>value: 0.869565217391304","row: 13<br>column: Petal.Length<br>value: 0.897959183673469"],["row: 1<br>column: Sepal.Width<br>value: 0.363636363636364","row: 1<br>column: Sepal.Length<br>value: 1","row: 1<br>column: Petal.Width<br>value: 0.869565217391304","row: 1<br>column: Petal.Length<br>value: 1"],["row: 6<br>column: Sepal.Width<br>value: 0.136363636363636","row: 6<br>column: Sepal.Length<br>value: 0.84","row: 6<br>column: Petal.Width<br>value: 0.739130434782609","row: 6<br>column: Petal.Length<br>value: 0.979591836734694"],["row: 2<br>column: Sepal.Width<br>value: 0.363636363636364","row: 2<br>column: Sepal.Length<br>value: 0.76","row: 2<br>column: Petal.Width<br>value: 0.739130434782609","row: 2<br>column: Petal.Length<br>value: 0.918367346938775"],["row: 17<br>column: Sepal.Width<br>value: 0.363636363636364","row: 17<br>column: Sepal.Length<br>value: 0.76","row: 17<br>column: Petal.Width<br>value: 0.826086956521739","row: 17<br>column: Petal.Length<br>value: 0.857142857142857"],["row: 30<br>column: Sepal.Width<br>value: 0.454545454545455","row: 30<br>column: Sepal.Length<br>value: 0.72","row: 30<br>column: Petal.Width<br>value: 0.956521739130435","row: 30<br>column: Petal.Length<br>value: 0.877551020408163"],["row: 8<br>column: Sepal.Width<br>value: 0.545454545454545","row: 8<br>column: Sepal.Length<br>value: 0.68","row: 8<br>column: Petal.Width<br>value: 1","row: 8<br>column: Petal.Length<br>value: 0.938775510204081"]],"showlegend":false,"hoverinfo":"text","zmin":null,"zmax":null,"colors":["#440154FF","#440256FF","#450457FF","#450559FF","#46075AFF","#46085CFF","#460A5DFF","#460B5EFF","#470D60FF","#470E61FF","#471063FF","#471164FF","#471365FF","#481467FF","#481668FF","#481769FF","#48186AFF","#481A6CFF","#481B6DFF","#481C6EFF","#481D6FFF","#481F70FF","#482071FF","#482173FF","#482374FF","#482475FF","#482576FF","#482677FF","#482878FF","#482979FF","#472A7AFF","#472C7AFF","#472D7BFF","#472E7CFF","#472F7DFF","#46307EFF","#46327EFF","#46337FFF","#463480FF","#453581FF","#453781FF","#453882FF","#443983FF","#443A83FF","#443B84FF","#433D84FF","#433E85FF","#423F85FF","#424086FF","#424186FF","#414287FF","#414487FF","#404588FF","#404688FF","#3F4788FF","#3F4889FF","#3E4989FF","#3E4A89FF","#3E4C8AFF","#3D4D8AFF","#3D4E8AFF","#3C4F8AFF","#3C508BFF","#3B518BFF","#3B528BFF","#3A538BFF","#3A548CFF","#39558CFF","#39568CFF","#38588CFF","#38598CFF","#375A8CFF","#375B8DFF","#365C8DFF","#365D8DFF","#355E8DFF","#355F8DFF","#34608DFF","#34618DFF","#33628DFF","#33638DFF","#32648EFF","#32658EFF","#31668EFF","#31678EFF","#31688EFF","#30698EFF","#306A8EFF","#2F6B8EFF","#2F6C8EFF","#2E6D8EFF","#2E6E8EFF","#2E6F8EFF","#2D708EFF","#2D718EFF","#2C718EFF","#2C728EFF","#2C738EFF","#2B748EFF","#2B758EFF","#2A768EFF","#2A778EFF","#2A788EFF","#29798EFF","#297A8EFF","#297B8EFF","#287C8EFF","#287D8EFF","#277E8EFF","#277F8EFF","#27808EFF","#26818EFF","#26828EFF","#26828EFF","#25838EFF","#25848EFF","#25858EFF","#24868EFF","#24878EFF","#23888EFF","#23898EFF","#238A8DFF","#228B8DFF","#228C8DFF","#228D8DFF","#218E8DFF","#218F8DFF","#21908DFF","#21918CFF","#20928CFF","#20928CFF","#20938CFF","#1F948CFF","#1F958BFF","#1F968BFF","#1F978BFF","#1F988BFF","#1F998AFF","#1F9A8AFF","#1E9B8AFF","#1E9C89FF","#1E9D89FF","#1F9E89FF","#1F9F88FF","#1FA088FF","#1FA188FF","#1FA187FF","#1FA287FF","#20A386FF","#20A486FF","#21A585FF","#21A685FF","#22A785FF","#22A884FF","#23A983FF","#24AA83FF","#25AB82FF","#25AC82FF","#26AD81FF","#27AD81FF","#28AE80FF","#29AF7FFF","#2AB07FFF","#2CB17EFF","#2DB27DFF","#2EB37CFF","#2FB47CFF","#31B57BFF","#32B67AFF","#34B679FF","#35B779FF","#37B878FF","#38B977FF","#3ABA76FF","#3BBB75FF","#3DBC74FF","#3FBC73FF","#40BD72FF","#42BE71FF","#44BF70FF","#46C06FFF","#48C16EFF","#4AC16DFF","#4CC26CFF","#4EC36BFF","#50C46AFF","#52C569FF","#54C568FF","#56C667FF","#58C765FF","#5AC864FF","#5CC863FF","#5EC962FF","#60CA60FF","#63CB5FFF","#65CB5EFF","#67CC5CFF","#69CD5BFF","#6CCD5AFF","#6ECE58FF","#70CF57FF","#73D056FF","#75D054FF","#77D153FF","#7AD151FF","#7CD250FF","#7FD34EFF","#81D34DFF","#84D44BFF","#86D549FF","#89D548FF","#8BD646FF","#8ED645FF","#90D743FF","#93D741FF","#95D840FF","#98D83EFF","#9BD93CFF","#9DD93BFF","#A0DA39FF","#A2DA37FF","#A5DB36FF","#A8DB34FF","#AADC32FF","#ADDC30FF","#B0DD2FFF","#B2DD2DFF","#B5DE2BFF","#B8DE29FF","#BADE28FF","#BDDF26FF","#C0DF25FF","#C2DF23FF","#C5E021FF","#C8E020FF","#CAE11FFF","#CDE11DFF","#D0E11CFF","#D2E21BFF","#D5E21AFF","#D8E219FF","#DAE319FF","#DDE318FF","#DFE318FF","#E2E418FF","#E5E419FF","#E7E419FF","#EAE51AFF","#ECE51BFF","#EFE51CFF","#F1E51DFF","#F4E61EFF","#F6E620FF","#F8E621FF","#FBE723FF","#FDE725FF"],"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"heatmap"}},"source":"A","config":{"showSendToCloud":false,"displaylogo":false,"modeBarButtonsToRemove":["sendDataToCloud","select2d","lasso2d","autoScale2d","hoverClosestCartesian","hoverCompareCartesian","sendDataToCloud"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"subplot":true,"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>

---

# Visualizaci√≥n previa

Otra forma de ver las relaciones entre individuos es calcular su **matriz de distancias** con `dist()`, indic√°ndole en `method = ...` el tipo de m√©trica.



```r
d &lt;- dist(iris_range %&gt;% select(-Species),
          method = "euclidean")
d
```

```
&gt;             1          2          3          4          5          6          7
&gt; 2  0.28509143                                                                  
&gt; 3  0.47575052 0.28677764                                                       
&gt; 4  0.56851740 0.32488350 0.43435260                                            
&gt; 5  1.35944928 1.12408063 0.89597125 1.04496200                                 
&gt; 6  0.30770541 0.24859873 0.40636350 0.40020368 1.25632860                      
&gt; 7  1.57763519 1.31761664 1.12988279 1.17717913 0.32358438 1.45072978           
&gt; 8  0.39524615 0.32852287 0.54448947 0.44599437 1.25931276 0.51251758 1.42504115
&gt; 9  0.61754236 0.35857071 0.24407855 0.34023169 0.83681068 0.44118436 1.02032361
&gt; 10 1.66036135 1.40687977 1.21163441 1.28226133 0.35866172 1.54891320 0.12968698
&gt; 11 0.34375625 0.24428078 0.16961369 0.50849737 1.04345319 0.36266974 1.28351503
&gt; 12 0.53799060 0.29886467 0.36473670 0.27228188 1.04870981 0.30261830 1.20650683
&gt; 13 0.13739885 0.21235781 0.38825639 0.48781936 1.24835688 0.32319853 1.46419275
&gt; 14 1.49430215 1.28124063 1.06685341 1.26323748 0.37657580 1.45525602 0.51353847
&gt; 15 0.64149590 0.45309375 0.40017278 0.34998913 1.00174744 0.38209372 1.17455620
&gt; 16 0.66302449 0.41813203 0.23836676 0.36730738 0.75246758 0.50832843 0.95129671
&gt; 17 0.28266327 0.10634790 0.31033609 0.31512203 1.13171060 0.28391562 1.32604213
&gt; 18 0.83959448 0.62203324 0.47617333 0.51143685 0.82672958 0.59407222 0.99262159
&gt; 19 0.74633479 0.47128806 0.36772605 0.33414568 0.72304597 0.58901534 0.87224963
&gt; 20 0.83035408 0.55812763 0.48396207 0.35986369 0.77787217 0.61818419 0.88870373
&gt; 21 1.56471161 1.31545388 1.10954706 1.21639255 0.25630878 1.45638061 0.17385597
&gt; 22 1.38295748 1.14542825 0.91612939 1.07453224 0.09605940 1.27350393 0.32869256
&gt; 23 0.58766632 0.31737779 0.24894370 0.24475286 0.84429270 0.44593545 1.01868273
&gt; 24 1.50034287 1.25366566 1.04414379 1.14890358 0.17669875 1.39202765 0.16757866
&gt; 25 1.49155853 1.25029972 1.04449688 1.17682534 0.23544804 1.40620033 0.27679267
&gt; 26 0.85591466 0.59382053 0.50379276 0.37565018 0.76314001 0.64234162 0.87609397
&gt; 27 0.92488912 0.65258182 0.58532672 0.40599752 0.73251323 0.74085372 0.80491076
&gt; 28 0.78736557 0.51559806 0.42679196 0.32892077 0.75125379 0.59644420 0.88136610
&gt; 29 1.43916753 1.24268181 1.03627473 1.25052523 0.47011868 1.43055023 0.63444340
&gt; 30 0.33048397 0.24246529 0.44890923 0.37571879 1.20503120 0.41630635 1.38430278
&gt; 31 1.14765957 0.88532781 0.76907807 0.65078469 0.69180684 0.92301444 0.72012611
&gt; 32 1.38230353 1.15450502 0.94361792 1.10901647 0.23090878 1.32136067 0.39961443
&gt; 33 0.96846853 0.71048755 0.72902854 0.40052422 0.94956300 0.76855559 0.97596909
&gt; 34 0.51089030 0.24578072 0.30742420 0.17502525 0.95641480 0.41436965 1.11957792
&gt; 35 0.59627970 0.34966927 0.31406334 0.37369326 0.83943763 0.56895004 1.01652378
&gt;             8          9         10         11         12         13         14
&gt; 2                                                                              
&gt; 3                                                                              
&gt; 4                                                                              
&gt; 5                                                                              
&gt; 6                                                                              
&gt; 7                                                                              
&gt; 8                                                                              
&gt; 9  0.62187445                                                                  
&gt; 10 1.50562205 1.11868066                                                       
&gt; 11 0.49972222 0.37373018 1.36051815                                            
&gt; 12 0.57242233 0.22262489 1.31153450 0.41994216                                 
&gt; 13 0.30801663 0.54269909 1.54492823 0.28011651 0.49834372                      
&gt; 14 1.37268318 1.05126382 0.45895975 1.18037061 1.26231185 1.38289865           
&gt; 15 0.70896786 0.30766763 1.28227667 0.50241344 0.29486247 0.58952883 1.27458498
&gt; 16 0.64508594 0.14932690 1.04680881 0.40285534 0.34172659 0.56886789 0.98632727
&gt; 17 0.27634668 0.40652156 1.41391316 0.28048803 0.36520497 0.17669875 1.29283143
&gt; 18 0.88828672 0.32241241 1.10199160 0.61477662 0.41415678 0.77930834 1.12648951
&gt; 19 0.64778006 0.19992199 0.97471129 0.51636621 0.35737663 0.64778273 0.95437814
&gt; 20 0.75287325 0.26384257 1.00335116 0.62664061 0.35374630 0.74834571 1.04537331
&gt; 21 1.43407055 1.02221616 0.15150660 1.25394074 1.22113724 1.45402392 0.36588321
&gt; 22 1.29538407 0.84655768 0.36203954 1.06045024 1.05656480 1.27718197 0.37091757
&gt; 23 0.51919905 0.14948351 1.11557808 0.38016885 0.26922308 0.48954401 1.05304043
&gt; 24 1.36974826 0.96406681 0.18249634 1.19274669 1.16609803 1.38681620 0.37887534
&gt; 25 1.35822704 0.97770005 0.25151186 1.18011499 1.18157581 1.37966496 0.24560909
&gt; 26 0.77788886 0.31383684 0.99155296 0.65519275 0.41009598 0.76850231 1.05232611
&gt; 27 0.77733011 0.40728751 0.92056386 0.73416451 0.50202851 0.82570964 1.00588069
&gt; 28 0.70000413 0.23317119 0.99125062 0.57569736 0.35438556 0.69599989 1.01081161
&gt; 29 1.31167076 1.04976072 0.58634902 1.13568176 1.25864306 1.32641374 0.15047389
&gt; 30 0.12451209 0.53961566 1.46806064 0.41196237 0.49562859 0.22370526 1.34288719
&gt; 31 1.05415144 0.57831391 0.84621593 0.92936141 0.68026881 1.05935751 1.02820464
&gt; 32 1.25334856 0.90786937 0.38595938 1.07119271 1.11807670 1.26835496 0.17749624
&gt; 33 0.78992319 0.54582048 1.09541540 0.85358391 0.54760845 0.88224818 1.21667093
&gt; 34 0.37704952 0.27988191 1.21380731 0.38612931 0.30258744 0.40456532 1.14145463
&gt; 35 0.43102048 0.32846900 1.09662160 0.39591576 0.43793665 0.47873789 0.97107760
&gt;            15         16         17         18         19         20         21
&gt; 2                                                                              
&gt; 3                                                                              
&gt; 4                                                                              
&gt; 5                                                                              
&gt; 6                                                                              
&gt; 7                                                                              
&gt; 8                                                                              
&gt; 9                                                                              
&gt; 10                                                                             
&gt; 11                                                                             
&gt; 12                                                                             
&gt; 13                                                                             
&gt; 14                                                                             
&gt; 15                                                                             
&gt; 16 0.30651905                                                                  
&gt; 17 0.46292391 0.43181833                                                       
&gt; 18 0.25312311 0.30494819 0.64903184                                            
&gt; 19 0.39057591 0.17126613 0.48861337 0.36649539                                 
&gt; 20 0.35900916 0.27279793 0.58369204 0.29543727 0.16897152                      
&gt; 21 1.20254687 0.95728391 1.32959238 1.01647780 0.89575778 0.93155185           
&gt; 22 1.02270327 0.77578250 1.16161022 0.83452293 0.74504668 0.79151173 0.23217076
&gt; 23 0.32808485 0.14710500 0.33126011 0.39863640 0.16034299 0.27572589 1.03227901
&gt; 24 1.13060791 0.88741145 1.26152794 0.95153804 0.83191755 0.87219514 0.10790758
&gt; 25 1.17994366 0.91391743 1.26415302 1.00965769 0.85746031 0.91579866 0.13498442
&gt; 26 0.33907050 0.27603449 0.60353583 0.27496959 0.20279010 0.10305515 0.92809540
&gt; 27 0.47805544 0.36602318 0.65378537 0.42978498 0.23217076 0.18557985 0.87265931
&gt; 28 0.34722150 0.20912218 0.53148091 0.30972907 0.09932000 0.08498498 0.91896556
&gt; 29 1.28202078 0.98384598 1.24958782 1.15877571 0.96000970 1.07101596 0.50205690
&gt; 30 0.60054152 0.55396851 0.16520953 0.78871390 0.58002295 0.68297113 1.39336920
&gt; 31 0.58283798 0.53167122 0.89477908 0.42717008 0.45114226 0.34139734 0.80885516
&gt; 32 1.12016584 0.83776128 1.16408393 0.97112576 0.79651671 0.88055666 0.28170323
&gt; 33 0.54456999 0.53819431 0.70616874 0.56145790 0.41164552 0.32763026 1.06497974
&gt; 34 0.39924062 0.28944603 0.23286332 0.52902736 0.28056879 0.38441471 1.13831455
&gt; 35 0.55300183 0.32156761 0.35172683 0.61317691 0.29464311 0.45043717 1.01362970
&gt;            22         23         24         25         26         27         28
&gt; 2                                                                              
&gt; 3                                                                              
&gt; 4                                                                              
&gt; 5                                                                              
&gt; 6                                                                              
&gt; 7                                                                              
&gt; 8                                                                              
&gt; 9                                                                              
&gt; 10                                                                             
&gt; 11                                                                             
&gt; 12                                                                             
&gt; 13                                                                             
&gt; 14                                                                             
&gt; 15                                                                             
&gt; 16                                                                             
&gt; 17                                                                             
&gt; 18                                                                             
&gt; 19                                                                             
&gt; 20                                                                             
&gt; 21                                                                             
&gt; 22                                                                             
&gt; 23 0.86905363                                                                  
&gt; 24 0.19031649 0.96596110                                                       
&gt; 25 0.21880207 0.98320740 0.16072908                                            
&gt; 26 0.78613847 0.30171446 0.85980869 0.91837196                                 
&gt; 27 0.76251824 0.35713943 0.80555212 0.86263352 0.15802315                      
&gt; 28 0.77245151 0.21254255 0.85389580 0.89458527 0.10737986 0.17674501           
&gt; 29 0.47983224 1.04060238 0.49931123 0.37410974 1.07967359 1.03249378 1.02735097
&gt; 30 1.24164727 0.43798811 1.32466136 1.32234929 0.70018778 0.71889126 0.62728341
&gt; 31 0.70936960 0.58447768 0.74615381 0.84132368 0.29272147 0.29102809 0.37604126
&gt; 32 0.24333995 0.90524894 0.25925297 0.15634592 0.88317758 0.83339022 0.84696397
&gt; 33 0.97939614 0.48396207 1.00260208 1.06356715 0.31346144 0.23381926 0.34735954
&gt; 34 0.98733971 0.15108867 1.07106853 1.08270602 0.40689978 0.43008921 0.32626335
&gt; 35 0.86870076 0.23139415 0.95290387 0.93991434 0.48454198 0.47559947 0.38418920
&gt;            29         30         31         32         33         34
&gt; 2                                                                   
&gt; 3                                                                   
&gt; 4                                                                   
&gt; 5                                                                   
&gt; 6                                                                   
&gt; 7                                                                   
&gt; 8                                                                   
&gt; 9                                                                   
&gt; 10                                                                  
&gt; 11                                                                  
&gt; 12                                                                  
&gt; 13                                                                  
&gt; 14                                                                  
&gt; 15                                                                  
&gt; 16                                                                  
&gt; 17                                                                  
&gt; 18                                                                  
&gt; 19                                                                  
&gt; 20                                                                  
&gt; 21                                                                  
&gt; 22                                                                  
&gt; 23                                                                  
&gt; 24                                                                  
&gt; 25                                                                  
&gt; 26                                                                  
&gt; 27                                                                  
&gt; 28                                                                  
&gt; 29                                                                  
&gt; 30 1.28831533                                                       
&gt; 31 1.09204108 0.98337344                                            
&gt; 32 0.26022849 1.21796323 0.85393254                                 
&gt; 33 1.24200736 0.74561931 0.40307204 1.04449030                      
&gt; 34 1.11509197 0.30254879 0.68987942 0.99785553 0.50089090           
&gt; 35 0.93170119 0.39134080 0.73350388 0.84142452 0.60236677 0.21063648
```

---

# Visualizaci√≥n previa

.pull-left[

Con `fviz_dist()` podremos visualizar dicha matriz de distancias.


```r
fviz_dist(d, show_labels = TRUE)
```

]

.pull-right[


&lt;img src="index_files/figure-html/unnamed-chunk-82-1.png" width="100%" /&gt;

]


---

name: jerarquicos
class: center, middle

# Algoritmos jer√°rquicos

---

# Algoritmos jer√°rquicos: simple

.pull-left[

En nuestro caso empezaremos usando solo **algoritmos aglomerativos**, de forma que empezaremos con un cl√∫ster por individuo, e iremos **juntando cl√∫ster** en base a distintos enlaces

* **Enlace simple (single)** o del vecino m√°s cercano: la distancia entre dos cl√∫steres ser√° definida como la **distancia m√≠nima** entre pares de observaciones (cada una perteneciente a uno de los dos cl√∫steres)

`$$d(C_k, C_l) = \min_{x_i \in C_k, x_j \in C_l} d(x_i, x_j)$$`


```r
# Clustering (single)
single_clust &lt;-
  hclust(d, method = "single")

# Dendograma
library(factoextra)
fviz_dend(single_clust, cex = 1) +
  labs(title = "Dendograma (single)")
```

]

.pull-right[

&lt;img src="index_files/figure-html/unnamed-chunk-84-1.png" width="100%" /&gt;

]

---

# Algoritmos jer√°rquicos: simple

.pull-left[

Con `cutree()` podemos indicarle el corte del n√∫mero de cl√∫sters que queremos


```r
single_clust &lt;-
  hclust(d, method = "single")

# Seleccionamos 3 clusters
groups &lt;- cutree(single_clust, k = 3)
```

Con `fviz_dend()` podemos visualizar el dendograma


```r
# k = 3
fviz_dend(single_clust, k = 3,
          cex = 0.5, 
          k_colors =
            c("#2E9FDF", "#00AFBB",
              "#E7B800"),
          # Diferentes colores a los clusters
          color_labels_by_k = TRUE, 
          #a√±ade un rect√°ngulo alrededor
          rect = TRUE) +
  labs(title = "Dendograma (simple)")
```

]

.pull-right[

&lt;img src="index_files/figure-html/unnamed-chunk-87-1.png" width="100%" /&gt;

]

---

# Algoritmos jer√°rquicos: simple

.pull-left[

Con `fviz_cluster()` visualizaremos los cl√∫sters en base a las dos componentes que m√°s varianza capturen


```r
fviz_cluster(list(data = iris_range %&gt;%
                    select(-Species),
                  cluster = groups),
             palette =
               c("#2E9FDF", "#00AFBB", "#E7B800"),
             ellipse.type = "convex", 
             repel = TRUE,
             show.clust.cent = FALSE) +
  labs(title = "Cluster (single)") +
  theme_minimal()
```

]

.pull-right[

&lt;img src="index_files/figure-html/unnamed-chunk-89-1.png" width="100%" /&gt;

]

---

# Algoritmos jer√°rquicos: simple

.pull-left[

As√≠ quedar√≠a con todas las observaciones


```r
# Clustering (single)
single_clust &lt;-
  hclust(d, method = "single")
groups &lt;- cutree(single_clust, k = 3)

fviz_cluster(list(data = iris_range %&gt;%
                    select(-Species),
                  cluster = groups),
             palette =
               c("#2E9FDF", "#00AFBB", "#E7B800"),
             ellipse.type = "convex", 
             repel = TRUE,
             show.clust.cent = FALSE) +
  labs(title = "Cluster (single)") +
  theme_minimal()
```

]

.pull-right[

&lt;img src="index_files/figure-html/unnamed-chunk-91-1.png" width="100%" /&gt;

]

---

# Algoritmos jer√°rquicos: complete

.pull-left[

* **Enlace completo (complete)** o del vecino m√°s alejado (complete): la distancia entre dos cl√∫steres ser√° definida como la **distancia m√°xima** entre pares de observaciones (cada una perteneciente a uno de los dos cl√∫steres)

`$$d(C_k, C_l) = \max_{x_i \in C_k, x_j \in C_l} d(x_i, x_j)$$`


```r
# Clustering (complete)
complete_clust &lt;-
  hclust(d, method = "complete")

# k = 3
fviz_dend(complete_clust, k = 3,
          cex = 0.5, 
          k_colors =
            c("#2E9FDF", "#00AFBB", "#E7B800"),
          # Diferentes colores a los clusters
          color_labels_by_k = TRUE, 
          #a√±ade un rect√°ngulo alrededor
          rect = TRUE) +
  labs(title = "Dendograma (complete)")
```

]

.pull-right[

&lt;img src="index_files/figure-html/unnamed-chunk-93-1.png" width="100%" /&gt;

]


---

# Algoritmos jer√°rquicos: complete

.pull-left[


```r
# Clustering (single)
complete_clust &lt;-
  hclust(d, method = "complete")
groups &lt;- cutree(complete_clust, k = 3)

fviz_cluster(list(data = iris_range %&gt;%
                    select(-Species),
                  cluster = groups),
             palette =
               c("#2E9FDF", "#00AFBB", "#E7B800"),
             ellipse.type = "convex", 
             repel = TRUE,
             show.clust.cent = FALSE) +
  labs(title = "Cluster (complete)") +
  theme_minimal()
```

]

.pull-right[

&lt;img src="index_files/figure-html/unnamed-chunk-95-1.png" width="100%" /&gt;

]


---

# Algoritmos jer√°rquicos: average

.pull-left[

* **Enlace medio (average)**: la distancia entre dos cl√∫steres ser√° definida como la **distancia media** entre observaciones de distintos grupos

`$$d(C_k, C_l) = \frac{\sum_{x_i \in C_k} \sum_{x_j \in C_l} d(x_i, x_j)}{n_k n_l}$$`

siendo `\(n_k\)` el n√∫mero de elementos del cl√∫ster `\(C_k\)`.


```r
# Clustering (average)
average_clust &lt;-
  hclust(d, method = "average")

# k = 3
fviz_dend(average_clust, k = 3,
          cex = 0.5, 
          k_colors =
            c("#2E9FDF", "#00AFBB", "#E7B800"),
          # Diferentes colores a los clusters
          color_labels_by_k = TRUE, 
          #a√±ade un rect√°ngulo alrededor
          rect = TRUE) +
  labs(title = "Dendograma (average)")
```

]

.pull-right[

&lt;img src="index_files/figure-html/unnamed-chunk-97-1.png" width="100%" /&gt;

]

---

# Algoritmos jer√°rquicos: average

.pull-left[


```r
# Clustering (single)
average_clust &lt;-
  hclust(d, method = "average")
groups &lt;- cutree(average_clust, k = 3)

fviz_cluster(list(data = iris_range %&gt;%
                    select(-Species),
                  cluster = groups),
             palette =
               c("#2E9FDF", "#00AFBB", "#E7B800"),
             ellipse.type = "convex", 
             repel = TRUE,
             show.clust.cent = FALSE) +
  labs(title = "Cluster (average)") +
  theme_minimal()
```

]

.pull-right[

&lt;img src="index_files/figure-html/unnamed-chunk-99-1.png" width="100%" /&gt;

]


---

# Algoritmos jer√°rquicos: centroid

.pull-left[

* **Distancia entre centroides** (centroid): la distancia entre dos cl√∫steres ser√° definida como la distancia entre los centroides de cada grupo.

`$$d(C_k, C_l) = d(\overline{x}_k, \overline{x}_l)$$`

donde `\(\overline{x}_k = \frac{\sum_{x_k \in C_k} x_{k}}{n_k}\)`



```r
# Clustering (centroid)
centroid_clust &lt;-
  hclust(d, method = "centroid")

# k = 3
fviz_dend(centroid_clust, k = 3,
          cex = 0.5, 
          k_colors =
            c("#2E9FDF", "#00AFBB", "#E7B800"),
          # Diferentes colores a los clusters
          color_labels_by_k = TRUE, 
          #a√±ade un rect√°ngulo alrededor
          rect = TRUE) +
  labs(title = "Dendograma (centroid)")
```

]

.pull-right[

&lt;img src="index_files/figure-html/unnamed-chunk-101-1.png" width="100%" /&gt;

]

---

# Algoritmos jer√°rquicos: centroid

.pull-left[


```r
# Clustering (centroid)
centroid_clust &lt;-
  hclust(d, method = "centroid")
groups &lt;- cutree(centroid_clust, k = 3)

fviz_cluster(list(data = iris_range %&gt;%
                    select(-Species),
                  cluster = groups),
             palette =
               c("#2E9FDF", "#00AFBB", "#E7B800"),
             ellipse.type = "convex", 
             repel = TRUE,
             show.clust.cent = FALSE) +
  labs(title = "Cluster (centroid)") +
  theme_minimal()
```

]

.pull-right[

&lt;img src="index_files/figure-html/unnamed-chunk-103-1.png" width="100%" /&gt;

]


---

# Algoritmos jer√°rquicos: Ward

.pull-left[


* **M√©todo de Ward** (m√≠nima varianza): de todas las posibles aglomeraciones, selecciona aquella que **minimiza la variabilidad interna**


`$$W = \sum_{k=1}^{G} W_k, \quad W_k = \sum_{\boldsymbol{X_i} \in C_k} \sum_{j=1}^{p} \left(x_{i,j} - \overline{x}_{j}^{k} \right)^2$$`

donde `\(\overline{x}_{j}^{k}\)` es la coordenada j-√©sima del centroide `\(k\)`.


```r
# Clustering (ward)
ward_clust &lt;-
  hclust(d, method = "ward.D2")

# k = 3
fviz_dend(ward_clust, k = 3,
          cex = 0.5, 
          k_colors =
            c("#2E9FDF", "#00AFBB", "#E7B800"),
          # Diferentes colores a los clusters
          color_labels_by_k = TRUE, 
          #a√±ade un rect√°ngulo alrededor
          rect = TRUE) +
  labs(title = "Dendograma (Ward)")
```

]

.pull-right[

&lt;img src="index_files/figure-html/unnamed-chunk-105-1.png" width="100%" /&gt;

]

---

# Algoritmos jer√°rquicos: Ward

.pull-left[


```r
# Clustering (ward)
ward_clust &lt;-
  hclust(d, method = "ward.D2")
groups &lt;- cutree(ward_clust, k = 3)

fviz_cluster(list(data = iris_range %&gt;%
                    select(-Species),
                  cluster = groups),
             palette =
               c("#2E9FDF", "#00AFBB", "#E7B800"),
             ellipse.type = "convex", 
             repel = TRUE,
             show.clust.cent = FALSE) +
  labs(title = "Cluster (Ward)") +
  theme_minimal()
```

]

.pull-right[

&lt;img src="index_files/figure-html/unnamed-chunk-107-1.png" width="100%" /&gt;

]

---

# Ejemplo de jer√°rquico divisivo

.pull-left[

El paquete `{cluster}` nos permite implementar el **algoritmo de clustering jer√°rquico divisivo** m√°s famoso, **DIANA (DIvisive ANAlysis Clustering)**. En cada iteraci√≥n se seleccionar√° el **cl√∫ster con mayor diametro** (la mayor de las diferencias entre dos de sus observaciones) y se identificar√° la observaci√≥n m√°s alejada (en promedio) del resto de observaciones, siendo esta observaci√≥n la que inicia el nuevo cl√∫ster. 



```r
library(cluster)
hc_diana &lt;- diana(x = d, diss = TRUE, stand = FALSE)

fviz_dend(hc_diana , k = 3,
          cex = 0.5, 
          k_colors =
            c("#2E9FDF", "#00AFBB", "#E7B800"),
          # Diferentes colores a los clusters
          color_labels_by_k = TRUE, 
          #a√±ade un rect√°ngulo alrededor
          rect = TRUE) +
  labs(title = "Dendograma (DIANA, divisivo)")
```

]

.pull-right[

&lt;img src="index_files/figure-html/unnamed-chunk-109-1.png" width="100%" /&gt;


]

---


name: no-jerarquicos
class: center, middle

# Algoritmos no jer√°rquicos

---

# Algoritmo k-means

Dentro de los no jer√°rquicos nos centraremos en el **algoritmo k-means** (o algoritmo de Lloyd), basado en encontrar los `\(k\)` mejores cl√∫sters, entiendo como mejor cl√∫ster aquel cuya **varianza interna sea lo m√°s peque√±a posible**

1. **Seleccionaremos `\(k\)` puntos iniciales** (tantos c√≥mo n√∫mero de cl√∫sters) aleatorios de nuestro espacio (no tienen porque ser observaciones)  que definiran los **centroides** de nuestros cl√∫sters `\(\left\lbrace C_1, C_2, \ldots, C_k \right\rbrace\)`

2. Asignaremos **cada observaci√≥n a su cl√∫ster m√°s cercano**, entendiendo como cl√∫ster m√°s cercano aquel cuyo centroide tiene m√°s cerca (diagrama de Voronoi)

3. Una vez formado el cl√∫ster, **recalcularemos los `\(k\)` centroides** (c√≥mo las coordenadas medias de las observaciones agrupadas en dichos cl√∫sters)

4. Se **repiten los pasos 2. y 3.** hasta que no haya ning√∫n cambio en los cl√∫ster, hasta que no hayan movido los centroides por encima de una tolerancia o hasta que se haya llegado a un n√∫mero m√°ximo de iteraciones

---

# Algoritmo k-means

En dicho algoritmo se deber√°n tomar dos decisiones:

* La m√©trica usada para medir la distancia entre los individuos (normalmente la Eucl√≠dea)

* **Selecci√≥n inicial de los `\(k\)` centroides**:
  - Seleccionar las `\(k\)` primeras observaciones
  - Seleccionar la primera observaci√≥n como primer centroide, y el centroide i-√©simo como aquella observaci√≥n cuya distancia a los `\(i-1\)` centroides previos sea tan grande como una distancia predefinida.
  - Seleccionar `\(k\)` observaciones aleatorias.
  - Seleccionar `\(k\)` observaciones en base a conocimiento experto.

---

# Algoritmo k-means con R


Vamos a generar un **conjunto aleatorio bidimensional**.


```r
centers &lt;- tibble(cluster = factor(1:3), num_points =  c(100, 150, 50),
                  x = c(5, 0, -3), y = c(-1, 1, -2))
centers
```

```
&gt; # A tibble: 3 √ó 4
&gt;   cluster num_points     x     y
&gt;   &lt;fct&gt;        &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
&gt; 1 1              100     5    -1
&gt; 2 2              150     0     1
&gt; 3 3               50    -3    -2
```

```r
set.seed(1234567)
labelled_points &lt;- centers %&gt;% mutate(x = map2(num_points, x, rnorm), y = map2(num_points, y, rnorm)) %&gt;% 
  select(-num_points) %&gt;%  unnest(cols = c(x, y))
labelled_points
```

```
&gt; # A tibble: 300 √ó 3
&gt;    cluster     x      y
&gt;    &lt;fct&gt;   &lt;dbl&gt;  &lt;dbl&gt;
&gt;  1 1        5.16 -1.32 
&gt;  2 1        6.37 -0.642
&gt;  3 1        5.73 -0.975
&gt;  4 1        3.65  0.559
&gt;  5 1        4.99 -0.379
&gt;  6 1        5.32 -0.760
&gt;  7 1        3.22  0.148
&gt;  8 1        5.91 -2.79 
&gt;  9 1        4.08 -1.28 
&gt; 10 1        4.84 -1.63 
&gt; # ‚Ä¶ with 290 more rows
&gt; # ‚Ñπ Use `print(n = ...)` to see more rows
```

---

# Algoritmo k-means con R

.pull-left[


```r
ggplot(labelled_points,
       aes(x = x, y = y, color = cluster)) +
  geom_point(alpha = 0.5, size = 5) +
  labs(x = "Coordenada X",
       y = "Coordenada Y",
       title = "Datos simulados")
```
  
]

.pull-right[

&lt;img src="index_files/figure-html/unnamed-chunk-112-1.png" width="100%" /&gt;
  
]

---

# Algoritmo k-means con R

Para realizar el clustering basta usar la funci√≥n `kmeans()`, indic√°ndole el **n√∫mero de cl√∫sters** y el **n√∫mero m√°ximo de iteraciones**


```r
kclust &lt;- kmeans(labelled_points %&gt;% select(-cluster),
                 centers = 3, iter.max = 50)
kclust
```

```
&gt; K-means clustering with 3 clusters of sizes 101, 149, 50
&gt; 
&gt; Cluster means:
&gt;            x          y
&gt; 1  4.9032846 -0.9643320
&gt; 2 -0.0495747  0.9773762
&gt; 3 -2.8262464 -1.9751003
&gt; 
&gt; Clustering vector:
&gt;   [1] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
&gt;  [38] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
&gt;  [75] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 2 2 2 2 2 2 2 2 2 2 2
&gt; [112] 2 2 2 2 3 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2
&gt; [149] 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 3 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 1
&gt; [186] 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 3 2 2 2 2
&gt; [223] 2 2 2 2 2 3 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 3 3 2 3 3 3 3 3 3
&gt; [260] 3 3 3 2 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 2 3 3 3 3 3 3 3 3 3 3 3 3 3 2
&gt; [297] 3 3 3 3
&gt; 
&gt; Within cluster sum of squares by cluster:
&gt; [1] 172.8228 280.8962 107.8477
&gt;  (between_SS / total_SS =  83.5 %)
&gt; 
&gt; Available components:
&gt; 
&gt; [1] "cluster"      "centers"      "totss"        "withinss"     "tot.withinss"
&gt; [6] "betweenss"    "size"         "iter"         "ifault"
```

---

# Algoritmo k-means con R

.pull-left[

Los grupos est√°n guardados en `kclust$cluster` y los centroides en `kclust$centers`


```r
kclust$centers
```

```
&gt;            x          y
&gt; 1  4.9032846 -0.9643320
&gt; 2 -0.0495747  0.9773762
&gt; 3 -2.8262464 -1.9751003
```


```r
fviz_cluster(list(data =
                    labelled_points %&gt;%
                    select(-cluster),
                  cluster = kclust$cluster),
             palette =
               c("#2E9FDF", "#00AFBB", "#E7B800"),
             ellipse.type = "convex", 
             repel = TRUE,
             show.clust.cent = FALSE) +
  labs(title = "Cluster (k-means)") +
  theme_minimal()
```

]

.pull-right[

&lt;img src="index_files/figure-html/unnamed-chunk-116-1.png" width="100%" /&gt;

]

---

# Algoritmo k-means con R

.pull-left[

&lt;img src="index_files/figure-html/unnamed-chunk-117-1.png" width="100%" /&gt;

]

.pull-right[

&lt;img src="index_files/figure-html/unnamed-chunk-118-1.png" width="100%" /&gt;

]

---

# Algoritmo k-means con R

Podemos tambi√©n implementar el k-means para nuestro conjunto conocido `iris`



```r
kclust &lt;- kmeans(iris %&gt;% select(-Species),
                 centers = 3, iter.max = 50)
kclust$centers
```

```
&gt;   Sepal.Length Sepal.Width Petal.Length Petal.Width
&gt; 1     5.006000    3.428000     1.462000    0.246000
&gt; 2     5.901613    2.748387     4.393548    1.433871
&gt; 3     6.850000    3.073684     5.742105    2.071053
```

```r
kclust
```

```
&gt; K-means clustering with 3 clusters of sizes 50, 62, 38
&gt; 
&gt; Cluster means:
&gt;   Sepal.Length Sepal.Width Petal.Length Petal.Width
&gt; 1     5.006000    3.428000     1.462000    0.246000
&gt; 2     5.901613    2.748387     4.393548    1.433871
&gt; 3     6.850000    3.073684     5.742105    2.071053
&gt; 
&gt; Clustering vector:
&gt;   [1] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
&gt;  [38] 1 1 1 1 1 1 1 1 1 1 1 1 1 2 2 3 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2
&gt;  [75] 2 2 2 3 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 3 2 3 3 3 3 2 3 3 3 3
&gt; [112] 3 3 2 2 3 3 3 3 2 3 2 3 2 3 3 2 2 3 3 3 3 3 2 3 3 3 3 2 3 3 3 2 3 3 3 2 3
&gt; [149] 3 2
&gt; 
&gt; Within cluster sum of squares by cluster:
&gt; [1] 15.15100 39.82097 23.87947
&gt;  (between_SS / total_SS =  88.4 %)
&gt; 
&gt; Available components:
&gt; 
&gt; [1] "cluster"      "centers"      "totss"        "withinss"     "tot.withinss"
&gt; [6] "betweenss"    "size"         "iter"         "ifault"
```

---

# Algoritmo k-means con R

.pull-left[


```r
fviz_cluster(list(data =
                    iris %&gt;%
                    select(-Species),
                  cluster = kclust$cluster),
             palette =
               c("#2E9FDF", "#00AFBB", "#E7B800"),
             ellipse.type = "convex", 
             repel = TRUE,
             show.clust.cent = FALSE) +
  labs(title = "Cluster (k-means)") +
  theme_minimal()
```

Recordatorio: de la 1 a la 50 son setosa, de la 51 a la 100 son versicolor, y de la 101 a la 151 virginica. 

]

.pull-right[

&lt;img src="index_files/figure-html/unnamed-chunk-121-1.png" width="100%" /&gt;

]


---

name: n-grupos
class: center, middle

# Determinaci√≥n del n√∫mero de grupos

---

# Determinaci√≥n del n√∫mero de grupos

Hasta ahora **hemos hecho ¬´trampas¬ª** ya que el **n√∫mero de cl√∫sters se lo hemos indicado a priori**, en un caso porque hemos simulado nosotros los datos, y en otro caso porque es un conjunto del que conocemos su etiqueta (aprendizaje supervisado).

Para decidir el **n√∫mero de cl√∫ster √≥ptimo** (recuerda que estamos en aprendizaje NO supervisado, no sabemos a priori la etiqueta de los datos), tenemos **varias m√©tricas** a nuestra disposici√≥n

* **Variabilidad total**

`$$T = \sum_{j=1}^{p} \sum_{i=1}^{n} \left(x_{ij} - \overline{x}_j \right)^2$$`

donde `\(\overline{x}_j  = \frac{\sum_{i=1}^{n} x_{ij}}{n}\)`


```r
kclust$totss
```

```
&gt; [1] 681.3706
```

---

# Determinaci√≥n del n√∫mero de grupos


* **Variabilidad del cl√∫ster `\(C_k\)`**

`$$W_k = \sum_{j=1}^{p} \sum_{\boldsymbol{X}_i \in C_k} \left(x_{ij} - \overline{x}_{j}^{k} \right)^2$$`

donde `\(\overline{x}_{j}^{k}\)` es la coordenada j-√©sima del centroide `\(k\)`.


```r
kclust$withinss
```

```
&gt; [1] 15.15100 39.82097 23.87947
```

* **Variabilidad total intra-cl√∫steres**

`$$W = \sum_{k=1}^{K} W_k$$`


```r
kclust$tot.withinss
```

```
&gt; [1] 78.85144
```

---

# Determinaci√≥n del n√∫mero de grupos


Para decidir el **n√∫mero de cl√∫ster √≥ptimo** (recuerda que estamos en aprendizaje NO supervisado, no sabemos a priori la etiqueta de los datos), tenemos **varias m√©tricas** a nuestra disposici√≥n


* **Variabilidad total entre-cl√∫steres**

`$$E = \sum_{k=1}^{K} \sum_{j=1}^{p} \left( \overline{x}_{j}^{k} - \overline{x}_j  \right)^2$$`

tal que `\(T = W + E\)`


```r
kclust$betweenss
```

```
&gt; [1] 602.5192
```


```r
kclust$betweenss + kclust$tot.withinss
```

```
&gt; [1] 681.3706
```


```r
kclust$totss
```

```
&gt; [1] 681.3706
```

---

# Determinaci√≥n del n√∫mero de grupos

.pull-left[

Para decidir el **n√∫mero √≥ptimo** se usan principalmente dos m√©todos:

* Basado en la **variabilidad total intra-cl√∫steres (W)**:



```r
fviz_nbclust(iris_range, kmeans,
             method = "wss") +
  geom_vline(xintercept = 3,
             linetype = 2) +
  theme_minimal() +
  labs(x = "n¬∫ cl√∫steres (k)",
       y = "Variabilidad total intra-cl√∫steres (W)",
       title = "N√∫mero √≥ptimo basado en variabilidad total intra-cl√∫steres")
```

Con el **¬´m√©todo del codo¬ª (Elbow method)** cuando `\(W\)` ya no se reduce de forma significativa al aumentar el n√∫mero de cl√∫sters.

]

.pull-right[

&lt;img src="index_files/figure-html/unnamed-chunk-129-1.png" width="100%" /&gt;


]

---

# Determinaci√≥n del n√∫mero de grupos

.pull-left[

As√≠ ser√≠a para el conjunto de datos simulados

&lt;img src="index_files/figure-html/unnamed-chunk-130-1.png" width="100%" /&gt;

]

.pull-right[


```r
fviz_nbclust(labelled_points %&gt;% select(-cluster),
             kmeans, method = "wss") +
  geom_vline(xintercept = 3, linetype = 2) +
  theme_minimal() +
  labs(x = "n¬∫ cl√∫steres (k)",
       y = "Variabilidad total intra-cl√∫steres (W)",
       title = "N√∫mero √≥ptimo basado en variabilidad total intra-cl√∫steres")
```

Con el **¬´m√©todo del codo¬ª (Elbow method)** cuando `\(W\)` ya no se reduce de forma significativa al aumentar el n√∫mero de cl√∫sters.

]

---

# Determinaci√≥n del n√∫mero de grupos

.pull-left[

Para decidir el **n√∫mero √≥ptimo** se usan principalmente dos m√©todos:

* Basado en la **compacidad** (√≠ndice silhouette)

`$$S= \frac{\sum_{i=1}^{n} S(i)}{n}, \quad S(i) = \frac{b(i) - a(i)}{\max(a(i), b(i))}$$`

donde `\(a(i)\)` representa las **distancia media de la observaci√≥n i-√©sima** a las observaciones de su cl√∫ster, y y `\(b(i)\)` respecto a la de otros cl√∫sters.


```r
fviz_nbclust(iris_range %&gt;%
               select(-Species),
             kmeans,
             method = "silhouette") +
  theme_minimal() +
  labs(x = "n¬∫ cl√∫steres (k)",
       y = "Silhouette media",
       title = "N√∫mero √≥ptimo basado en silhouette")
```

]

.pull-right[

&lt;img src="index_files/figure-html/unnamed-chunk-133-1.png" width="100%" /&gt;

]

---

# Determinaci√≥n del n√∫mero de grupos

La funci√≥n `silhouette()` del paquete `{cluster}` nos permite calcular dicho √≠ndice para la agrupaci√≥n realizada (m√°s adelante veremos como visualizarlo)


```r
kclust &lt;-
  kmeans(iris_range %&gt;% select(-Species),
         centers = 3, iter.max = 50)
sil &lt;- silhouette(kclust$cluster, d)
sil
```

```
&gt;       cluster neighbor    sil_width
&gt;  [1,]       2        1  0.503473465
&gt;  [2,]       2        1  0.515950560
&gt;  [3,]       2        1  0.186787046
&gt;  [4,]       2        1 -0.002670764
&gt;  [5,]       3        1  0.651255376
&gt;  [6,]       2        1  0.372772064
&gt;  [7,]       3        1  0.648347639
&gt;  [8,]       2        1  0.457878814
&gt;  [9,]       1        2  0.228479883
&gt; [10,]       3        1  0.693884260
&gt; [11,]       2        1  0.399424495
&gt; [12,]       2        1 -0.024741193
&gt; [13,]       2        1  0.544165703
&gt; [14,]       3        1  0.683639621
&gt; [15,]       1        2  0.210035776
&gt; [16,]       1        2  0.327344716
&gt; [17,]       2        1  0.533347494
&gt; [18,]       1        2  0.439735140
&gt; [19,]       1        2  0.466332183
&gt; [20,]       1        2  0.574174803
&gt; [21,]       3        1  0.747517998
&gt; [22,]       3        1  0.660143882
&gt; [23,]       1        2  0.136917493
&gt; [24,]       3        1  0.739609643
&gt; [25,]       3        1  0.760109432
&gt; [26,]       1        2  0.592345486
&gt; [27,]       1        2  0.535019760
&gt; [28,]       1        2  0.568082194
&gt; [29,]       3        1  0.594772581
&gt; [30,]       2        1  0.506382248
&gt; [31,]       1        3  0.470130596
&gt; [32,]       3        1  0.706545900
&gt; [33,]       1        2  0.395192792
&gt; [34,]       2        1  0.170924018
&gt; [35,]       2        1  0.104683351
&gt; attr(,"Ordered")
&gt; [1] FALSE
&gt; attr(,"call")
&gt; silhouette.default(x = kclust$cluster, dist = d)
&gt; attr(,"class")
&gt; [1] "silhouette"
```

---

# Poniendo en pr√°ctica: clustering de pa√≠ses

Para poner en pr√°ctica lo aprendido vamos a analizar los **datos de esperanza de vida de distintos pa√≠ses**, en hombres y mujeres, a distintas edades, que tenemos en el archivo `EsperanzaVida.xlsx`


```r
library(readxl)
esperanza &lt;-
  read_xlsx(path = "./DATOS/EsperanzaVida.xlsx")
glimpse(esperanza)
```

```
&gt; Rows: 26
&gt; Columns: 9
&gt; $ PAIS &lt;chr&gt; "Algeria", "Cameroon", "Madagascar", "Mauritius", "Reunion", "Sey‚Ä¶
&gt; $ m0   &lt;dbl&gt; 63, 34, 38, 59, 56, 62, 65, 56, 69, 65, 64, 56, 60, 61, 49, 59, 6‚Ä¶
&gt; $ m25  &lt;dbl&gt; 51, 29, 30, 42, 38, 44, 44, 46, 47, 48, 50, 44, 44, 45, 40, 42, 4‚Ä¶
&gt; $ m50  &lt;dbl&gt; 30, 13, 17, 20, 18, 24, 22, 24, 24, 26, 28, 25, 22, 22, 22, 22, 2‚Ä¶
&gt; $ m75  &lt;dbl&gt; 13, 5, 7, 6, 7, 7, 7, 11, 8, 9, 11, 10, 6, 8, 9, 6, 8, 8, 14, 9, ‚Ä¶
&gt; $ w0   &lt;dbl&gt; 67, 38, 38, 64, 62, 69, 72, 63, 75, 68, 66, 61, 65, 65, 51, 61, 6‚Ä¶
&gt; $ w25  &lt;dbl&gt; 54, 32, 34, 46, 46, 50, 50, 54, 53, 50, 51, 48, 45, 49, 41, 43, 4‚Ä¶
&gt; $ w50  &lt;dbl&gt; 34, 17, 20, 25, 25, 28, 27, 33, 29, 27, 29, 27, 25, 27, 23, 22, 2‚Ä¶
&gt; $ w75  &lt;dbl&gt; 15, 6, 7, 8, 10, 14, 9, 19, 10, 10, 11, 12, 9, 10, 8, 7, 9, 8, 13‚Ä¶
```

---

# Clustering de pa√≠ses

### Visualizaci√≥n previa


.pull-left[

La funci√≥n `heatmaply()` del paquete hom√≥nimo qos permite realizar agrupaciones tanto de variables (dendograma superior) como de individuos (dendograma en el lateral).


```r
# Convertimos a data.frame para
# tener row.names y eliminamos PAIS
esperanza_df &lt;-
  as.data.frame(esperanza) %&gt;%
  select(-PAIS)
row.names(esperanza_df) &lt;- esperanza %&gt;% pull(PAIS)

library(heatmaply)
heatmaply(esperanza_df,
          seriate = "mean",
          row_dend_left = TRUE,
          plot_method = "plotly")
```

]

.pull-right[



&lt;img src="./img/heatmap_paises_1.jpg" width="95%" style="display: block; margin: auto 0 auto auto;" /&gt;

]


---

# Clustering de pa√≠ses

### Visualizaci√≥n previa

.pull-left[

Dicha representaci√≥n puede ser mejorada **estandarizando los datos por rango**


```r
# Estandarizamos
esperanza_scale_df &lt;-
  esperanza_df %&gt;%
  mutate(across(where(is.numeric),
                rescale))

heatmaply(esperanza_scale_df,
          seriate = "mean",
          row_dend_left = TRUE,
          plot_method = "plotly")
```

]

.pull-right[



&lt;img src="./img/heatmap_paises_2.jpg" width="95%" style="display: block; margin: auto 0 auto auto;" /&gt;

]

---

# Clustering de pa√≠ses

### Matriz de distancias

.pull-left[

Con los datos estandarizados podemos visualizar su matriz de distancias


```r
# matriz de distancias
d &lt;- dist(esperanza_scale_df,
          method = "euclidean")

# Visualizamos
fviz_dist(d, show_labels = TRUE)
```

Podemos ya atisbar cuatro grupos de pa√≠ses: Madasgar-Camer√∫n, Nicaragua-Algeria-Tunez, Groenlandia-...-Guatemala, y los dem√°s.

]
.pull-right[

&lt;img src="index_files/figure-html/unnamed-chunk-143-1.png" width="95%" /&gt;

]

---

# Clustering de pa√≠ses

### Clustering (single)

.pull-left[


```r
# Clustering (single)
single_clust &lt;-
  hclust(d, method = "single")

# Dendograma
library(factoextra)
fviz_dend(single_clust, k = 4,
          cex = 0.5, 
          k_colors =
            c("#2E9FDF", "#00AFBB",
              "#E7B800", "#FC4E07"),
          # Diferentes colores a los clusters
          color_labels_by_k = TRUE, 
          # a√±ade rect√°ngulo
          rect = TRUE) +
  labs(title = "Dendograma (single)")
```

]

.pull-right[

&lt;img src="index_files/figure-html/unnamed-chunk-145-1.png" width="100%" /&gt;

]

---

# Clustering de pa√≠ses

### Clustering (complete)

.pull-left[


```r
# Clustering (complete)
complete_clust &lt;-
  hclust(d, method = "complete")

# Dendograma
fviz_dend(complete_clust, k = 4,
          cex = 0.5, 
          k_colors =
            c("#2E9FDF", "#00AFBB",
              "#E7B800", "#FC4E07"),
          # Diferentes colores a los clusters
          color_labels_by_k = TRUE, 
          # A√±ade un rect√°ngulo alrededor
          rect = TRUE) +
  labs(title = "Dendograma (complete)")
```

]

.pull-right[

&lt;img src="index_files/figure-html/unnamed-chunk-147-1.png" width="100%" /&gt;

]

---

# Clustering de pa√≠ses

### Clustering (average)

.pull-left[


```r
# Clustering (average)
average_clust &lt;-
  hclust(d, method = "average")

# Dendograma
fviz_dend(average_clust, k = 4,
          cex = 0.5, 
          k_colors =
            c("#2E9FDF", "#00AFBB",
              "#E7B800", "#FC4E07"),
          # Diferentes colores a los clusters
          color_labels_by_k = TRUE, 
          #a√±ade un rect√°ngulo alrededor
          rect = TRUE) +
  labs(title = "Dendograma (average)")
```

]

.pull-right[

&lt;img src="index_files/figure-html/unnamed-chunk-149-1.png" width="100%" /&gt;

]

---

# Clustering de pa√≠ses

### Clustering (Ward)

.pull-left[


```r
# Clustering (ward)
ward_clust &lt;-
  hclust(d, method = "ward.D2")

# Dendograma
fviz_dend(ward_clust, k = 4,
          cex = 0.5, 
          k_colors =
            c("#2E9FDF", "#00AFBB",
              "#E7B800", "#FC4E07"),
          # Diferentes colores a los clusters
          color_labels_by_k = TRUE, 
          #a√±ade un rect√°ngulo alrededor
          rect = TRUE) +
  labs(title = "Dendograma (Ward)")
```

]

.pull-right[

&lt;img src="index_files/figure-html/unnamed-chunk-151-1.png" width="100%" /&gt;

]

---


# Clustering de pa√≠ses

### Clustering divisivo

.pull-left[


```r
# Clustering divisivo
hc_diana &lt;-
  diana(x = d, diss = TRUE,
        stand = FALSE)

# Dendograma
fviz_dend(hc_diana, k = 4,
          cex = 0.5, 
          k_colors =
            c("#2E9FDF", "#00AFBB",
              "#E7B800", "#FC4E07"),
          # Diferentes colores a los clusters
          color_labels_by_k = TRUE, 
          #a√±ade un rect√°ngulo alrededor
          rect = TRUE) +
  labs(title = "Dendograma (divisivo)")
```

]

.pull-right[

&lt;img src="index_files/figure-html/unnamed-chunk-153-1.png" width="100%" /&gt;

]

---

# Clustering de pa√≠ses

### Clustering no jer√°rquico

.pull-left[


```r
# Clustering k-means
kclust &lt;- kmeans(esperanza_scale_df,
                 centers = 4,
                 iter.max = 50)
kclust$totss

# Clustering
fviz_cluster(list(data =
                    esperanza_scale_df,
                  cluster =
                    kclust$cluster),
             palette =
               c("#2E9FDF", "#00AFBB",
                 "#E7B800", "#FC4E07"),
             ellipse.type = "convex", 
             repel = TRUE,
             show.clust.cent = FALSE) +
  labs(title = "Cluster (k-means)") +
  theme_minimal()
```

]

.pull-right[

&lt;img src="index_files/figure-html/unnamed-chunk-155-1.png" width="100%" /&gt;

]

---


# Clustering de pa√≠ses

### Comparativa de clusterings


.pull-left[

&lt;img src="index_files/figure-html/unnamed-chunk-156-1.png" width="100%" /&gt;

]

.pull-right[
&lt;img src="index_files/figure-html/unnamed-chunk-157-1.png" width="100%" /&gt;

]

---


# Clustering de pa√≠ses

### Elecci√≥n del n√∫mero de clusters

.pull-left[


```r
fviz_nbclust(esperanza_scale_df, kmeans,
             method = "wss") +
  theme_minimal() +
  labs(x = "n¬∫ cl√∫steres (k)",
       y = "Variabilidad total intra-cl√∫steres (W)",
       title = "N√∫mero √≥ptimo basado en variabilidad")
```

]

.pull-right[

&lt;img src="index_files/figure-html/unnamed-chunk-159-1.png" width="100%" /&gt;

]

---

# Clustering de pa√≠ses

### Elecci√≥n del n√∫mero de clusters

.pull-left[


```r
fviz_nbclust(esperanza_scale_df, kmeans,
             method = "silhouette") +
  theme_minimal() +
  labs(x = "n¬∫ cl√∫steres (k)",
       y = "Variabilidad total intra-cl√∫steres (W)",
       title = "N√∫mero √≥ptimo basado en compacidad")
```

]

.pull-right[

&lt;img src="index_files/figure-html/unnamed-chunk-161-1.png" width="100%" /&gt;

]

---

# Clustering de pa√≠ses

### Elecci√≥n del n√∫mero de clusters

.pull-left[



```r
kclust &lt;- kmeans(esperanza_scale_df,
                 centers = 4, iter.max = 50)
sil &lt;- silhouette(kclust$cluster, d)
sil
```

]

.pull-right[


```
&gt;       cluster neighbor   sil_width
&gt;  [1,]       2        3  0.42635479
&gt;  [2,]       4        1  0.72091418
&gt;  [3,]       4        1  0.66427090
&gt;  [4,]       1        3  0.42671835
&gt;  [5,]       1        3  0.31191114
&gt;  [6,]       3        1  0.34406065
&gt;  [7,]       3        1  0.23488015
&gt;  [8,]       2        3  0.18987074
&gt;  [9,]       3        1  0.44296678
&gt; [10,]       3        2  0.49964115
&gt; [11,]       2        3 -0.10007517
&gt; [12,]       3        1  0.31607694
&gt; [13,]       1        3  0.31436972
&gt; [14,]       3        1  0.27953057
&gt; [15,]       1        3  0.26281560
&gt; [16,]       1        3  0.45103564
&gt; [17,]       3        1  0.20017556
&gt; [18,]       1        3  0.03745117
&gt; [19,]       2        3  0.30799050
&gt; [20,]       3        1  0.48727844
&gt; [21,]       1        3  0.24866468
&gt; [22,]       3        1  0.44741726
&gt; [23,]       3        1  0.52374565
&gt; [24,]       3        1  0.37974168
&gt; [25,]       3        1  0.12924135
&gt; [26,]       3        2  0.32385020
&gt; attr(,"Ordered")
&gt; [1] FALSE
&gt; attr(,"call")
&gt; silhouette.default(x = kclust$cluster, dist = d)
&gt; attr(,"class")
&gt; [1] "silhouette"
```

]

---


# Clustering de pa√≠ses

### Elecci√≥n del n√∫mero de clusters

.pull-left[



```r
kclust &lt;- kmeans(esperanza_scale_df,
                 centers = 4, iter.max = 50)
sil &lt;- silhouette(kclust$cluster, d)
row.names(sil) &lt;- row.names(esperanza_scale_df)

# Visualizaci√≥n
fviz_silhouette(sil, label = TRUE) +
  scale_fill_manual(values =
                      c("#2E9FDF", "#00AFBB",
                        "#E7B800", "#FC4E07")) +
  scale_color_manual(values =
                      c("#2E9FDF", "#00AFBB",
                        "#E7B800", "#FC4E07")) +
  theme_minimal() +
  labs(title =
         "√çndice silhouette para k-means con k = 4") +
  # Giramos etiquetas eje
  theme(axis.text.x =
          element_text(angle = 90,
                       vjust = 0.5,
                       hjust=1))
```

]

.pull-right[


&lt;img src="index_files/figure-html/unnamed-chunk-165-1.png" width="100%" /&gt;

]

---

# Clustering de pa√≠ses

### Elecci√≥n del n√∫mero de clusters

.pull-left[



```r
# Clustering (ward)
ward_clust &lt;-
  hclust(d, method = "ward.D2")
groups &lt;- cutree(ward_clust, k = 4)
sil &lt;- silhouette(groups, d)
row.names(sil) &lt;- row.names(esperanza_scale_df)

# Visualizaci√≥n
fviz_silhouette(sil, label = TRUE,
                print.summary = FALSE) +
  scale_fill_manual(values =
                      c("#2E9FDF", "#00AFBB",
                        "#E7B800", "#FC4E07")) +
  scale_color_manual(values =
                      c("#2E9FDF", "#00AFBB",
                        "#E7B800", "#FC4E07")) +
  theme_minimal() +
  labs(title =
         "√çndice silhouette para jer√°rquico Ward con k = 4") +
  # Giramos etiquetas eje
  theme(axis.text.x =
          element_text(angle = 90,
                       vjust = 0.5,
                       hjust = 1))
```

]

.pull-right[


&lt;img src="index_files/figure-html/unnamed-chunk-167-1.png" width="100%" /&gt;

]

---

# Clustering de pa√≠ses

### Elecci√≥n del n√∫mero de clusters

Podemos ejecutar varios clustering a la vez mapeando sobre el n√∫mero de clusters (por ejemplo, usando el k-medias)


```r
library(tidymodels)
kclusts &lt;- 
  tibble(k = 1:9) %&gt;%
  mutate(kclust =
           map(k, ~kmeans(esperanza_scale_df, .x)),
         tidied = map(kclust, tidy),
         glanced = map(kclust, glance),
         augmented = map(kclust, augment,
                         esperanza_scale_df)
         )
clusters &lt;- 
  kclusts %&gt;% unnest(cols = c(tidied))

assignments &lt;- 
  kclusts %&gt;% unnest(cols = c(augmented))

clusterings &lt;- 
  kclusts %&gt;% unnest(cols = c(glanced))
```

---

# Recursos y bibliograf√≠a

&amp;nbsp;

### **Leyenda de los recursos**

&amp;nbsp;

&amp;nbsp;


#### üìö **Art√≠culos o libros** cient√≠ficos que han sido sometidos a revisi√≥n por pares.

&amp;nbsp;

#### üîó **Recursos online** recomendados

&amp;nbsp;

#### üíª Recursos para la **programaci√≥n en R**

---

# Bibliograf√≠a general

üíª **Tidy Data Tutor**: para visualizar la mec√°nica interna de `{tidyverse}`. &lt;https://tidydatatutor.com/&gt;

üîó Web con recursos para la **introducci√≥n a la estad√≠stica y Machine Learning en R** &lt;https://artofstat.com/&gt;

üìö **¬´An Introduction to Multivariate Statistical Analysis¬ª**. Anderson (1958) &lt;https://github.com/dadosdelaplace/teaching/blob/main/bdba-pca-clustering-2022/biblio/introduction_mva_anderson_2003.pdf&gt;

üìö **¬´A New Measure of Rank Correlation¬ª**. Kendall (1938) &lt;https://github.com/dadosdelaplace/teaching/blob/main/bdba-pca-clustering-2022/biblio/correlation_kendall_1938.pdf&gt;

üìö **¬´The generalised product moment distribution in samples from a normal multivariate population¬ª**. Wishart (1928) &lt;https://github.com/dadosdelaplace/teaching/blob/main/bdba-pca-clustering-2022/biblio/multivariate_normal_wishart_1928.pdf&gt;

üìö **¬´On lines and planes of closest fit to systems of points in space¬ª**. Pearson (1901) &lt;https://github.com/dadosdelaplace/teaching/blob/main/bdba-pca-clustering-2022/biblio/fit_pearson_1901.pdf&gt;


---

# Recursos dataviz

### Dataviz

üìö **¬´Gram√°tica de las gr√°ficas: pistas para mejorar las representaciones de datos¬ª**. Sevilla (2005) &lt;http://academica-e.unavarra.es/bitstream/handle/2454/15785/Gram%C3%A1tica.pdf&gt;

üìö **¬´Quantitative Graphics in Statistics: A Brief History¬ª**. Beniger and Robyn &lt;https://github.com/dadosdelaplace/teaching/blob/main/bdba-pca-clustering-2022/biblio/graphics_beniger_robin_1978.pdf&gt;
 
 
üíª **¬´Analizando datos, visualizando informaci√≥n, contando historias¬ª** (curso de dataviz en R). √Ålvarez-Li√©bana y Valverde-Castilla (2022) &lt;https://dadosdelaplace.github.io/curso-dataviz-ECI-2022&gt;

---

# Bibliograf√≠a componentes principales

üíª **Componentes principales** en `{tidymodels}`. &lt;https://www.tmwr.org/dimensionality.html#beans&gt;


üìö **¬´Principal Component Analysis¬ª**. Jolliffe (2002) &lt;https://github.com/dadosdelaplace/teaching/blob/main/bdba-pca-clustering-2022/biblio/pca_jolliffe_2002.pdf&gt;

üìö **¬´Principal Component Analysis¬ª**. Herv√© and Lynne (2010) &lt;http://staff.ustc.edu.cn/~zwp/teach/MVA/abdi-awPCA2010.pdf&gt;

üìö **¬´Principal Component Analysis: a review and recent developments¬ª**. Jolliffe and Cadima (2016) &lt;https://royalsocietypublishing.org/doi/10.1098/rsta.2015.0202&gt;

üîó **¬´The Mathematics Behind Principal Component Analysis¬ª**. Dubey (2018).  &lt;https://towardsdatascience.com/the-mathematics-behind-principal-component-analysis-fff2d7f4b643&gt;


üîó **¬´A One-Stop Shop for Principal Component Analysis¬ª**. Brems (2017). &lt;https://towardsdatascience.com/a-one-stop-shop-for-principal-component-analysis-5582fb7e0a9c&gt;

üìö **¬´On the number of principal components: a test of dimensionality based on measurements of similarity between matrices¬ª**. Dray (2008) &lt;https://github.com/dadosdelaplace/teaching/blob/main/bdba-pca-clustering-2022/biblio/numer_pca_dray_2008.pdf&gt;


---

# Bibliograf√≠a an√°lisis cl√∫ster

üìö **¬´Multiclass classification of dry beans using computer vision and machine learning techniques¬ª**. Koklu y Ozkan (2020) &lt;https://github.com/dadosdelaplace/teaching/blob/main/bdba-pca-clustering-2022/biblio/multiclass_classif_koklu_ozlan_2020.pdf&gt;

üíª **¬´Clustering y heatmaps: aprendizaje no supervisado¬ª**. Amat (2017). &lt;https://rpubs.com/Joaquin_AR/310338&gt;

üíª **¬´K-means clustering with tidy data principles¬ª** &lt;https://www.tidymodels.org/learn/statistics/k-means/&gt;

üîó **¬´ISLR tidymodels Labs¬ª** &lt;https://emilhvitfeldt.github.io/ISLR-tidymodels-labs/unsupervised-learning.html#kmeans-clustering&gt;


üìö **¬´Algorithm AS 136: a K-Means Clustering Algorithm¬ª**. Hartigan y Wong (1979) &lt;http://www.jstor.org/stable/2346830&gt;

üîó **¬´Machine Learning for Social Scientists¬ª**. Cimentada (2020) &lt;https://cimentadaj.github.io/ml_socsci/unsupervised-methods.html&gt;

---

# Recursos y bibliograf√≠a

### Otras t√©cnicas de reducci√≥n de la dimensi√≥n

üîó Sobre **PCA y PLS**. Amat (2017). &lt;https://www.cienciadedatos.net/documentos/35_principal_component_analysis#Introducci%C3%B3n&gt;

üìö **¬´On the early history of the singular value decomposition¬ª**. Stewart (1993) &lt;https://github.com/dadosdelaplace/teaching/blob/main/bdba-pca-clustering-2022/biblio/svd_stewart_1993.pdf&gt;

üìö **¬´UMAP: Uniform Manifold Approximation and Projection for Dimension Reduction¬ª**. McInnes, healy and Melville (2020) &lt;https://github.com/dadosdelaplace/teaching/blob/main/bdba-pca-clustering-2022/biblio/umap_mcinnesetal_2020.pdf&gt;
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"slideNumberFormat": "%current%",
"highlightStyle": "github",
"highlightLines": true,
"ratio": "16:9",
"countIncrementalSlides": true
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
